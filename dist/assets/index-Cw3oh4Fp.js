(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function La(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const ge={},hs=[],Ot=()=>{},ch=()=>!1,Vr=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Fa=t=>t.startsWith("onUpdate:"),Re=Object.assign,Ua=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},ng=Object.prototype.hasOwnProperty,ce=(t,e)=>ng.call(t,e),K=Array.isArray,ds=t=>ki(t)==="[object Map]",uh=t=>ki(t)==="[object Set]",ec=t=>ki(t)==="[object Date]",J=t=>typeof t=="function",Se=t=>typeof t=="string",Lt=t=>typeof t=="symbol",ue=t=>t!==null&&typeof t=="object",hh=t=>(ue(t)||J(t))&&J(t.then)&&J(t.catch),dh=Object.prototype.toString,ki=t=>dh.call(t),sg=t=>ki(t).slice(8,-1),fh=t=>ki(t)==="[object Object]",Ba=t=>Se(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Qs=La(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Wr=t=>{const e=Object.create(null);return(n=>e[n]||(e[n]=t(n)))},ig=/-\w/g,Sn=Wr(t=>t.replace(ig,e=>e.slice(1).toUpperCase())),rg=/\B([A-Z])/g,xn=Wr(t=>t.replace(rg,"-$1").toLowerCase()),ph=Wr(t=>t.charAt(0).toUpperCase()+t.slice(1)),bo=Wr(t=>t?`on${ph(t)}`:""),yn=(t,e)=>!Object.is(t,e),Xi=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},gh=(t,e,n,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:n})},Ha=t=>{const e=parseFloat(t);return isNaN(e)?t:e},og=t=>{const e=Se(t)?Number(t):NaN;return isNaN(e)?t:e};let tc;const jr=()=>tc||(tc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Gr(t){if(K(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],i=Se(s)?ug(s):Gr(s);if(i)for(const r in i)e[r]=i[r]}return e}else if(Se(t)||ue(t))return t}const ag=/;(?![^(]*\))/g,lg=/:([^]+)/,cg=/\/\*[^]*?\*\//g;function ug(t){const e={};return t.replace(cg,"").split(ag).forEach(n=>{if(n){const s=n.split(lg);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function it(t){let e="";if(Se(t))e=t;else if(K(t))for(let n=0;n<t.length;n++){const s=it(t[n]);s&&(e+=s+" ")}else if(ue(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const hg="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",dg=La(hg);function _h(t){return!!t||t===""}function fg(t,e){if(t.length!==e.length)return!1;let n=!0;for(let s=0;n&&s<t.length;s++)n=$a(t[s],e[s]);return n}function $a(t,e){if(t===e)return!0;let n=ec(t),s=ec(e);if(n||s)return n&&s?t.getTime()===e.getTime():!1;if(n=Lt(t),s=Lt(e),n||s)return t===e;if(n=K(t),s=K(e),n||s)return n&&s?fg(t,e):!1;if(n=ue(t),s=ue(e),n||s){if(!n||!s)return!1;const i=Object.keys(t).length,r=Object.keys(e).length;if(i!==r)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!$a(t[o],e[o]))return!1}}return String(t)===String(e)}const mh=t=>!!(t&&t.__v_isRef===!0),st=t=>Se(t)?t:t==null?"":K(t)||ue(t)&&(t.toString===dh||!J(t.toString))?mh(t)?st(t.value):JSON.stringify(t,yh,2):String(t),yh=(t,e)=>mh(e)?yh(t,e.value):ds(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,i],r)=>(n[wo(s,r)+" =>"]=i,n),{})}:uh(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>wo(n))}:Lt(e)?wo(e):ue(e)&&!K(e)&&!fh(e)?String(e):e,wo=(t,e="")=>{var n;return Lt(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};let Xe;class pg{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.__v_skip=!0,this.parent=Xe,!e&&Xe&&(this.index=(Xe.scopes||(Xe.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Xe;try{return Xe=this,e()}finally{Xe=n}}}on(){++this._on===1&&(this.prevScope=Xe,Xe=this)}off(){this._on>0&&--this._on===0&&(Xe=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function gg(){return Xe}let me;const Eo=new WeakSet;class vh{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Xe&&Xe.active&&Xe.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Eo.has(this)&&(Eo.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||wh(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,nc(this),Eh(this);const e=me,n=yt;me=this,yt=!0;try{return this.fn()}finally{Ch(this),me=e,yt=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)ja(e);this.deps=this.depsTail=void 0,nc(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Eo.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Jo(this)&&this.run()}get dirty(){return Jo(this)}}let bh=0,Js,Xs;function wh(t,e=!1){if(t.flags|=8,e){t.next=Xs,Xs=t;return}t.next=Js,Js=t}function Va(){bh++}function Wa(){if(--bh>0)return;if(Xs){let e=Xs;for(Xs=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Js;){let e=Js;for(Js=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=n}}if(t)throw t}function Eh(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Ch(t){let e,n=t.depsTail,s=n;for(;s;){const i=s.prevDep;s.version===-1?(s===n&&(n=i),ja(s),_g(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=i}t.deps=e,t.depsTail=n}function Jo(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Ih(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Ih(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===di)||(t.globalVersion=di,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Jo(t))))return;t.flags|=2;const e=t.dep,n=me,s=yt;me=t,yt=!0;try{Eh(t);const i=t.fn(t._value);(e.version===0||yn(i,t._value))&&(t.flags|=128,t._value=i,e.version++)}catch(i){throw e.version++,i}finally{me=n,yt=s,Ch(t),t.flags&=-3}}function ja(t,e=!1){const{dep:n,prevSub:s,nextSub:i}=t;if(s&&(s.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=s,t.nextSub=void 0),n.subs===t&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let r=n.computed.deps;r;r=r.nextDep)ja(r,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function _g(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let yt=!0;const Th=[];function Yt(){Th.push(yt),yt=!1}function Qt(){const t=Th.pop();yt=t===void 0?!0:t}function nc(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=me;me=void 0;try{e()}finally{me=n}}}let di=0;class mg{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ga{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!me||!yt||me===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==me)n=this.activeLink=new mg(me,this),me.deps?(n.prevDep=me.depsTail,me.depsTail.nextDep=n,me.depsTail=n):me.deps=me.depsTail=n,Sh(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=me.depsTail,n.nextDep=void 0,me.depsTail.nextDep=n,me.depsTail=n,me.deps===n&&(me.deps=s)}return n}trigger(e){this.version++,di++,this.notify(e)}notify(e){Va();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Wa()}}}function Sh(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)Sh(s)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Xo=new WeakMap,jn=Symbol(""),Zo=Symbol(""),fi=Symbol("");function Fe(t,e,n){if(yt&&me){let s=Xo.get(t);s||Xo.set(t,s=new Map);let i=s.get(n);i||(s.set(n,i=new Ga),i.map=s,i.key=n),i.track()}}function Wt(t,e,n,s,i,r){const o=Xo.get(t);if(!o){di++;return}const a=l=>{l&&l.trigger()};if(Va(),e==="clear")o.forEach(a);else{const l=K(t),c=l&&Ba(n);if(l&&n==="length"){const u=Number(s);o.forEach((h,d)=>{(d==="length"||d===fi||!Lt(d)&&d>=u)&&a(h)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),c&&a(o.get(fi)),e){case"add":l?c&&a(o.get("length")):(a(o.get(jn)),ds(t)&&a(o.get(Zo)));break;case"delete":l||(a(o.get(jn)),ds(t)&&a(o.get(Zo)));break;case"set":ds(t)&&a(o.get(jn));break}}Wa()}function ss(t){const e=re(t);return e===t?e:(Fe(e,"iterate",fi),dt(t)?e:e.map(wt))}function Kr(t){return Fe(t=re(t),"iterate",fi),t}function un(t,e){return Jt(t)?ws(Gn(t)?wt(e):e):wt(e)}const yg={__proto__:null,[Symbol.iterator](){return Co(this,Symbol.iterator,t=>un(this,t))},concat(...t){return ss(this).concat(...t.map(e=>K(e)?ss(e):e))},entries(){return Co(this,"entries",t=>(t[1]=un(this,t[1]),t))},every(t,e){return Bt(this,"every",t,e,void 0,arguments)},filter(t,e){return Bt(this,"filter",t,e,n=>n.map(s=>un(this,s)),arguments)},find(t,e){return Bt(this,"find",t,e,n=>un(this,n),arguments)},findIndex(t,e){return Bt(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Bt(this,"findLast",t,e,n=>un(this,n),arguments)},findLastIndex(t,e){return Bt(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Bt(this,"forEach",t,e,void 0,arguments)},includes(...t){return Io(this,"includes",t)},indexOf(...t){return Io(this,"indexOf",t)},join(t){return ss(this).join(t)},lastIndexOf(...t){return Io(this,"lastIndexOf",t)},map(t,e){return Bt(this,"map",t,e,void 0,arguments)},pop(){return $s(this,"pop")},push(...t){return $s(this,"push",t)},reduce(t,...e){return sc(this,"reduce",t,e)},reduceRight(t,...e){return sc(this,"reduceRight",t,e)},shift(){return $s(this,"shift")},some(t,e){return Bt(this,"some",t,e,void 0,arguments)},splice(...t){return $s(this,"splice",t)},toReversed(){return ss(this).toReversed()},toSorted(t){return ss(this).toSorted(t)},toSpliced(...t){return ss(this).toSpliced(...t)},unshift(...t){return $s(this,"unshift",t)},values(){return Co(this,"values",t=>un(this,t))}};function Co(t,e,n){const s=Kr(t),i=s[e]();return s!==t&&!dt(t)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.done||(r.value=n(r.value)),r}),i}const vg=Array.prototype;function Bt(t,e,n,s,i,r){const o=Kr(t),a=o!==t&&!dt(t),l=o[e];if(l!==vg[e]){const h=l.apply(t,r);return a?wt(h):h}let c=n;o!==t&&(a?c=function(h,d){return n.call(this,un(t,h),d,t)}:n.length>2&&(c=function(h,d){return n.call(this,h,d,t)}));const u=l.call(o,c,s);return a&&i?i(u):u}function sc(t,e,n,s){const i=Kr(t);let r=n;return i!==t&&(dt(t)?n.length>3&&(r=function(o,a,l){return n.call(this,o,a,l,t)}):r=function(o,a,l){return n.call(this,o,un(t,a),l,t)}),i[e](r,...s)}function Io(t,e,n){const s=re(t);Fe(s,"iterate",fi);const i=s[e](...n);return(i===-1||i===!1)&&qa(n[0])?(n[0]=re(n[0]),s[e](...n)):i}function $s(t,e,n=[]){Yt(),Va();const s=re(t)[e].apply(t,n);return Wa(),Qt(),s}const bg=La("__proto__,__v_isRef,__isVue"),Rh=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Lt));function wg(t){Lt(t)||(t=String(t));const e=re(this);return Fe(e,"has",t),e.hasOwnProperty(t)}class Ah{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,s){if(n==="__v_skip")return e.__v_skip;const i=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!i;if(n==="__v_isReadonly")return i;if(n==="__v_isShallow")return r;if(n==="__v_raw")return s===(i?r?kg:xh:r?kh:Ph).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=K(e);if(!i){let l;if(o&&(l=yg[n]))return l;if(n==="hasOwnProperty")return wg}const a=Reflect.get(e,n,Be(e)?e:s);if((Lt(n)?Rh.has(n):bg(n))||(i||Fe(e,"get",n),r))return a;if(Be(a)){const l=o&&Ba(n)?a:a.value;return i&&ue(l)?ta(l):l}return ue(a)?i?ta(a):xi(a):a}}class Nh extends Ah{constructor(e=!1){super(!1,e)}set(e,n,s,i){let r=e[n];const o=K(e)&&Ba(n);if(!this._isShallow){const c=Jt(r);if(!dt(s)&&!Jt(s)&&(r=re(r),s=re(s)),!o&&Be(r)&&!Be(s))return c||(r.value=s),!0}const a=o?Number(n)<e.length:ce(e,n),l=Reflect.set(e,n,s,Be(e)?e:i);return e===re(i)&&(a?yn(s,r)&&Wt(e,"set",n,s):Wt(e,"add",n,s)),l}deleteProperty(e,n){const s=ce(e,n);e[n];const i=Reflect.deleteProperty(e,n);return i&&s&&Wt(e,"delete",n,void 0),i}has(e,n){const s=Reflect.has(e,n);return(!Lt(n)||!Rh.has(n))&&Fe(e,"has",n),s}ownKeys(e){return Fe(e,"iterate",K(e)?"length":jn),Reflect.ownKeys(e)}}class Eg extends Ah{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const Cg=new Nh,Ig=new Eg,Tg=new Nh(!0);const ea=t=>t,Ki=t=>Reflect.getPrototypeOf(t);function Sg(t,e,n){return function(...s){const i=this.__v_raw,r=re(i),o=ds(r),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=i[t](...s),u=n?ea:e?ws:wt;return!e&&Fe(r,"iterate",l?Zo:jn),Re(Object.create(c),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}}})}}function zi(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Rg(t,e){const n={get(i){const r=this.__v_raw,o=re(r),a=re(i);t||(yn(i,a)&&Fe(o,"get",i),Fe(o,"get",a));const{has:l}=Ki(o),c=e?ea:t?ws:wt;if(l.call(o,i))return c(r.get(i));if(l.call(o,a))return c(r.get(a));r!==o&&r.get(i)},get size(){const i=this.__v_raw;return!t&&Fe(re(i),"iterate",jn),i.size},has(i){const r=this.__v_raw,o=re(r),a=re(i);return t||(yn(i,a)&&Fe(o,"has",i),Fe(o,"has",a)),i===a?r.has(i):r.has(i)||r.has(a)},forEach(i,r){const o=this,a=o.__v_raw,l=re(a),c=e?ea:t?ws:wt;return!t&&Fe(l,"iterate",jn),a.forEach((u,h)=>i.call(r,c(u),c(h),o))}};return Re(n,t?{add:zi("add"),set:zi("set"),delete:zi("delete"),clear:zi("clear")}:{add(i){!e&&!dt(i)&&!Jt(i)&&(i=re(i));const r=re(this);return Ki(r).has.call(r,i)||(r.add(i),Wt(r,"add",i,i)),this},set(i,r){!e&&!dt(r)&&!Jt(r)&&(r=re(r));const o=re(this),{has:a,get:l}=Ki(o);let c=a.call(o,i);c||(i=re(i),c=a.call(o,i));const u=l.call(o,i);return o.set(i,r),c?yn(r,u)&&Wt(o,"set",i,r):Wt(o,"add",i,r),this},delete(i){const r=re(this),{has:o,get:a}=Ki(r);let l=o.call(r,i);l||(i=re(i),l=o.call(r,i)),a&&a.call(r,i);const c=r.delete(i);return l&&Wt(r,"delete",i,void 0),c},clear(){const i=re(this),r=i.size!==0,o=i.clear();return r&&Wt(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=Sg(i,t,e)}),n}function Ka(t,e){const n=Rg(t,e);return(s,i,r)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?s:Reflect.get(ce(n,i)&&i in s?n:s,i,r)}const Ag={get:Ka(!1,!1)},Ng={get:Ka(!1,!0)},Pg={get:Ka(!0,!1)};const Ph=new WeakMap,kh=new WeakMap,xh=new WeakMap,kg=new WeakMap;function xg(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Og(t){return t.__v_skip||!Object.isExtensible(t)?0:xg(sg(t))}function xi(t){return Jt(t)?t:za(t,!1,Cg,Ag,Ph)}function Oh(t){return za(t,!1,Tg,Ng,kh)}function ta(t){return za(t,!0,Ig,Pg,xh)}function za(t,e,n,s,i){if(!ue(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=Og(t);if(r===0)return t;const o=i.get(t);if(o)return o;const a=new Proxy(t,r===2?s:n);return i.set(t,a),a}function Gn(t){return Jt(t)?Gn(t.__v_raw):!!(t&&t.__v_isReactive)}function Jt(t){return!!(t&&t.__v_isReadonly)}function dt(t){return!!(t&&t.__v_isShallow)}function qa(t){return t?!!t.__v_raw:!1}function re(t){const e=t&&t.__v_raw;return e?re(e):t}function Dg(t){return!ce(t,"__v_skip")&&Object.isExtensible(t)&&gh(t,"__v_skip",!0),t}const wt=t=>ue(t)?xi(t):t,ws=t=>ue(t)?ta(t):t;function Be(t){return t?t.__v_isRef===!0:!1}function ct(t){return Dh(t,!1)}function Mg(t){return Dh(t,!0)}function Dh(t,e){return Be(t)?t:new Lg(t,e)}class Lg{constructor(e,n){this.dep=new Ga,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:re(e),this._value=n?e:wt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,s=this.__v_isShallow||dt(e)||Jt(e);e=s?e:re(e),yn(e,n)&&(this._rawValue=e,this._value=s?e:wt(e),this.dep.trigger())}}function vn(t){return Be(t)?t.value:t}const Fg={get:(t,e,n)=>e==="__v_raw"?t:vn(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const i=t[e];return Be(i)&&!Be(n)?(i.value=n,!0):Reflect.set(t,e,n,s)}};function Mh(t){return Gn(t)?t:new Proxy(t,Fg)}class Ug{constructor(e,n,s){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Ga(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=di-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&me!==this)return wh(this,!0),!0}get value(){const e=this.dep.track();return Ih(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Bg(t,e,n=!1){let s,i;return J(t)?s=t:(s=t.get,i=t.set),new Ug(s,i,n)}const qi={},ur=new WeakMap;let Un;function Hg(t,e=!1,n=Un){if(n){let s=ur.get(n);s||ur.set(n,s=[]),s.push(t)}}function $g(t,e,n=ge){const{immediate:s,deep:i,once:r,scheduler:o,augmentJob:a,call:l}=n,c=S=>i?S:dt(S)||i===!1||i===0?jt(S,1):jt(S);let u,h,d,p,m=!1,y=!1;if(Be(t)?(h=()=>t.value,m=dt(t)):Gn(t)?(h=()=>c(t),m=!0):K(t)?(y=!0,m=t.some(S=>Gn(S)||dt(S)),h=()=>t.map(S=>{if(Be(S))return S.value;if(Gn(S))return c(S);if(J(S))return l?l(S,2):S()})):J(t)?e?h=l?()=>l(t,2):t:h=()=>{if(d){Yt();try{d()}finally{Qt()}}const S=Un;Un=u;try{return l?l(t,3,[p]):t(p)}finally{Un=S}}:h=Ot,e&&i){const S=h,v=i===!0?1/0:i;h=()=>jt(S(),v)}const k=gg(),L=()=>{u.stop(),k&&k.active&&Ua(k.effects,u)};if(r&&e){const S=e;e=(...v)=>{S(...v),L()}}let R=y?new Array(t.length).fill(qi):qi;const F=S=>{if(!(!(u.flags&1)||!u.dirty&&!S))if(e){const v=u.run();if(i||m||(y?v.some((I,N)=>yn(I,R[N])):yn(v,R))){d&&d();const I=Un;Un=u;try{const N=[v,R===qi?void 0:y&&R[0]===qi?[]:R,p];R=v,l?l(e,3,N):e(...N)}finally{Un=I}}}else u.run()};return a&&a(F),u=new vh(h),u.scheduler=o?()=>o(F,!1):F,p=S=>Hg(S,!1,u),d=u.onStop=()=>{const S=ur.get(u);if(S){if(l)l(S,4);else for(const v of S)v();ur.delete(u)}},e?s?F(!0):R=u.run():o?o(F.bind(null,!0),!0):u.run(),L.pause=u.pause.bind(u),L.resume=u.resume.bind(u),L.stop=L,L}function jt(t,e=1/0,n){if(e<=0||!ue(t)||t.__v_skip||(n=n||new Map,(n.get(t)||0)>=e))return t;if(n.set(t,e),e--,Be(t))jt(t.value,e,n);else if(K(t))for(let s=0;s<t.length;s++)jt(t[s],e,n);else if(uh(t)||ds(t))t.forEach(s=>{jt(s,e,n)});else if(fh(t)){for(const s in t)jt(t[s],e,n);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&jt(t[s],e,n)}return t}function Oi(t,e,n,s){try{return s?t(...s):t()}catch(i){zr(i,e,n)}}function Et(t,e,n,s){if(J(t)){const i=Oi(t,e,n,s);return i&&hh(i)&&i.catch(r=>{zr(r,e,n)}),i}if(K(t)){const i=[];for(let r=0;r<t.length;r++)i.push(Et(t[r],e,n,s));return i}}function zr(t,e,n,s=!0){const i=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||ge;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const u=a.ec;if(u){for(let h=0;h<u.length;h++)if(u[h](t,l,c)===!1)return}a=a.parent}if(r){Yt(),Oi(r,null,10,[t,l,c]),Qt();return}}Vg(t,n,i,s,o)}function Vg(t,e,n,s=!0,i=!1){if(i)throw t;console.error(t)}const Ve=[];let Pt=-1;const fs=[];let hn=null,rs=0;const Lh=Promise.resolve();let hr=null;function Fh(t){const e=hr||Lh;return t?e.then(this?t.bind(this):t):e}function Wg(t){let e=Pt+1,n=Ve.length;for(;e<n;){const s=e+n>>>1,i=Ve[s],r=pi(i);r<t||r===t&&i.flags&2?e=s+1:n=s}return e}function Ya(t){if(!(t.flags&1)){const e=pi(t),n=Ve[Ve.length-1];!n||!(t.flags&2)&&e>=pi(n)?Ve.push(t):Ve.splice(Wg(e),0,t),t.flags|=1,Uh()}}function Uh(){hr||(hr=Lh.then(Hh))}function jg(t){K(t)?fs.push(...t):hn&&t.id===-1?hn.splice(rs+1,0,t):t.flags&1||(fs.push(t),t.flags|=1),Uh()}function ic(t,e,n=Pt+1){for(;n<Ve.length;n++){const s=Ve[n];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;Ve.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function Bh(t){if(fs.length){const e=[...new Set(fs)].sort((n,s)=>pi(n)-pi(s));if(fs.length=0,hn){hn.push(...e);return}for(hn=e,rs=0;rs<hn.length;rs++){const n=hn[rs];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}hn=null,rs=0}}const pi=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Hh(t){try{for(Pt=0;Pt<Ve.length;Pt++){const e=Ve[Pt];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Oi(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Pt<Ve.length;Pt++){const e=Ve[Pt];e&&(e.flags&=-2)}Pt=-1,Ve.length=0,Bh(),hr=null,(Ve.length||fs.length)&&Hh()}}let ut=null,$h=null;function dr(t){const e=ut;return ut=t,$h=t&&t.type.__scopeId||null,e}function na(t,e=ut,n){if(!e||t._n)return t;const s=(...i)=>{s._d&&gr(-1);const r=dr(e);let o;try{o=t(...i)}finally{dr(r),s._d&&gr(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function Gg(t,e){if(ut===null)return t;const n=Zr(ut),s=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[r,o,a,l=ge]=e[i];r&&(J(r)&&(r={mounted:r,updated:r}),r.deep&&jt(o),s.push({dir:r,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function Mn(t,e,n,s){const i=t.dirs,r=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];r&&(a.oldValue=r[o].value);let l=a.dir[s];l&&(Yt(),Et(l,n,8,[t.el,a,t,e]),Qt())}}function Zi(t,e){if(je){let n=je.provides;const s=je.parent&&je.parent.provides;s===n&&(n=je.provides=Object.create(s)),n[t]=e}}function vt(t,e,n=!1){const s=el();if(s||ps){let i=ps?ps._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return n&&J(e)?e.call(s&&s.proxy):e}}const Kg=Symbol.for("v-scx"),zg=()=>vt(Kg);function er(t,e,n){return Vh(t,e,n)}function Vh(t,e,n=ge){const{immediate:s,deep:i,flush:r,once:o}=n,a=Re({},n),l=e&&s||!e&&r!=="post";let c;if(mi){if(r==="sync"){const p=zg();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=Ot,p.resume=Ot,p.pause=Ot,p}}const u=je;a.call=(p,m,y)=>Et(p,u,m,y);let h=!1;r==="post"?a.scheduler=p=>{Je(p,u&&u.suspense)}:r!=="sync"&&(h=!0,a.scheduler=(p,m)=>{m?p():Ya(p)}),a.augmentJob=p=>{e&&(p.flags|=4),h&&(p.flags|=2,u&&(p.id=u.uid,p.i=u))};const d=$g(t,e,a);return mi&&(c?c.push(d):l&&d()),d}function qg(t,e,n){const s=this.proxy,i=Se(t)?t.includes(".")?Wh(s,t):()=>s[t]:t.bind(s,s);let r;J(e)?r=e:(r=e.handler,n=e);const o=Di(this),a=Vh(i,r.bind(s),n);return o(),a}function Wh(t,e){const n=e.split(".");return()=>{let s=t;for(let i=0;i<n.length&&s;i++)s=s[n[i]];return s}}const Yg=Symbol("_vte"),jh=t=>t.__isTeleport,kt=Symbol("_leaveCb"),Vs=Symbol("_enterCb");function Gh(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Qr(()=>{t.isMounted=!0}),ed(()=>{t.isUnmounting=!0}),t}const lt=[Function,Array],Kh={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:lt,onEnter:lt,onAfterEnter:lt,onEnterCancelled:lt,onBeforeLeave:lt,onLeave:lt,onAfterLeave:lt,onLeaveCancelled:lt,onBeforeAppear:lt,onAppear:lt,onAfterAppear:lt,onAppearCancelled:lt},zh=t=>{const e=t.subTree;return e.component?zh(e.component):e},Qg={name:"BaseTransition",props:Kh,setup(t,{slots:e}){const n=el(),s=Gh();return()=>{const i=e.default&&Qa(e.default(),!0);if(!i||!i.length)return;const r=qh(i),o=re(t),{mode:a}=o;if(s.isLeaving)return To(r);const l=rc(r);if(!l)return To(r);let c=gi(l,o,s,n,h=>c=h);l.type!==We&&Kn(l,c);let u=n.subTree&&rc(n.subTree);if(u&&u.type!==We&&!$n(u,l)&&zh(n).type!==We){let h=gi(u,o,s,n);if(Kn(u,h),a==="out-in"&&l.type!==We)return s.isLeaving=!0,h.afterLeave=()=>{s.isLeaving=!1,n.job.flags&8||n.update(),delete h.afterLeave,u=void 0},To(r);a==="in-out"&&l.type!==We?h.delayLeave=(d,p,m)=>{const y=Yh(s,u);y[String(u.key)]=u,d[kt]=()=>{p(),d[kt]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{m(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return r}}};function qh(t){let e=t[0];if(t.length>1){for(const n of t)if(n.type!==We){e=n;break}}return e}const Jg=Qg;function Yh(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function gi(t,e,n,s,i){const{appear:r,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:h,onBeforeLeave:d,onLeave:p,onAfterLeave:m,onLeaveCancelled:y,onBeforeAppear:k,onAppear:L,onAfterAppear:R,onAppearCancelled:F}=e,S=String(t.key),v=Yh(n,t),I=($,q)=>{$&&Et($,s,9,q)},N=($,q)=>{const X=q[1];I($,q),K($)?$.every(O=>O.length<=1)&&X():$.length<=1&&X()},Q={mode:o,persisted:a,beforeEnter($){let q=l;if(!n.isMounted)if(r)q=k||l;else return;$[kt]&&$[kt](!0);const X=v[S];X&&$n(t,X)&&X.el[kt]&&X.el[kt](),I(q,[$])},enter($){let q=c,X=u,O=h;if(!n.isMounted)if(r)q=L||c,X=R||u,O=F||h;else return;let ne=!1;$[Vs]=tt=>{ne||(ne=!0,tt?I(O,[$]):I(X,[$]),Q.delayedLeave&&Q.delayedLeave(),$[Vs]=void 0)};const ke=$[Vs].bind(null,!1);q?N(q,[$,ke]):ke()},leave($,q){const X=String(t.key);if($[Vs]&&$[Vs](!0),n.isUnmounting)return q();I(d,[$]);let O=!1;$[kt]=ke=>{O||(O=!0,q(),ke?I(y,[$]):I(m,[$]),$[kt]=void 0,v[X]===t&&delete v[X])};const ne=$[kt].bind(null,!1);v[X]=t,p?N(p,[$,ne]):ne()},clone($){const q=gi($,e,n,s,i);return i&&i(q),q}};return Q}function To(t){if(qr(t))return t=Rn(t),t.children=null,t}function rc(t){if(!qr(t))return jh(t.type)&&t.children?qh(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:n}=t;if(n){if(e&16)return n[0];if(e&32&&J(n.default))return n.default()}}function Kn(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Kn(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Qa(t,e=!1,n){let s=[],i=0;for(let r=0;r<t.length;r++){let o=t[r];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:r);o.type===De?(o.patchFlag&128&&i++,s=s.concat(Qa(o.children,e,a))):(e||o.type!==We)&&s.push(a!=null?Rn(o,{key:a}):o)}if(i>1)for(let r=0;r<s.length;r++)s[r].patchFlag=-2;return s}function Qh(t,e){return J(t)?Re({name:t.name},e,{setup:t}):t}function Jh(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function oc(t,e){let n;return!!((n=Object.getOwnPropertyDescriptor(t,e))&&!n.configurable)}const fr=new WeakMap;function Zs(t,e,n,s,i=!1){if(K(t)){t.forEach((y,k)=>Zs(y,e&&(K(e)?e[k]:e),n,s,i));return}if(ei(s)&&!i){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Zs(t,e,n,s.component.subTree);return}const r=s.shapeFlag&4?Zr(s.component):s.el,o=i?null:r,{i:a,r:l}=t,c=e&&e.r,u=a.refs===ge?a.refs={}:a.refs,h=a.setupState,d=re(h),p=h===ge?ch:y=>oc(u,y)?!1:ce(d,y),m=(y,k)=>!(k&&oc(u,k));if(c!=null&&c!==l){if(ac(e),Se(c))u[c]=null,p(c)&&(h[c]=null);else if(Be(c)){const y=e;m(c,y.k)&&(c.value=null),y.k&&(u[y.k]=null)}}if(J(l))Oi(l,a,12,[o,u]);else{const y=Se(l),k=Be(l);if(y||k){const L=()=>{if(t.f){const R=y?p(l)?h[l]:u[l]:m()||!t.k?l.value:u[t.k];if(i)K(R)&&Ua(R,r);else if(K(R))R.includes(r)||R.push(r);else if(y)u[l]=[r],p(l)&&(h[l]=u[l]);else{const F=[r];m(l,t.k)&&(l.value=F),t.k&&(u[t.k]=F)}}else y?(u[l]=o,p(l)&&(h[l]=o)):k&&(m(l,t.k)&&(l.value=o),t.k&&(u[t.k]=o))};if(o){const R=()=>{L(),fr.delete(t)};R.id=-1,fr.set(t,R),Je(R,n)}else ac(t),L()}}}function ac(t){const e=fr.get(t);e&&(e.flags|=8,fr.delete(t))}jr().requestIdleCallback;jr().cancelIdleCallback;const ei=t=>!!t.type.__asyncLoader,qr=t=>t.type.__isKeepAlive;function Xg(t,e){Xh(t,"a",e)}function Zg(t,e){Xh(t,"da",e)}function Xh(t,e,n=je){const s=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(Yr(e,s,n),n){let i=n.parent;for(;i&&i.parent;)qr(i.parent.vnode)&&e_(s,e,n,i),i=i.parent}}function e_(t,e,n,s){const i=Yr(e,t,s,!0);td(()=>{Ua(s[e],i)},n)}function Yr(t,e,n=je,s=!1){if(n){const i=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{Yt();const a=Di(n),l=Et(e,n,t,o);return a(),Qt(),l});return s?i.unshift(r):i.push(r),r}}const nn=t=>(e,n=je)=>{(!mi||t==="sp")&&Yr(t,(...s)=>e(...s),n)},t_=nn("bm"),Qr=nn("m"),n_=nn("bu"),Zh=nn("u"),ed=nn("bum"),td=nn("um"),s_=nn("sp"),i_=nn("rtg"),r_=nn("rtc");function o_(t,e=je){Yr("ec",t,e)}const a_=Symbol.for("v-ndc");function ls(t,e,n,s){let i;const r=n,o=K(t);if(o||Se(t)){const a=o&&Gn(t);let l=!1,c=!1;a&&(l=!dt(t),c=Jt(t),t=Kr(t)),i=new Array(t.length);for(let u=0,h=t.length;u<h;u++)i[u]=e(l?c?ws(wt(t[u])):wt(t[u]):t[u],u,void 0,r)}else if(typeof t=="number"){i=new Array(t);for(let a=0;a<t;a++)i[a]=e(a+1,a,void 0,r)}else if(ue(t))if(t[Symbol.iterator])i=Array.from(t,(a,l)=>e(a,l,void 0,r));else{const a=Object.keys(t);i=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const u=a[l];i[l]=e(t[u],u,l,r)}}else i=[];return i}const sa=t=>t?Ed(t)?Zr(t):sa(t.parent):null,ti=Re(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>sa(t.parent),$root:t=>sa(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>sd(t),$forceUpdate:t=>t.f||(t.f=()=>{Ya(t.update)}),$nextTick:t=>t.n||(t.n=Fh.bind(t.proxy)),$watch:t=>qg.bind(t)}),So=(t,e)=>t!==ge&&!t.__isScriptSetup&&ce(t,e),l_={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:s,data:i,props:r,accessCache:o,type:a,appContext:l}=t;if(e[0]!=="$"){const d=o[e];if(d!==void 0)switch(d){case 1:return s[e];case 2:return i[e];case 4:return n[e];case 3:return r[e]}else{if(So(s,e))return o[e]=1,s[e];if(i!==ge&&ce(i,e))return o[e]=2,i[e];if(ce(r,e))return o[e]=3,r[e];if(n!==ge&&ce(n,e))return o[e]=4,n[e];ia&&(o[e]=0)}}const c=ti[e];let u,h;if(c)return e==="$attrs"&&Fe(t.attrs,"get",""),c(t);if((u=a.__cssModules)&&(u=u[e]))return u;if(n!==ge&&ce(n,e))return o[e]=4,n[e];if(h=l.config.globalProperties,ce(h,e))return h[e]},set({_:t},e,n){const{data:s,setupState:i,ctx:r}=t;return So(i,e)?(i[e]=n,!0):s!==ge&&ce(s,e)?(s[e]=n,!0):ce(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:i,props:r,type:o}},a){let l;return!!(n[a]||t!==ge&&a[0]!=="$"&&ce(t,a)||So(e,a)||ce(r,a)||ce(s,a)||ce(ti,a)||ce(i.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ce(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function lc(t){return K(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let ia=!0;function c_(t){const e=sd(t),n=t.proxy,s=t.ctx;ia=!1,e.beforeCreate&&cc(e.beforeCreate,t,"bc");const{data:i,computed:r,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:p,updated:m,activated:y,deactivated:k,beforeDestroy:L,beforeUnmount:R,destroyed:F,unmounted:S,render:v,renderTracked:I,renderTriggered:N,errorCaptured:Q,serverPrefetch:$,expose:q,inheritAttrs:X,components:O,directives:ne,filters:ke}=e;if(c&&u_(c,s,null),o)for(const de in o){const ae=o[de];J(ae)&&(s[de]=ae.bind(n))}if(i){const de=i.call(n,n);ue(de)&&(t.data=xi(de))}if(ia=!0,r)for(const de in r){const ae=r[de],Ut=J(ae)?ae.bind(n,n):J(ae.get)?ae.get.bind(n,n):Ot,rn=!J(ae)&&J(ae.set)?ae.set.bind(n):Ot,It=Ze({get:Ut,set:rn});Object.defineProperty(s,de,{enumerable:!0,configurable:!0,get:()=>It.value,set:qe=>It.value=qe})}if(a)for(const de in a)nd(a[de],s,n,de);if(l){const de=J(l)?l.call(n):l;Reflect.ownKeys(de).forEach(ae=>{Zi(ae,de[ae])})}u&&cc(u,t,"c");function Te(de,ae){K(ae)?ae.forEach(Ut=>de(Ut.bind(n))):ae&&de(ae.bind(n))}if(Te(t_,h),Te(Qr,d),Te(n_,p),Te(Zh,m),Te(Xg,y),Te(Zg,k),Te(o_,Q),Te(r_,I),Te(i_,N),Te(ed,R),Te(td,S),Te(s_,$),K(q))if(q.length){const de=t.exposed||(t.exposed={});q.forEach(ae=>{Object.defineProperty(de,ae,{get:()=>n[ae],set:Ut=>n[ae]=Ut,enumerable:!0})})}else t.exposed||(t.exposed={});v&&t.render===Ot&&(t.render=v),X!=null&&(t.inheritAttrs=X),O&&(t.components=O),ne&&(t.directives=ne),$&&Jh(t)}function u_(t,e,n=Ot){K(t)&&(t=ra(t));for(const s in t){const i=t[s];let r;ue(i)?"default"in i?r=vt(i.from||s,i.default,!0):r=vt(i.from||s):r=vt(i),Be(r)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[s]=r}}function cc(t,e,n){Et(K(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function nd(t,e,n,s){let i=s.includes(".")?Wh(n,s):()=>n[s];if(Se(t)){const r=e[t];J(r)&&er(i,r)}else if(J(t))er(i,t.bind(n));else if(ue(t))if(K(t))t.forEach(r=>nd(r,e,n,s));else{const r=J(t.handler)?t.handler.bind(n):e[t.handler];J(r)&&er(i,r,t)}}function sd(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,a=r.get(e);let l;return a?l=a:!i.length&&!n&&!s?l=e:(l={},i.length&&i.forEach(c=>pr(l,c,o,!0)),pr(l,e,o)),ue(e)&&r.set(e,l),l}function pr(t,e,n,s=!1){const{mixins:i,extends:r}=e;r&&pr(t,r,n,!0),i&&i.forEach(o=>pr(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=h_[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const h_={data:uc,props:hc,emits:hc,methods:Ys,computed:Ys,beforeCreate:He,created:He,beforeMount:He,mounted:He,beforeUpdate:He,updated:He,beforeDestroy:He,beforeUnmount:He,destroyed:He,unmounted:He,activated:He,deactivated:He,errorCaptured:He,serverPrefetch:He,components:Ys,directives:Ys,watch:f_,provide:uc,inject:d_};function uc(t,e){return e?t?function(){return Re(J(t)?t.call(this,this):t,J(e)?e.call(this,this):e)}:e:t}function d_(t,e){return Ys(ra(t),ra(e))}function ra(t){if(K(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function He(t,e){return t?[...new Set([].concat(t,e))]:e}function Ys(t,e){return t?Re(Object.create(null),t,e):e}function hc(t,e){return t?K(t)&&K(e)?[...new Set([...t,...e])]:Re(Object.create(null),lc(t),lc(e??{})):e}function f_(t,e){if(!t)return e;if(!e)return t;const n=Re(Object.create(null),t);for(const s in e)n[s]=He(t[s],e[s]);return n}function id(){return{app:null,config:{isNativeTag:ch,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let p_=0;function g_(t,e){return function(s,i=null){J(s)||(s=Re({},s)),i!=null&&!ue(i)&&(i=null);const r=id(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:p_++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:z_,get config(){return r.config},set config(u){},use(u,...h){return o.has(u)||(u&&J(u.install)?(o.add(u),u.install(c,...h)):J(u)&&(o.add(u),u(c,...h))),c},mixin(u){return r.mixins.includes(u)||r.mixins.push(u),c},component(u,h){return h?(r.components[u]=h,c):r.components[u]},directive(u,h){return h?(r.directives[u]=h,c):r.directives[u]},mount(u,h,d){if(!l){const p=c._ceVNode||Ue(s,i);return p.appContext=r,d===!0?d="svg":d===!1&&(d=void 0),t(p,u,d),l=!0,c._container=u,u.__vue_app__=c,Zr(p.component)}},onUnmount(u){a.push(u)},unmount(){l&&(Et(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(u,h){return r.provides[u]=h,c},runWithContext(u){const h=ps;ps=c;try{return u()}finally{ps=h}}};return c}}let ps=null;const __=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Sn(e)}Modifiers`]||t[`${xn(e)}Modifiers`];function m_(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||ge;let i=n;const r=e.startsWith("update:"),o=r&&__(s,e.slice(7));o&&(o.trim&&(i=n.map(u=>Se(u)?u.trim():u)),o.number&&(i=n.map(Ha)));let a,l=s[a=bo(e)]||s[a=bo(Sn(e))];!l&&r&&(l=s[a=bo(xn(e))]),l&&Et(l,t,6,i);const c=s[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Et(c,t,6,i)}}const y_=new WeakMap;function rd(t,e,n=!1){const s=n?y_:e.emitsCache,i=s.get(t);if(i!==void 0)return i;const r=t.emits;let o={},a=!1;if(!J(t)){const l=c=>{const u=rd(c,e,!0);u&&(a=!0,Re(o,u))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(ue(t)&&s.set(t,null),null):(K(r)?r.forEach(l=>o[l]=null):Re(o,r),ue(t)&&s.set(t,o),o)}function Jr(t,e){return!t||!Vr(e)?!1:(e=e.slice(2).replace(/Once$/,""),ce(t,e[0].toLowerCase()+e.slice(1))||ce(t,xn(e))||ce(t,e))}function dc(t){const{type:e,vnode:n,proxy:s,withProxy:i,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:u,props:h,data:d,setupState:p,ctx:m,inheritAttrs:y}=t,k=dr(t);let L,R;try{if(n.shapeFlag&4){const S=i||s,v=S;L=xt(c.call(v,S,u,h,p,d,m)),R=a}else{const S=e;L=xt(S.length>1?S(h,{attrs:a,slots:o,emit:l}):S(h,null)),R=e.props?a:v_(a)}}catch(S){ni.length=0,zr(S,t,1),L=Ue(We)}let F=L;if(R&&y!==!1){const S=Object.keys(R),{shapeFlag:v}=F;S.length&&v&7&&(r&&S.some(Fa)&&(R=b_(R,r)),F=Rn(F,R,!1,!0))}return n.dirs&&(F=Rn(F,null,!1,!0),F.dirs=F.dirs?F.dirs.concat(n.dirs):n.dirs),n.transition&&Kn(F,n.transition),L=F,dr(k),L}const v_=t=>{let e;for(const n in t)(n==="class"||n==="style"||Vr(n))&&((e||(e={}))[n]=t[n]);return e},b_=(t,e)=>{const n={};for(const s in t)(!Fa(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function w_(t,e,n){const{props:s,children:i,component:r}=t,{props:o,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return s?fc(s,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(od(o,s,d)&&!Jr(c,d))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?fc(s,o,c):!0:!!o;return!1}function fc(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(od(e,t,r)&&!Jr(n,r))return!0}return!1}function od(t,e,n){const s=t[n],i=e[n];return n==="style"&&ue(s)&&ue(i)?!$a(s,i):s!==i}function E_({vnode:t,parent:e},n){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=n,e=e.parent;else break}}const ad={},ld=()=>Object.create(ad),cd=t=>Object.getPrototypeOf(t)===ad;function C_(t,e,n,s=!1){const i={},r=ld();t.propsDefaults=Object.create(null),ud(t,e,i,r);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=s?i:Oh(i):t.type.props?t.props=i:t.props=r,t.attrs=r}function I_(t,e,n,s){const{props:i,attrs:r,vnode:{patchFlag:o}}=t,a=re(i),[l]=t.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(Jr(t.emitsOptions,d))continue;const p=e[d];if(l)if(ce(r,d))p!==r[d]&&(r[d]=p,c=!0);else{const m=Sn(d);i[m]=oa(l,a,m,p,t,!1)}else p!==r[d]&&(r[d]=p,c=!0)}}}else{ud(t,e,i,r)&&(c=!0);let u;for(const h in a)(!e||!ce(e,h)&&((u=xn(h))===h||!ce(e,u)))&&(l?n&&(n[h]!==void 0||n[u]!==void 0)&&(i[h]=oa(l,a,h,void 0,t,!0)):delete i[h]);if(r!==a)for(const h in r)(!e||!ce(e,h))&&(delete r[h],c=!0)}c&&Wt(t.attrs,"set","")}function ud(t,e,n,s){const[i,r]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(Qs(l))continue;const c=e[l];let u;i&&ce(i,u=Sn(l))?!r||!r.includes(u)?n[u]=c:(a||(a={}))[u]=c:Jr(t.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,o=!0)}if(r){const l=re(n),c=a||ge;for(let u=0;u<r.length;u++){const h=r[u];n[h]=oa(i,l,h,c[h],t,!ce(c,h))}}return o}function oa(t,e,n,s,i,r){const o=t[n];if(o!=null){const a=ce(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&J(l)){const{propsDefaults:c}=i;if(n in c)s=c[n];else{const u=Di(i);s=c[n]=l.call(null,e),u()}}else s=l;i.ce&&i.ce._setProp(n,s)}o[0]&&(r&&!a?s=!1:o[1]&&(s===""||s===xn(n))&&(s=!0))}return s}const T_=new WeakMap;function hd(t,e,n=!1){const s=n?T_:e.propsCache,i=s.get(t);if(i)return i;const r=t.props,o={},a=[];let l=!1;if(!J(t)){const u=h=>{l=!0;const[d,p]=hd(h,e,!0);Re(o,d),p&&a.push(...p)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!r&&!l)return ue(t)&&s.set(t,hs),hs;if(K(r))for(let u=0;u<r.length;u++){const h=Sn(r[u]);pc(h)&&(o[h]=ge)}else if(r)for(const u in r){const h=Sn(u);if(pc(h)){const d=r[u],p=o[h]=K(d)||J(d)?{type:d}:Re({},d),m=p.type;let y=!1,k=!0;if(K(m))for(let L=0;L<m.length;++L){const R=m[L],F=J(R)&&R.name;if(F==="Boolean"){y=!0;break}else F==="String"&&(k=!1)}else y=J(m)&&m.name==="Boolean";p[0]=y,p[1]=k,(y||ce(p,"default"))&&a.push(h)}}const c=[o,a];return ue(t)&&s.set(t,c),c}function pc(t){return t[0]!=="$"&&!Qs(t)}const Ja=t=>t==="_"||t==="_ctx"||t==="$stable",Xa=t=>K(t)?t.map(xt):[xt(t)],S_=(t,e,n)=>{if(e._n)return e;const s=na((...i)=>Xa(e(...i)),n);return s._c=!1,s},dd=(t,e,n)=>{const s=t._ctx;for(const i in t){if(Ja(i))continue;const r=t[i];if(J(r))e[i]=S_(i,r,s);else if(r!=null){const o=Xa(r);e[i]=()=>o}}},fd=(t,e)=>{const n=Xa(e);t.slots.default=()=>n},pd=(t,e,n)=>{for(const s in e)(n||!Ja(s))&&(t[s]=e[s])},R_=(t,e,n)=>{const s=t.slots=ld();if(t.vnode.shapeFlag&32){const i=e._;i?(pd(s,e,n),n&&gh(s,"_",i,!0)):dd(e,s)}else e&&fd(t,e)},A_=(t,e,n)=>{const{vnode:s,slots:i}=t;let r=!0,o=ge;if(s.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:pd(i,e,n):(r=!e.$stable,dd(e,i)),o=e}else e&&(fd(t,e),o={default:1});if(r)for(const a in i)!Ja(a)&&o[a]==null&&delete i[a]},Je=O_;function N_(t){return P_(t)}function P_(t,e){const n=jr();n.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:d,setScopeId:p=Ot,insertStaticContent:m}=t,y=(f,g,_,b=null,C=null,w=null,D=void 0,x=null,P=!!g.dynamicChildren)=>{if(f===g)return;f&&!$n(f,g)&&(b=E(f),qe(f,C,w,!0),f=null),g.patchFlag===-2&&(P=!1,g.dynamicChildren=null);const{type:T,ref:j,shapeFlag:U}=g;switch(T){case Xr:k(f,g,_,b);break;case We:L(f,g,_,b);break;case Ao:f==null&&R(g,_,b,D);break;case De:O(f,g,_,b,C,w,D,x,P);break;default:U&1?v(f,g,_,b,C,w,D,x,P):U&6?ne(f,g,_,b,C,w,D,x,P):(U&64||U&128)&&T.process(f,g,_,b,C,w,D,x,P,V)}j!=null&&C?Zs(j,f&&f.ref,w,g||f,!g):j==null&&f&&f.ref!=null&&Zs(f.ref,null,w,f,!0)},k=(f,g,_,b)=>{if(f==null)s(g.el=a(g.children),_,b);else{const C=g.el=f.el;g.children!==f.children&&c(C,g.children)}},L=(f,g,_,b)=>{f==null?s(g.el=l(g.children||""),_,b):g.el=f.el},R=(f,g,_,b)=>{[f.el,f.anchor]=m(f.children,g,_,b,f.el,f.anchor)},F=({el:f,anchor:g},_,b)=>{let C;for(;f&&f!==g;)C=d(f),s(f,_,b),f=C;s(g,_,b)},S=({el:f,anchor:g})=>{let _;for(;f&&f!==g;)_=d(f),i(f),f=_;i(g)},v=(f,g,_,b,C,w,D,x,P)=>{if(g.type==="svg"?D="svg":g.type==="math"&&(D="mathml"),f==null)I(g,_,b,C,w,D,x,P);else{const T=f.el&&f.el._isVueCE?f.el:null;try{T&&T._beginPatch(),$(f,g,C,w,D,x,P)}finally{T&&T._endPatch()}}},I=(f,g,_,b,C,w,D,x)=>{let P,T;const{props:j,shapeFlag:U,transition:W,dirs:Y}=f;if(P=f.el=o(f.type,w,j&&j.is,j),U&8?u(P,f.children):U&16&&Q(f.children,P,null,b,C,Ro(f,w),D,x),Y&&Mn(f,null,b,"created"),N(P,f,f.scopeId,D,b),j){for(const _e in j)_e!=="value"&&!Qs(_e)&&r(P,_e,null,j[_e],w,b);"value"in j&&r(P,"value",null,j.value,w),(T=j.onVnodeBeforeMount)&&At(T,b,f)}Y&&Mn(f,null,b,"beforeMount");const ie=k_(C,W);ie&&W.beforeEnter(P),s(P,g,_),((T=j&&j.onVnodeMounted)||ie||Y)&&Je(()=>{T&&At(T,b,f),ie&&W.enter(P),Y&&Mn(f,null,b,"mounted")},C)},N=(f,g,_,b,C)=>{if(_&&p(f,_),b)for(let w=0;w<b.length;w++)p(f,b[w]);if(C){let w=C.subTree;if(g===w||yd(w.type)&&(w.ssContent===g||w.ssFallback===g)){const D=C.vnode;N(f,D,D.scopeId,D.slotScopeIds,C.parent)}}},Q=(f,g,_,b,C,w,D,x,P=0)=>{for(let T=P;T<f.length;T++){const j=f[T]=x?Vt(f[T]):xt(f[T]);y(null,j,g,_,b,C,w,D,x)}},$=(f,g,_,b,C,w,D)=>{const x=g.el=f.el;let{patchFlag:P,dynamicChildren:T,dirs:j}=g;P|=f.patchFlag&16;const U=f.props||ge,W=g.props||ge;let Y;if(_&&Ln(_,!1),(Y=W.onVnodeBeforeUpdate)&&At(Y,_,g,f),j&&Mn(g,f,_,"beforeUpdate"),_&&Ln(_,!0),(U.innerHTML&&W.innerHTML==null||U.textContent&&W.textContent==null)&&u(x,""),T?q(f.dynamicChildren,T,x,_,b,Ro(g,C),w):D||ae(f,g,x,null,_,b,Ro(g,C),w,!1),P>0){if(P&16)X(x,U,W,_,C);else if(P&2&&U.class!==W.class&&r(x,"class",null,W.class,C),P&4&&r(x,"style",U.style,W.style,C),P&8){const ie=g.dynamicProps;for(let _e=0;_e<ie.length;_e++){const he=ie[_e],Ye=U[he],Qe=W[he];(Qe!==Ye||he==="value")&&r(x,he,Ye,Qe,C,_)}}P&1&&f.children!==g.children&&u(x,g.children)}else!D&&T==null&&X(x,U,W,_,C);((Y=W.onVnodeUpdated)||j)&&Je(()=>{Y&&At(Y,_,g,f),j&&Mn(g,f,_,"updated")},b)},q=(f,g,_,b,C,w,D)=>{for(let x=0;x<g.length;x++){const P=f[x],T=g[x],j=P.el&&(P.type===De||!$n(P,T)||P.shapeFlag&198)?h(P.el):_;y(P,T,j,null,b,C,w,D,!0)}},X=(f,g,_,b,C)=>{if(g!==_){if(g!==ge)for(const w in g)!Qs(w)&&!(w in _)&&r(f,w,g[w],null,C,b);for(const w in _){if(Qs(w))continue;const D=_[w],x=g[w];D!==x&&w!=="value"&&r(f,w,x,D,C,b)}"value"in _&&r(f,"value",g.value,_.value,C)}},O=(f,g,_,b,C,w,D,x,P)=>{const T=g.el=f?f.el:a(""),j=g.anchor=f?f.anchor:a("");let{patchFlag:U,dynamicChildren:W,slotScopeIds:Y}=g;Y&&(x=x?x.concat(Y):Y),f==null?(s(T,_,b),s(j,_,b),Q(g.children||[],_,j,C,w,D,x,P)):U>0&&U&64&&W&&f.dynamicChildren&&f.dynamicChildren.length===W.length?(q(f.dynamicChildren,W,_,C,w,D,x),(g.key!=null||C&&g===C.subTree)&&gd(f,g,!0)):ae(f,g,_,j,C,w,D,x,P)},ne=(f,g,_,b,C,w,D,x,P)=>{g.slotScopeIds=x,f==null?g.shapeFlag&512?C.ctx.activate(g,_,b,D,P):ke(g,_,b,C,w,D,P):tt(f,g,P)},ke=(f,g,_,b,C,w,D)=>{const x=f.component=$_(f,b,C);if(qr(f)&&(x.ctx.renderer=V),V_(x,!1,D),x.asyncDep){if(C&&C.registerDep(x,Te,D),!f.el){const P=x.subTree=Ue(We);L(null,P,g,_),f.placeholder=P.el}}else Te(x,f,g,_,C,w,D)},tt=(f,g,_)=>{const b=g.component=f.component;if(w_(f,g,_))if(b.asyncDep&&!b.asyncResolved){de(b,g,_);return}else b.next=g,b.update();else g.el=f.el,b.vnode=g},Te=(f,g,_,b,C,w,D)=>{const x=()=>{if(f.isMounted){let{next:U,bu:W,u:Y,parent:ie,vnode:_e}=f;{const St=_d(f);if(St){U&&(U.el=_e.el,de(f,U,D)),St.asyncDep.then(()=>{Je(()=>{f.isUnmounted||T()},C)});return}}let he=U,Ye;Ln(f,!1),U?(U.el=_e.el,de(f,U,D)):U=_e,W&&Xi(W),(Ye=U.props&&U.props.onVnodeBeforeUpdate)&&At(Ye,ie,U,_e),Ln(f,!0);const Qe=dc(f),Tt=f.subTree;f.subTree=Qe,y(Tt,Qe,h(Tt.el),E(Tt),f,C,w),U.el=Qe.el,he===null&&E_(f,Qe.el),Y&&Je(Y,C),(Ye=U.props&&U.props.onVnodeUpdated)&&Je(()=>At(Ye,ie,U,_e),C)}else{let U;const{el:W,props:Y}=g,{bm:ie,m:_e,parent:he,root:Ye,type:Qe}=f,Tt=ei(g);Ln(f,!1),ie&&Xi(ie),!Tt&&(U=Y&&Y.onVnodeBeforeMount)&&At(U,he,g),Ln(f,!0);{Ye.ce&&Ye.ce._hasShadowRoot()&&Ye.ce._injectChildStyle(Qe);const St=f.subTree=dc(f);y(null,St,_,b,f,C,w),g.el=St.el}if(_e&&Je(_e,C),!Tt&&(U=Y&&Y.onVnodeMounted)){const St=g;Je(()=>At(U,he,St),C)}(g.shapeFlag&256||he&&ei(he.vnode)&&he.vnode.shapeFlag&256)&&f.a&&Je(f.a,C),f.isMounted=!0,g=_=b=null}};f.scope.on();const P=f.effect=new vh(x);f.scope.off();const T=f.update=P.run.bind(P),j=f.job=P.runIfDirty.bind(P);j.i=f,j.id=f.uid,P.scheduler=()=>Ya(j),Ln(f,!0),T()},de=(f,g,_)=>{g.component=f;const b=f.vnode.props;f.vnode=g,f.next=null,I_(f,g.props,b,_),A_(f,g.children,_),Yt(),ic(f),Qt()},ae=(f,g,_,b,C,w,D,x,P=!1)=>{const T=f&&f.children,j=f?f.shapeFlag:0,U=g.children,{patchFlag:W,shapeFlag:Y}=g;if(W>0){if(W&128){rn(T,U,_,b,C,w,D,x,P);return}else if(W&256){Ut(T,U,_,b,C,w,D,x,P);return}}Y&8?(j&16&&at(T,C,w),U!==T&&u(_,U)):j&16?Y&16?rn(T,U,_,b,C,w,D,x,P):at(T,C,w,!0):(j&8&&u(_,""),Y&16&&Q(U,_,b,C,w,D,x,P))},Ut=(f,g,_,b,C,w,D,x,P)=>{f=f||hs,g=g||hs;const T=f.length,j=g.length,U=Math.min(T,j);let W;for(W=0;W<U;W++){const Y=g[W]=P?Vt(g[W]):xt(g[W]);y(f[W],Y,_,null,C,w,D,x,P)}T>j?at(f,C,w,!0,!1,U):Q(g,_,b,C,w,D,x,P,U)},rn=(f,g,_,b,C,w,D,x,P)=>{let T=0;const j=g.length;let U=f.length-1,W=j-1;for(;T<=U&&T<=W;){const Y=f[T],ie=g[T]=P?Vt(g[T]):xt(g[T]);if($n(Y,ie))y(Y,ie,_,null,C,w,D,x,P);else break;T++}for(;T<=U&&T<=W;){const Y=f[U],ie=g[W]=P?Vt(g[W]):xt(g[W]);if($n(Y,ie))y(Y,ie,_,null,C,w,D,x,P);else break;U--,W--}if(T>U){if(T<=W){const Y=W+1,ie=Y<j?g[Y].el:b;for(;T<=W;)y(null,g[T]=P?Vt(g[T]):xt(g[T]),_,ie,C,w,D,x,P),T++}}else if(T>W)for(;T<=U;)qe(f[T],C,w,!0),T++;else{const Y=T,ie=T,_e=new Map;for(T=ie;T<=W;T++){const nt=g[T]=P?Vt(g[T]):xt(g[T]);nt.key!=null&&_e.set(nt.key,T)}let he,Ye=0;const Qe=W-ie+1;let Tt=!1,St=0;const Hs=new Array(Qe);for(T=0;T<Qe;T++)Hs[T]=0;for(T=Y;T<=U;T++){const nt=f[T];if(Ye>=Qe){qe(nt,C,w,!0);continue}let Rt;if(nt.key!=null)Rt=_e.get(nt.key);else for(he=ie;he<=W;he++)if(Hs[he-ie]===0&&$n(nt,g[he])){Rt=he;break}Rt===void 0?qe(nt,C,w,!0):(Hs[Rt-ie]=T+1,Rt>=St?St=Rt:Tt=!0,y(nt,g[Rt],_,null,C,w,D,x,P),Ye++)}const Jl=Tt?x_(Hs):hs;for(he=Jl.length-1,T=Qe-1;T>=0;T--){const nt=ie+T,Rt=g[nt],Xl=g[nt+1],Zl=nt+1<j?Xl.el||md(Xl):b;Hs[T]===0?y(null,Rt,_,Zl,C,w,D,x,P):Tt&&(he<0||T!==Jl[he]?It(Rt,_,Zl,2):he--)}}},It=(f,g,_,b,C=null)=>{const{el:w,type:D,transition:x,children:P,shapeFlag:T}=f;if(T&6){It(f.component.subTree,g,_,b);return}if(T&128){f.suspense.move(g,_,b);return}if(T&64){D.move(f,g,_,V);return}if(D===De){s(w,g,_);for(let U=0;U<P.length;U++)It(P[U],g,_,b);s(f.anchor,g,_);return}if(D===Ao){F(f,g,_);return}if(b!==2&&T&1&&x)if(b===0)x.beforeEnter(w),s(w,g,_),Je(()=>x.enter(w),C);else{const{leave:U,delayLeave:W,afterLeave:Y}=x,ie=()=>{f.ctx.isUnmounted?i(w):s(w,g,_)},_e=()=>{w._isLeaving&&w[kt](!0),U(w,()=>{ie(),Y&&Y()})};W?W(w,ie,_e):_e()}else s(w,g,_)},qe=(f,g,_,b=!1,C=!1)=>{const{type:w,props:D,ref:x,children:P,dynamicChildren:T,shapeFlag:j,patchFlag:U,dirs:W,cacheIndex:Y}=f;if(U===-2&&(C=!1),x!=null&&(Yt(),Zs(x,null,_,f,!0),Qt()),Y!=null&&(g.renderCache[Y]=void 0),j&256){g.ctx.deactivate(f);return}const ie=j&1&&W,_e=!ei(f);let he;if(_e&&(he=D&&D.onVnodeBeforeUnmount)&&At(he,g,f),j&6)Dn(f.component,_,b);else{if(j&128){f.suspense.unmount(_,b);return}ie&&Mn(f,null,g,"beforeUnmount"),j&64?f.type.remove(f,g,_,V,b):T&&!T.hasOnce&&(w!==De||U>0&&U&64)?at(T,g,_,!1,!0):(w===De&&U&384||!C&&j&16)&&at(P,g,_),b&&ts(f)}(_e&&(he=D&&D.onVnodeUnmounted)||ie)&&Je(()=>{he&&At(he,g,f),ie&&Mn(f,null,g,"unmounted")},_)},ts=f=>{const{type:g,el:_,anchor:b,transition:C}=f;if(g===De){ns(_,b);return}if(g===Ao){S(f);return}const w=()=>{i(_),C&&!C.persisted&&C.afterLeave&&C.afterLeave()};if(f.shapeFlag&1&&C&&!C.persisted){const{leave:D,delayLeave:x}=C,P=()=>D(_,w);x?x(f.el,w,P):P()}else w()},ns=(f,g)=>{let _;for(;f!==g;)_=d(f),i(f),f=_;i(g)},Dn=(f,g,_)=>{const{bum:b,scope:C,job:w,subTree:D,um:x,m:P,a:T}=f;gc(P),gc(T),b&&Xi(b),C.stop(),w&&(w.flags|=8,qe(D,f,g,_)),x&&Je(x,g),Je(()=>{f.isUnmounted=!0},g)},at=(f,g,_,b=!1,C=!1,w=0)=>{for(let D=w;D<f.length;D++)qe(f[D],g,_,b,C)},E=f=>{if(f.shapeFlag&6)return E(f.component.subTree);if(f.shapeFlag&128)return f.suspense.next();const g=d(f.anchor||f.el),_=g&&g[Yg];return _?d(_):g};let H=!1;const M=(f,g,_)=>{let b;f==null?g._vnode&&(qe(g._vnode,null,null,!0),b=g._vnode.component):y(g._vnode||null,f,g,null,null,null,_),g._vnode=f,H||(H=!0,ic(b),Bh(),H=!1)},V={p:y,um:qe,m:It,r:ts,mt:ke,mc:Q,pc:ae,pbc:q,n:E,o:t};return{render:M,hydrate:void 0,createApp:g_(M)}}function Ro({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Ln({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function k_(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function gd(t,e,n=!1){const s=t.children,i=e.children;if(K(s)&&K(i))for(let r=0;r<s.length;r++){const o=s[r];let a=i[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[r]=Vt(i[r]),a.el=o.el),!n&&a.patchFlag!==-2&&gd(o,a)),a.type===Xr&&(a.patchFlag===-1&&(a=i[r]=Vt(a)),a.el=o.el),a.type===We&&!a.el&&(a.el=o.el)}}function x_(t){const e=t.slice(),n=[0];let s,i,r,o,a;const l=t.length;for(s=0;s<l;s++){const c=t[s];if(c!==0){if(i=n[n.length-1],t[i]<c){e[s]=i,n.push(s);continue}for(r=0,o=n.length-1;r<o;)a=r+o>>1,t[n[a]]<c?r=a+1:o=a;c<t[n[r]]&&(r>0&&(e[s]=n[r-1]),n[r]=s)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}function _d(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:_d(e)}function gc(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}function md(t){if(t.placeholder)return t.placeholder;const e=t.component;return e?md(e.subTree):null}const yd=t=>t.__isSuspense;function O_(t,e){e&&e.pendingBranch?K(t)?e.effects.push(...t):e.effects.push(t):jg(t)}const De=Symbol.for("v-fgt"),Xr=Symbol.for("v-txt"),We=Symbol.for("v-cmt"),Ao=Symbol.for("v-stc"),ni=[];let rt=null;function be(t=!1){ni.push(rt=t?null:[])}function D_(){ni.pop(),rt=ni[ni.length-1]||null}let _i=1;function gr(t,e=!1){_i+=t,t<0&&rt&&e&&(rt.hasOnce=!0)}function vd(t){return t.dynamicChildren=_i>0?rt||hs:null,D_(),_i>0&&rt&&rt.push(t),t}function we(t,e,n,s,i,r){return vd(B(t,e,n,s,i,r,!0))}function M_(t,e,n,s,i){return vd(Ue(t,e,n,s,i,!0))}function _r(t){return t?t.__v_isVNode===!0:!1}function $n(t,e){return t.type===e.type&&t.key===e.key}const bd=({key:t})=>t??null,tr=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Se(t)||Be(t)||J(t)?{i:ut,r:t,k:e,f:!!n}:t:null);function B(t,e=null,n=null,s=0,i=null,r=t===De?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&bd(e),ref:e&&tr(e),scopeId:$h,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:ut};return a?(Za(l,n),r&128&&t.normalize(l)):n&&(l.shapeFlag|=Se(n)?8:16),_i>0&&!o&&rt&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&rt.push(l),l}const Ue=L_;function L_(t,e=null,n=null,s=0,i=null,r=!1){if((!t||t===a_)&&(t=We),_r(t)){const a=Rn(t,e,!0);return n&&Za(a,n),_i>0&&!r&&rt&&(a.shapeFlag&6?rt[rt.indexOf(t)]=a:rt.push(a)),a.patchFlag=-2,a}if(K_(t)&&(t=t.__vccOpts),e){e=F_(e);let{class:a,style:l}=e;a&&!Se(a)&&(e.class=it(a)),ue(l)&&(qa(l)&&!K(l)&&(l=Re({},l)),e.style=Gr(l))}const o=Se(t)?1:yd(t)?128:jh(t)?64:ue(t)?4:J(t)?2:0;return B(t,e,n,s,i,o,r,!0)}function F_(t){return t?qa(t)||cd(t)?Re({},t):t:null}function Rn(t,e,n=!1,s=!1){const{props:i,ref:r,patchFlag:o,children:a,transition:l}=t,c=e?U_(i||{},e):i,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&bd(c),ref:e&&e.ref?n&&r?K(r)?r.concat(tr(e)):[r,tr(e)]:tr(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==De?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Rn(t.ssContent),ssFallback:t.ssFallback&&Rn(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&s&&Kn(u,l.clone(u)),u}function wd(t=" ",e=0){return Ue(Xr,null,t,e)}function gs(t="",e=!1){return e?(be(),M_(We,null,t)):Ue(We,null,t)}function xt(t){return t==null||typeof t=="boolean"?Ue(We):K(t)?Ue(De,null,t.slice()):_r(t)?Vt(t):Ue(Xr,null,String(t))}function Vt(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Rn(t)}function Za(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(K(e))n=16;else if(typeof e=="object")if(s&65){const i=e.default;i&&(i._c&&(i._d=!1),Za(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!cd(e)?e._ctx=ut:i===3&&ut&&(ut.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else J(e)?(e={default:e,_ctx:ut},n=32):(e=String(e),s&64?(n=16,e=[wd(e)]):n=8);t.children=e,t.shapeFlag|=n}function U_(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const i in s)if(i==="class")e.class!==s.class&&(e.class=it([e.class,s.class]));else if(i==="style")e.style=Gr([e.style,s.style]);else if(Vr(i)){const r=e[i],o=s[i];o&&r!==o&&!(K(r)&&r.includes(o))&&(e[i]=r?[].concat(r,o):o)}else i!==""&&(e[i]=s[i])}return e}function At(t,e,n,s=null){Et(t,e,7,[n,s])}const B_=id();let H_=0;function $_(t,e,n){const s=t.type,i=(e?e.appContext:t.appContext)||B_,r={uid:H_++,vnode:t,type:s,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new pg(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:hd(s,i),emitsOptions:rd(s,i),emit:null,emitted:null,propsDefaults:ge,inheritAttrs:s.inheritAttrs,ctx:ge,data:ge,props:ge,attrs:ge,slots:ge,refs:ge,setupState:ge,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=m_.bind(null,r),t.ce&&t.ce(r),r}let je=null;const el=()=>je||ut;let mr,aa;{const t=jr(),e=(n,s)=>{let i;return(i=t[n])||(i=t[n]=[]),i.push(s),r=>{i.length>1?i.forEach(o=>o(r)):i[0](r)}};mr=e("__VUE_INSTANCE_SETTERS__",n=>je=n),aa=e("__VUE_SSR_SETTERS__",n=>mi=n)}const Di=t=>{const e=je;return mr(t),t.scope.on(),()=>{t.scope.off(),mr(e)}},_c=()=>{je&&je.scope.off(),mr(null)};function Ed(t){return t.vnode.shapeFlag&4}let mi=!1;function V_(t,e=!1,n=!1){e&&aa(e);const{props:s,children:i}=t.vnode,r=Ed(t);C_(t,s,r,e),R_(t,i,n||e);const o=r?W_(t,e):void 0;return e&&aa(!1),o}function W_(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,l_);const{setup:s}=n;if(s){Yt();const i=t.setupContext=s.length>1?G_(t):null,r=Di(t),o=Oi(s,t,0,[t.props,i]),a=hh(o);if(Qt(),r(),(a||t.sp)&&!ei(t)&&Jh(t),a){if(o.then(_c,_c),e)return o.then(l=>{mc(t,l)}).catch(l=>{zr(l,t,0)});t.asyncDep=o}else mc(t,o)}else Cd(t)}function mc(t,e,n){J(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:ue(e)&&(t.setupState=Mh(e)),Cd(t)}function Cd(t,e,n){const s=t.type;t.render||(t.render=s.render||Ot);{const i=Di(t);Yt();try{c_(t)}finally{Qt(),i()}}}const j_={get(t,e){return Fe(t,"get",""),t[e]}};function G_(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,j_),slots:t.slots,emit:t.emit,expose:e}}function Zr(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Mh(Dg(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in ti)return ti[n](t)},has(e,n){return n in e||n in ti}})):t.proxy}function K_(t){return J(t)&&"__vccOpts"in t}const Ze=(t,e)=>Bg(t,e,mi);function tl(t,e,n){try{gr(-1);const s=arguments.length;return s===2?ue(e)&&!K(e)?_r(e)?Ue(t,null,[e]):Ue(t,e):Ue(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&_r(n)&&(n=[n]),Ue(t,e,n))}finally{gr(1)}}const z_="3.5.28";let la;const yc=typeof window<"u"&&window.trustedTypes;if(yc)try{la=yc.createPolicy("vue",{createHTML:t=>t})}catch{}const Id=la?t=>la.createHTML(t):t=>t,q_="http://www.w3.org/2000/svg",Y_="http://www.w3.org/1998/Math/MathML",$t=typeof document<"u"?document:null,vc=$t&&$t.createElement("template"),Q_={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const i=e==="svg"?$t.createElementNS(q_,t):e==="mathml"?$t.createElementNS(Y_,t):n?$t.createElement(t,{is:n}):$t.createElement(t);return t==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:t=>$t.createTextNode(t),createComment:t=>$t.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>$t.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,i,r){const o=n?n.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===r||!(i=i.nextSibling)););else{vc.innerHTML=Id(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const a=vc.content;if(s==="svg"||s==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},on="transition",Ws="animation",Es=Symbol("_vtc"),Td={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Sd=Re({},Kh,Td),J_=t=>(t.displayName="Transition",t.props=Sd,t),X_=J_((t,{slots:e})=>tl(Jg,Rd(t),e)),Fn=(t,e=[])=>{K(t)?t.forEach(n=>n(...e)):t&&t(...e)},bc=t=>t?K(t)?t.some(e=>e.length>1):t.length>1:!1;function Rd(t){const e={};for(const O in t)O in Td||(e[O]=t[O]);if(t.css===!1)return e;const{name:n="v",type:s,duration:i,enterFromClass:r=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=r,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=t,m=Z_(i),y=m&&m[0],k=m&&m[1],{onBeforeEnter:L,onEnter:R,onEnterCancelled:F,onLeave:S,onLeaveCancelled:v,onBeforeAppear:I=L,onAppear:N=R,onAppearCancelled:Q=F}=e,$=(O,ne,ke,tt)=>{O._enterCancelled=tt,cn(O,ne?u:a),cn(O,ne?c:o),ke&&ke()},q=(O,ne)=>{O._isLeaving=!1,cn(O,h),cn(O,p),cn(O,d),ne&&ne()},X=O=>(ne,ke)=>{const tt=O?N:R,Te=()=>$(ne,O,ke);Fn(tt,[ne,Te]),wc(()=>{cn(ne,O?l:r),Nt(ne,O?u:a),bc(tt)||Ec(ne,s,y,Te)})};return Re(e,{onBeforeEnter(O){Fn(L,[O]),Nt(O,r),Nt(O,o)},onBeforeAppear(O){Fn(I,[O]),Nt(O,l),Nt(O,c)},onEnter:X(!1),onAppear:X(!0),onLeave(O,ne){O._isLeaving=!0;const ke=()=>q(O,ne);Nt(O,h),O._enterCancelled?(Nt(O,d),ca(O)):(ca(O),Nt(O,d)),wc(()=>{O._isLeaving&&(cn(O,h),Nt(O,p),bc(S)||Ec(O,s,k,ke))}),Fn(S,[O,ke])},onEnterCancelled(O){$(O,!1,void 0,!0),Fn(F,[O])},onAppearCancelled(O){$(O,!0,void 0,!0),Fn(Q,[O])},onLeaveCancelled(O){q(O),Fn(v,[O])}})}function Z_(t){if(t==null)return null;if(ue(t))return[No(t.enter),No(t.leave)];{const e=No(t);return[e,e]}}function No(t){return og(t)}function Nt(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Es]||(t[Es]=new Set)).add(e)}function cn(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const n=t[Es];n&&(n.delete(e),n.size||(t[Es]=void 0))}function wc(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let em=0;function Ec(t,e,n,s){const i=t._endId=++em,r=()=>{i===t._endId&&s()};if(n!=null)return setTimeout(r,n);const{type:o,timeout:a,propCount:l}=Ad(t,e);if(!o)return s();const c=o+"end";let u=0;const h=()=>{t.removeEventListener(c,d),r()},d=p=>{p.target===t&&++u>=l&&h()};setTimeout(()=>{u<l&&h()},a+1),t.addEventListener(c,d)}function Ad(t,e){const n=window.getComputedStyle(t),s=m=>(n[m]||"").split(", "),i=s(`${on}Delay`),r=s(`${on}Duration`),o=Cc(i,r),a=s(`${Ws}Delay`),l=s(`${Ws}Duration`),c=Cc(a,l);let u=null,h=0,d=0;e===on?o>0&&(u=on,h=o,d=r.length):e===Ws?c>0&&(u=Ws,h=c,d=l.length):(h=Math.max(o,c),u=h>0?o>c?on:Ws:null,d=u?u===on?r.length:l.length:0);const p=u===on&&/\b(?:transform|all)(?:,|$)/.test(s(`${on}Property`).toString());return{type:u,timeout:h,propCount:d,hasTransform:p}}function Cc(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>Ic(n)+Ic(t[s])))}function Ic(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function ca(t){return(t?t.ownerDocument:document).body.offsetHeight}function tm(t,e,n){const s=t[Es];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Tc=Symbol("_vod"),nm=Symbol("_vsh"),sm=Symbol(""),im=/(?:^|;)\s*display\s*:/;function rm(t,e,n){const s=t.style,i=Se(n);let r=!1;if(n&&!i){if(e)if(Se(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&nr(s,a,"")}else for(const o in e)n[o]==null&&nr(s,o,"");for(const o in n)o==="display"&&(r=!0),nr(s,o,n[o])}else if(i){if(e!==n){const o=s[sm];o&&(n+=";"+o),s.cssText=n,r=im.test(n)}}else e&&t.removeAttribute("style");Tc in t&&(t[Tc]=r?s.display:"",t[nm]&&(s.display="none"))}const Sc=/\s*!important$/;function nr(t,e,n){if(K(n))n.forEach(s=>nr(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=om(t,e);Sc.test(n)?t.setProperty(xn(s),n.replace(Sc,""),"important"):t[s]=n}}const Rc=["Webkit","Moz","ms"],Po={};function om(t,e){const n=Po[e];if(n)return n;let s=Sn(e);if(s!=="filter"&&s in t)return Po[e]=s;s=ph(s);for(let i=0;i<Rc.length;i++){const r=Rc[i]+s;if(r in t)return Po[e]=r}return e}const Ac="http://www.w3.org/1999/xlink";function Nc(t,e,n,s,i,r=dg(e)){s&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Ac,e.slice(6,e.length)):t.setAttributeNS(Ac,e,n):n==null||r&&!_h(n)?t.removeAttribute(e):t.setAttribute(e,r?"":Lt(n)?String(n):n)}function Pc(t,e,n,s,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Id(n):n);return}const r=t.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?t.getAttribute("value")||"":t.value,l=n==null?t.type==="checkbox"?"on":"":String(n);(a!==l||!("_value"in t))&&(t.value=l),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const a=typeof t[e];a==="boolean"?n=_h(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(i||e)}function os(t,e,n,s){t.addEventListener(e,n,s)}function am(t,e,n,s){t.removeEventListener(e,n,s)}const kc=Symbol("_vei");function lm(t,e,n,s,i=null){const r=t[kc]||(t[kc]={}),o=r[e];if(s&&o)o.value=s;else{const[a,l]=cm(e);if(s){const c=r[e]=dm(s,i);os(t,a,c,l)}else o&&(am(t,a,o,l),r[e]=void 0)}}const xc=/(?:Once|Passive|Capture)$/;function cm(t){let e;if(xc.test(t)){e={};let s;for(;s=t.match(xc);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):xn(t.slice(2)),e]}let ko=0;const um=Promise.resolve(),hm=()=>ko||(um.then(()=>ko=0),ko=Date.now());function dm(t,e){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;Et(fm(s,n.value),e,5,[s])};return n.value=t,n.attached=hm(),n}function fm(t,e){if(K(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>i=>!i._stopped&&s&&s(i))}else return e}const Oc=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,pm=(t,e,n,s,i,r)=>{const o=i==="svg";e==="class"?tm(t,s,o):e==="style"?rm(t,n,s):Vr(e)?Fa(e)||lm(t,e,n,s,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):gm(t,e,s,o))?(Pc(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Nc(t,e,s,o,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Se(s))?Pc(t,Sn(e),s,r,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),Nc(t,e,s,o))};function gm(t,e,n,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&Oc(e)&&J(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&t.tagName==="IFRAME"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Oc(e)&&Se(n)?!1:e in t}const Nd=new WeakMap,Pd=new WeakMap,yr=Symbol("_moveCb"),Dc=Symbol("_enterCb"),_m=t=>(delete t.props.mode,t),mm=_m({name:"TransitionGroup",props:Re({},Sd,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=el(),s=Gh();let i,r;return Zh(()=>{if(!i.length)return;const o=t.moveClass||`${t.name||"v"}-move`;if(!Em(i[0].el,n.vnode.el,o)){i=[];return}i.forEach(vm),i.forEach(bm);const a=i.filter(wm);ca(n.vnode.el),a.forEach(l=>{const c=l.el,u=c.style;Nt(c,o),u.transform=u.webkitTransform=u.transitionDuration="";const h=c[yr]=d=>{d&&d.target!==c||(!d||d.propertyName.endsWith("transform"))&&(c.removeEventListener("transitionend",h),c[yr]=null,cn(c,o))};c.addEventListener("transitionend",h)}),i=[]}),()=>{const o=re(t),a=Rd(o);let l=o.tag||De;if(i=[],r)for(let c=0;c<r.length;c++){const u=r[c];u.el&&u.el instanceof Element&&(i.push(u),Kn(u,gi(u,a,s,n)),Nd.set(u,kd(u.el)))}r=e.default?Qa(e.default()):[];for(let c=0;c<r.length;c++){const u=r[c];u.key!=null&&Kn(u,gi(u,a,s,n))}return Ue(l,null,r)}}}),ym=mm;function vm(t){const e=t.el;e[yr]&&e[yr](),e[Dc]&&e[Dc]()}function bm(t){Pd.set(t,kd(t.el))}function wm(t){const e=Nd.get(t),n=Pd.get(t),s=e.left-n.left,i=e.top-n.top;if(s||i){const r=t.el,o=r.style,a=r.getBoundingClientRect();let l=1,c=1;return r.offsetWidth&&(l=a.width/r.offsetWidth),r.offsetHeight&&(c=a.height/r.offsetHeight),(!Number.isFinite(l)||l===0)&&(l=1),(!Number.isFinite(c)||c===0)&&(c=1),Math.abs(l-1)<.01&&(l=1),Math.abs(c-1)<.01&&(c=1),o.transform=o.webkitTransform=`translate(${s/l}px,${i/c}px)`,o.transitionDuration="0s",t}}function kd(t){const e=t.getBoundingClientRect();return{left:e.left,top:e.top}}function Em(t,e,n){const s=t.cloneNode(),i=t[Es];i&&i.forEach(a=>{a.split(/\s+/).forEach(l=>l&&s.classList.remove(l))}),n.split(/\s+/).forEach(a=>a&&s.classList.add(a)),s.style.display="none";const r=e.nodeType===1?e:e.parentNode;r.appendChild(s);const{hasTransform:o}=Ad(s);return r.removeChild(s),o}const Mc=t=>{const e=t.props["onUpdate:modelValue"]||!1;return K(e)?n=>Xi(e,n):e};function Cm(t){t.target.composing=!0}function Lc(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const xo=Symbol("_assign");function Fc(t,e,n){return e&&(t=t.trim()),n&&(t=Ha(t)),t}const Im={created(t,{modifiers:{lazy:e,trim:n,number:s}},i){t[xo]=Mc(i);const r=s||i.props&&i.props.type==="number";os(t,e?"change":"input",o=>{o.target.composing||t[xo](Fc(t.value,n,r))}),(n||r)&&os(t,"change",()=>{t.value=Fc(t.value,n,r)}),e||(os(t,"compositionstart",Cm),os(t,"compositionend",Lc),os(t,"change",Lc))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:s,trim:i,number:r}},o){if(t[xo]=Mc(o),t.composing)return;const a=(r||t.type==="number")&&!/^0\d/.test(t.value)?Ha(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(s&&e===n||i&&t.value.trim()===l)||(t.value=l))}},Tm=["ctrl","shift","alt","meta"],Sm={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Tm.some(n=>t[`${n}Key`]&&!e.includes(n))},Rm=(t,e)=>{if(!t)return t;const n=t._withMods||(t._withMods={}),s=e.join(".");return n[s]||(n[s]=((i,...r)=>{for(let o=0;o<e.length;o++){const a=Sm[e[o]];if(a&&a(i,e))return}return t(i,...r)}))},Am={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Nm=(t,e)=>{const n=t._withKeys||(t._withKeys={}),s=e.join(".");return n[s]||(n[s]=(i=>{if(!("key"in i))return;const r=xn(i.key);if(e.some(o=>o===r||Am[o]===r))return t(i)}))},Pm=Re({patchProp:pm},Q_);let Uc;function km(){return Uc||(Uc=N_(Pm))}const xm=((...t)=>{const e=km().createApp(...t),{mount:n}=e;return e.mount=s=>{const i=Dm(s);if(!i)return;const r=e._component;!J(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=n(i,!1,Om(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e});function Om(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Dm(t){return Se(t)?document.querySelector(t):t}const as=typeof document<"u";function xd(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Mm(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&xd(t.default)}const le=Object.assign;function Oo(t,e){const n={};for(const s in e){const i=e[s];n[s]=Ct(i)?i.map(t):t(i)}return n}const si=()=>{},Ct=Array.isArray;function Bc(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}let Ee=(function(t){return t[t.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",t[t.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",t[t.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",t[t.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",t[t.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",t})({});const Od=Symbol("");Ee.MATCHER_NOT_FOUND+"",Ee.NAVIGATION_GUARD_REDIRECT+"",Ee.NAVIGATION_ABORTED+"",Ee.NAVIGATION_CANCELLED+"",Ee.NAVIGATION_DUPLICATED+"";function Cs(t,e){return le(new Error,{type:t,[Od]:!0},e)}function Ht(t,e){return t instanceof Error&&Od in t&&(e==null||!!(t.type&e))}const Lm=["params","query","hash"];function Fm(t){if(typeof t=="string")return t;if(t.path!=null)return t.path;const e={};for(const n of Lm)n in t&&(e[n]=t[n]);return JSON.stringify(e,null,2)}const Um=Symbol(""),Hc=Symbol(""),eo=Symbol(""),nl=Symbol(""),ua=Symbol("");function Bm(){return vt(eo)}function Hm(t){return vt(nl)}const Dd=/#/g,$m=/&/g,Vm=/\//g,Wm=/=/g,jm=/\?/g,Md=/\+/g,Gm=/%5B/g,Km=/%5D/g,Ld=/%5E/g,zm=/%60/g,Fd=/%7B/g,qm=/%7C/g,Ud=/%7D/g,Ym=/%20/g;function sl(t){return t==null?"":encodeURI(""+t).replace(qm,"|").replace(Gm,"[").replace(Km,"]")}function Qm(t){return sl(t).replace(Fd,"{").replace(Ud,"}").replace(Ld,"^")}function ha(t){return sl(t).replace(Md,"%2B").replace(Ym,"+").replace(Dd,"%23").replace($m,"%26").replace(zm,"`").replace(Fd,"{").replace(Ud,"}").replace(Ld,"^")}function Jm(t){return ha(t).replace(Wm,"%3D")}function Xm(t){return sl(t).replace(Dd,"%23").replace(jm,"%3F")}function Zm(t){return Xm(t).replace(Vm,"%2F")}function yi(t){if(t==null)return null;try{return decodeURIComponent(""+t)}catch{}return""+t}const ey=/\/$/,ty=t=>t.replace(ey,"");function Do(t,e,n="/"){let s,i={},r="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return l=a>=0&&l>a?-1:l,l>=0&&(s=e.slice(0,l),r=e.slice(l,a>0?a:e.length),i=t(r.slice(1))),a>=0&&(s=s||e.slice(0,a),o=e.slice(a,e.length)),s=ry(s??e,n),{fullPath:s+r+o,path:s,query:i,hash:yi(o)}}function ny(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function $c(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function sy(t,e,n){const s=e.matched.length-1,i=n.matched.length-1;return s>-1&&s===i&&Is(e.matched[s],n.matched[i])&&Bd(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Is(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Bd(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var n in t)if(!iy(t[n],e[n]))return!1;return!0}function iy(t,e){return Ct(t)?Vc(t,e):Ct(e)?Vc(e,t):(t&&t.valueOf())===(e&&e.valueOf())}function Vc(t,e){return Ct(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function ry(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/"),i=s[s.length-1];(i===".."||i===".")&&s.push("");let r=n.length-1,o,a;for(o=0;o<s.length;o++)if(a=s[o],a!==".")if(a==="..")r>1&&r--;else break;return n.slice(0,r).join("/")+"/"+s.slice(o).join("/")}const an={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let da=(function(t){return t.pop="pop",t.push="push",t})({}),Mo=(function(t){return t.back="back",t.forward="forward",t.unknown="",t})({});function oy(t){if(!t)if(as){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),ty(t)}const ay=/^[^#]+#/;function ly(t,e){return t.replace(ay,"#")+e}function cy(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const to=()=>({left:window.scrollX,top:window.scrollY});function uy(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),i=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!i)return;e=cy(i,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Wc(t,e){return(history.state?history.state.position-e:-1)+t}const fa=new Map;function hy(t,e){fa.set(t,e)}function dy(t){const e=fa.get(t);return fa.delete(t),e}function fy(t){return typeof t=="string"||t&&typeof t=="object"}function Hd(t){return typeof t=="string"||typeof t=="symbol"}function py(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<n.length;++s){const i=n[s].replace(Md," "),r=i.indexOf("="),o=yi(r<0?i:i.slice(0,r)),a=r<0?null:yi(i.slice(r+1));if(o in e){let l=e[o];Ct(l)||(l=e[o]=[l]),l.push(a)}else e[o]=a}return e}function jc(t){let e="";for(let n in t){const s=t[n];if(n=Jm(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(Ct(s)?s.map(i=>i&&ha(i)):[s&&ha(s)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function gy(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=Ct(s)?s.map(i=>i==null?null:""+i):s==null?s:""+s)}return e}function js(){let t=[];function e(s){return t.push(s),()=>{const i=t.indexOf(s);i>-1&&t.splice(i,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function dn(t,e,n,s,i,r=o=>o()){const o=s&&(s.enterCallbacks[i]=s.enterCallbacks[i]||[]);return()=>new Promise((a,l)=>{const c=d=>{d===!1?l(Cs(Ee.NAVIGATION_ABORTED,{from:n,to:e})):d instanceof Error?l(d):fy(d)?l(Cs(Ee.NAVIGATION_GUARD_REDIRECT,{from:e,to:d})):(o&&s.enterCallbacks[i]===o&&typeof d=="function"&&o.push(d),a())},u=r(()=>t.call(s&&s.instances[i],e,n,c));let h=Promise.resolve(u);t.length<3&&(h=h.then(c)),h.catch(d=>l(d))})}function Lo(t,e,n,s,i=r=>r()){const r=[];for(const o of t)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(xd(l)){const c=(l.__vccOpts||l)[e];c&&r.push(dn(c,n,s,o,a,i))}else{let c=l();r.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const h=Mm(u)?u.default:u;o.mods[a]=u,o.components[a]=h;const d=(h.__vccOpts||h)[e];return d&&dn(d,n,s,o,a,i)()}))}}return r}function _y(t,e){const n=[],s=[],i=[],r=Math.max(e.matched.length,t.matched.length);for(let o=0;o<r;o++){const a=e.matched[o];a&&(t.matched.find(c=>Is(c,a))?s.push(a):n.push(a));const l=t.matched[o];l&&(e.matched.find(c=>Is(c,l))||i.push(l))}return[n,s,i]}let my=()=>location.protocol+"//"+location.host;function $d(t,e){const{pathname:n,search:s,hash:i}=e,r=t.indexOf("#");if(r>-1){let o=i.includes(t.slice(r))?t.slice(r).length:1,a=i.slice(o);return a[0]!=="/"&&(a="/"+a),$c(a,"")}return $c(n,t)+s+i}function yy(t,e,n,s){let i=[],r=[],o=null;const a=({state:d})=>{const p=$d(t,location),m=n.value,y=e.value;let k=0;if(d){if(n.value=p,e.value=d,o&&o===m){o=null;return}k=y?d.position-y.position:0}else s(p);i.forEach(L=>{L(n.value,m,{delta:k,type:da.pop,direction:k?k>0?Mo.forward:Mo.back:Mo.unknown})})};function l(){o=n.value}function c(d){i.push(d);const p=()=>{const m=i.indexOf(d);m>-1&&i.splice(m,1)};return r.push(p),p}function u(){if(document.visibilityState==="hidden"){const{history:d}=window;if(!d.state)return;d.replaceState(le({},d.state,{scroll:to()}),"")}}function h(){for(const d of r)d();r=[],window.removeEventListener("popstate",a),window.removeEventListener("pagehide",u),document.removeEventListener("visibilitychange",u)}return window.addEventListener("popstate",a),window.addEventListener("pagehide",u),document.addEventListener("visibilitychange",u),{pauseListeners:l,listen:c,destroy:h}}function Gc(t,e,n,s=!1,i=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:i?to():null}}function vy(t){const{history:e,location:n}=window,s={value:$d(t,n)},i={value:e.state};i.value||r(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function r(l,c,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+l:my()+t+l;try{e[u?"replaceState":"pushState"](c,"",d),i.value=c}catch(p){console.error(p),n[u?"replace":"assign"](d)}}function o(l,c){r(l,le({},e.state,Gc(i.value.back,l,i.value.forward,!0),c,{position:i.value.position}),!0),s.value=l}function a(l,c){const u=le({},i.value,e.state,{forward:l,scroll:to()});r(u.current,u,!0),r(l,le({},Gc(s.value,l,null),{position:u.position+1},c),!1),s.value=l}return{location:s,state:i,push:a,replace:o}}function by(t){t=oy(t);const e=vy(t),n=yy(t,e.state,e.location,e.replace);function s(r,o=!0){o||n.pauseListeners(),history.go(r)}const i=le({location:"",base:t,go:s,createHref:ly.bind(null,t)},e,n);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}let Vn=(function(t){return t[t.Static=0]="Static",t[t.Param=1]="Param",t[t.Group=2]="Group",t})({});var Ae=(function(t){return t[t.Static=0]="Static",t[t.Param=1]="Param",t[t.ParamRegExp=2]="ParamRegExp",t[t.ParamRegExpEnd=3]="ParamRegExpEnd",t[t.EscapeNext=4]="EscapeNext",t})(Ae||{});const wy={type:Vn.Static,value:""},Ey=/[a-zA-Z0-9_]/;function Cy(t){if(!t)return[[]];if(t==="/")return[[wy]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(p){throw new Error(`ERR (${n})/"${c}": ${p}`)}let n=Ae.Static,s=n;const i=[];let r;function o(){r&&i.push(r),r=[]}let a=0,l,c="",u="";function h(){c&&(n===Ae.Static?r.push({type:Vn.Static,value:c}):n===Ae.Param||n===Ae.ParamRegExp||n===Ae.ParamRegExpEnd?(r.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),r.push({type:Vn.Param,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function d(){c+=l}for(;a<t.length;){if(l=t[a++],l==="\\"&&n!==Ae.ParamRegExp){s=n,n=Ae.EscapeNext;continue}switch(n){case Ae.Static:l==="/"?(c&&h(),o()):l===":"?(h(),n=Ae.Param):d();break;case Ae.EscapeNext:d(),n=s;break;case Ae.Param:l==="("?n=Ae.ParamRegExp:Ey.test(l)?d():(h(),n=Ae.Static,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case Ae.ParamRegExp:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:n=Ae.ParamRegExpEnd:u+=l;break;case Ae.ParamRegExpEnd:h(),n=Ae.Static,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===Ae.ParamRegExp&&e(`Unfinished custom RegExp for param "${c}"`),h(),o(),i}const Kc="[^/]+?",Iy={sensitive:!1,strict:!1,start:!0,end:!0};var $e=(function(t){return t[t._multiplier=10]="_multiplier",t[t.Root=90]="Root",t[t.Segment=40]="Segment",t[t.SubSegment=30]="SubSegment",t[t.Static=40]="Static",t[t.Dynamic=20]="Dynamic",t[t.BonusCustomRegExp=10]="BonusCustomRegExp",t[t.BonusWildcard=-50]="BonusWildcard",t[t.BonusRepeatable=-20]="BonusRepeatable",t[t.BonusOptional=-8]="BonusOptional",t[t.BonusStrict=.7000000000000001]="BonusStrict",t[t.BonusCaseSensitive=.25]="BonusCaseSensitive",t})($e||{});const Ty=/[.+*?^${}()[\]/\\]/g;function Sy(t,e){const n=le({},Iy,e),s=[];let i=n.start?"^":"";const r=[];for(const c of t){const u=c.length?[]:[$e.Root];n.strict&&!c.length&&(i+="/");for(let h=0;h<c.length;h++){const d=c[h];let p=$e.Segment+(n.sensitive?$e.BonusCaseSensitive:0);if(d.type===Vn.Static)h||(i+="/"),i+=d.value.replace(Ty,"\\$&"),p+=$e.Static;else if(d.type===Vn.Param){const{value:m,repeatable:y,optional:k,regexp:L}=d;r.push({name:m,repeatable:y,optional:k});const R=L||Kc;if(R!==Kc){p+=$e.BonusCustomRegExp;try{new RegExp(`(${R})`)}catch(S){throw new Error(`Invalid custom RegExp for param "${m}" (${R}): `+S.message)}}let F=y?`((?:${R})(?:/(?:${R}))*)`:`(${R})`;h||(F=k&&c.length<2?`(?:/${F})`:"/"+F),k&&(F+="?"),i+=F,p+=$e.Dynamic,k&&(p+=$e.BonusOptional),y&&(p+=$e.BonusRepeatable),R===".*"&&(p+=$e.BonusWildcard)}u.push(p)}s.push(u)}if(n.strict&&n.end){const c=s.length-1;s[c][s[c].length-1]+=$e.BonusStrict}n.strict||(i+="/?"),n.end?i+="$":n.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const o=new RegExp(i,n.sensitive?"":"i");function a(c){const u=c.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const p=u[d]||"",m=r[d-1];h[m.name]=p&&m.repeatable?p.split("/"):p}return h}function l(c){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const p of d)if(p.type===Vn.Static)u+=p.value;else if(p.type===Vn.Param){const{value:m,repeatable:y,optional:k}=p,L=m in c?c[m]:"";if(Ct(L)&&!y)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const R=Ct(L)?L.join("/"):L;if(!R)if(k)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${m}"`);u+=R}}return u||"/"}return{re:o,score:s,keys:r,parse:a,stringify:l}}function Ry(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===$e.Static+$e.Segment?-1:1:t.length>e.length?e.length===1&&e[0]===$e.Static+$e.Segment?1:-1:0}function Vd(t,e){let n=0;const s=t.score,i=e.score;for(;n<s.length&&n<i.length;){const r=Ry(s[n],i[n]);if(r)return r;n++}if(Math.abs(i.length-s.length)===1){if(zc(s))return 1;if(zc(i))return-1}return i.length-s.length}function zc(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const Ay={strict:!1,end:!0,sensitive:!1};function Ny(t,e,n){const s=Sy(Cy(t.path),n),i=le(s,{record:t,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function Py(t,e){const n=[],s=new Map;e=Bc(Ay,e);function i(h){return s.get(h)}function r(h,d,p){const m=!p,y=Yc(h);y.aliasOf=p&&p.record;const k=Bc(e,h),L=[y];if("alias"in h){const S=typeof h.alias=="string"?[h.alias]:h.alias;for(const v of S)L.push(Yc(le({},y,{components:p?p.record.components:y.components,path:v,aliasOf:p?p.record:y})))}let R,F;for(const S of L){const{path:v}=S;if(d&&v[0]!=="/"){const I=d.record.path,N=I[I.length-1]==="/"?"":"/";S.path=d.record.path+(v&&N+v)}if(R=Ny(S,d,k),p?p.alias.push(R):(F=F||R,F!==R&&F.alias.push(R),m&&h.name&&!Qc(R)&&o(h.name)),Wd(R)&&l(R),y.children){const I=y.children;for(let N=0;N<I.length;N++)r(I[N],R,p&&p.children[N])}p=p||R}return F?()=>{o(F)}:si}function o(h){if(Hd(h)){const d=s.get(h);d&&(s.delete(h),n.splice(n.indexOf(d),1),d.children.forEach(o),d.alias.forEach(o))}else{const d=n.indexOf(h);d>-1&&(n.splice(d,1),h.record.name&&s.delete(h.record.name),h.children.forEach(o),h.alias.forEach(o))}}function a(){return n}function l(h){const d=Oy(h,n);n.splice(d,0,h),h.record.name&&!Qc(h)&&s.set(h.record.name,h)}function c(h,d){let p,m={},y,k;if("name"in h&&h.name){if(p=s.get(h.name),!p)throw Cs(Ee.MATCHER_NOT_FOUND,{location:h});k=p.record.name,m=le(qc(d.params,p.keys.filter(F=>!F.optional).concat(p.parent?p.parent.keys.filter(F=>F.optional):[]).map(F=>F.name)),h.params&&qc(h.params,p.keys.map(F=>F.name))),y=p.stringify(m)}else if(h.path!=null)y=h.path,p=n.find(F=>F.re.test(y)),p&&(m=p.parse(y),k=p.record.name);else{if(p=d.name?s.get(d.name):n.find(F=>F.re.test(d.path)),!p)throw Cs(Ee.MATCHER_NOT_FOUND,{location:h,currentLocation:d});k=p.record.name,m=le({},d.params,h.params),y=p.stringify(m)}const L=[];let R=p;for(;R;)L.unshift(R.record),R=R.parent;return{name:k,path:y,params:m,matched:L,meta:xy(L)}}t.forEach(h=>r(h));function u(){n.length=0,s.clear()}return{addRoute:r,resolve:c,removeRoute:o,clearRoutes:u,getRoutes:a,getRecordMatcher:i}}function qc(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function Yc(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:ky(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function ky(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="object"?n[s]:n;return e}function Qc(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function xy(t){return t.reduce((e,n)=>le(e,n.meta),{})}function Oy(t,e){let n=0,s=e.length;for(;n!==s;){const r=n+s>>1;Vd(t,e[r])<0?s=r:n=r+1}const i=Dy(t);return i&&(s=e.lastIndexOf(i,s-1)),s}function Dy(t){let e=t;for(;e=e.parent;)if(Wd(e)&&Vd(t,e)===0)return e}function Wd({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function Jc(t){const e=vt(eo),n=vt(nl),s=Ze(()=>{const l=vn(t.to);return e.resolve(l)}),i=Ze(()=>{const{matched:l}=s.value,{length:c}=l,u=l[c-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(Is.bind(null,u));if(d>-1)return d;const p=Xc(l[c-2]);return c>1&&Xc(u)===p&&h[h.length-1].path!==p?h.findIndex(Is.bind(null,l[c-2])):d}),r=Ze(()=>i.value>-1&&By(n.params,s.value.params)),o=Ze(()=>i.value>-1&&i.value===n.matched.length-1&&Bd(n.params,s.value.params));function a(l={}){if(Uy(l)){const c=e[vn(t.replace)?"replace":"push"](vn(t.to)).catch(si);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:s,href:Ze(()=>s.value.href),isActive:r,isExactActive:o,navigate:a}}function My(t){return t.length===1?t[0]:t}const Ly=Qh({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Jc,setup(t,{slots:e}){const n=xi(Jc(t)),{options:s}=vt(eo),i=Ze(()=>({[Zc(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[Zc(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const r=e.default&&My(e.default(n));return t.custom?r:tl("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:i.value},r)}}}),Fy=Ly;function Uy(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function By(t,e){for(const n in e){const s=e[n],i=t[n];if(typeof s=="string"){if(s!==i)return!1}else if(!Ct(i)||i.length!==s.length||s.some((r,o)=>r.valueOf()!==i[o].valueOf()))return!1}return!0}function Xc(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Zc=(t,e,n)=>t??e??n,Hy=Qh({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const s=vt(ua),i=Ze(()=>t.route||s.value),r=vt(Hc,0),o=Ze(()=>{let c=vn(r);const{matched:u}=i.value;let h;for(;(h=u[c])&&!h.components;)c++;return c}),a=Ze(()=>i.value.matched[o.value]);Zi(Hc,Ze(()=>o.value+1)),Zi(Um,a),Zi(ua,i);const l=ct();return er(()=>[l.value,a.value,t.name],([c,u,h],[d,p,m])=>{u&&(u.instances[h]=c,p&&p!==u&&c&&c===d&&(u.leaveGuards.size||(u.leaveGuards=p.leaveGuards),u.updateGuards.size||(u.updateGuards=p.updateGuards))),c&&u&&(!p||!Is(u,p)||!d)&&(u.enterCallbacks[h]||[]).forEach(y=>y(c))},{flush:"post"}),()=>{const c=i.value,u=t.name,h=a.value,d=h&&h.components[u];if(!d)return eu(n.default,{Component:d,route:c});const p=h.props[u],m=p?p===!0?c.params:typeof p=="function"?p(c):p:null,k=tl(d,le({},m,e,{onVnodeUnmounted:L=>{L.component.isUnmounted&&(h.instances[u]=null)},ref:l}));return eu(n.default,{Component:k,route:c})||k}}});function eu(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const $y=Hy;function Vy(t){const e=Py(t.routes,t),n=t.parseQuery||py,s=t.stringifyQuery||jc,i=t.history,r=js(),o=js(),a=js(),l=Mg(an);let c=an;as&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Oo.bind(null,E=>""+E),h=Oo.bind(null,Zm),d=Oo.bind(null,yi);function p(E,H){let M,V;return Hd(E)?(M=e.getRecordMatcher(E),V=H):V=E,e.addRoute(V,M)}function m(E){const H=e.getRecordMatcher(E);H&&e.removeRoute(H)}function y(){return e.getRoutes().map(E=>E.record)}function k(E){return!!e.getRecordMatcher(E)}function L(E,H){if(H=le({},H||l.value),typeof E=="string"){const _=Do(n,E,H.path),b=e.resolve({path:_.path},H),C=i.createHref(_.fullPath);return le(_,b,{params:d(b.params),hash:yi(_.hash),redirectedFrom:void 0,href:C})}let M;if(E.path!=null)M=le({},E,{path:Do(n,E.path,H.path).path});else{const _=le({},E.params);for(const b in _)_[b]==null&&delete _[b];M=le({},E,{params:h(_)}),H.params=h(H.params)}const V=e.resolve(M,H),se=E.hash||"";V.params=u(d(V.params));const f=ny(s,le({},E,{hash:Qm(se),path:V.path})),g=i.createHref(f);return le({fullPath:f,hash:se,query:s===jc?gy(E.query):E.query||{}},V,{redirectedFrom:void 0,href:g})}function R(E){return typeof E=="string"?Do(n,E,l.value.path):le({},E)}function F(E,H){if(c!==E)return Cs(Ee.NAVIGATION_CANCELLED,{from:H,to:E})}function S(E){return N(E)}function v(E){return S(le(R(E),{replace:!0}))}function I(E,H){const M=E.matched[E.matched.length-1];if(M&&M.redirect){const{redirect:V}=M;let se=typeof V=="function"?V(E,H):V;return typeof se=="string"&&(se=se.includes("?")||se.includes("#")?se=R(se):{path:se},se.params={}),le({query:E.query,hash:E.hash,params:se.path!=null?{}:E.params},se)}}function N(E,H){const M=c=L(E),V=l.value,se=E.state,f=E.force,g=E.replace===!0,_=I(M,V);if(_)return N(le(R(_),{state:typeof _=="object"?le({},se,_.state):se,force:f,replace:g}),H||M);const b=M;b.redirectedFrom=H;let C;return!f&&sy(s,V,M)&&(C=Cs(Ee.NAVIGATION_DUPLICATED,{to:b,from:V}),It(V,V,!0,!1)),(C?Promise.resolve(C):q(b,V)).catch(w=>Ht(w)?Ht(w,Ee.NAVIGATION_GUARD_REDIRECT)?w:rn(w):ae(w,b,V)).then(w=>{if(w){if(Ht(w,Ee.NAVIGATION_GUARD_REDIRECT))return N(le({replace:g},R(w.to),{state:typeof w.to=="object"?le({},se,w.to.state):se,force:f}),H||b)}else w=O(b,V,!0,g,se);return X(b,V,w),w})}function Q(E,H){const M=F(E,H);return M?Promise.reject(M):Promise.resolve()}function $(E){const H=ns.values().next().value;return H&&typeof H.runWithContext=="function"?H.runWithContext(E):E()}function q(E,H){let M;const[V,se,f]=_y(E,H);M=Lo(V.reverse(),"beforeRouteLeave",E,H);for(const _ of V)_.leaveGuards.forEach(b=>{M.push(dn(b,E,H))});const g=Q.bind(null,E,H);return M.push(g),at(M).then(()=>{M=[];for(const _ of r.list())M.push(dn(_,E,H));return M.push(g),at(M)}).then(()=>{M=Lo(se,"beforeRouteUpdate",E,H);for(const _ of se)_.updateGuards.forEach(b=>{M.push(dn(b,E,H))});return M.push(g),at(M)}).then(()=>{M=[];for(const _ of f)if(_.beforeEnter)if(Ct(_.beforeEnter))for(const b of _.beforeEnter)M.push(dn(b,E,H));else M.push(dn(_.beforeEnter,E,H));return M.push(g),at(M)}).then(()=>(E.matched.forEach(_=>_.enterCallbacks={}),M=Lo(f,"beforeRouteEnter",E,H,$),M.push(g),at(M))).then(()=>{M=[];for(const _ of o.list())M.push(dn(_,E,H));return M.push(g),at(M)}).catch(_=>Ht(_,Ee.NAVIGATION_CANCELLED)?_:Promise.reject(_))}function X(E,H,M){a.list().forEach(V=>$(()=>V(E,H,M)))}function O(E,H,M,V,se){const f=F(E,H);if(f)return f;const g=H===an,_=as?history.state:{};M&&(V||g?i.replace(E.fullPath,le({scroll:g&&_&&_.scroll},se)):i.push(E.fullPath,se)),l.value=E,It(E,H,M,g),rn()}let ne;function ke(){ne||(ne=i.listen((E,H,M)=>{if(!Dn.listening)return;const V=L(E),se=I(V,Dn.currentRoute.value);if(se){N(le(se,{replace:!0,force:!0}),V).catch(si);return}c=V;const f=l.value;as&&hy(Wc(f.fullPath,M.delta),to()),q(V,f).catch(g=>Ht(g,Ee.NAVIGATION_ABORTED|Ee.NAVIGATION_CANCELLED)?g:Ht(g,Ee.NAVIGATION_GUARD_REDIRECT)?(N(le(R(g.to),{force:!0}),V).then(_=>{Ht(_,Ee.NAVIGATION_ABORTED|Ee.NAVIGATION_DUPLICATED)&&!M.delta&&M.type===da.pop&&i.go(-1,!1)}).catch(si),Promise.reject()):(M.delta&&i.go(-M.delta,!1),ae(g,V,f))).then(g=>{g=g||O(V,f,!1),g&&(M.delta&&!Ht(g,Ee.NAVIGATION_CANCELLED)?i.go(-M.delta,!1):M.type===da.pop&&Ht(g,Ee.NAVIGATION_ABORTED|Ee.NAVIGATION_DUPLICATED)&&i.go(-1,!1)),X(V,f,g)}).catch(si)}))}let tt=js(),Te=js(),de;function ae(E,H,M){rn(E);const V=Te.list();return V.length?V.forEach(se=>se(E,H,M)):console.error(E),Promise.reject(E)}function Ut(){return de&&l.value!==an?Promise.resolve():new Promise((E,H)=>{tt.add([E,H])})}function rn(E){return de||(de=!E,ke(),tt.list().forEach(([H,M])=>E?M(E):H()),tt.reset()),E}function It(E,H,M,V){const{scrollBehavior:se}=t;if(!as||!se)return Promise.resolve();const f=!M&&dy(Wc(E.fullPath,0))||(V||!M)&&history.state&&history.state.scroll||null;return Fh().then(()=>se(E,H,f)).then(g=>g&&uy(g)).catch(g=>ae(g,E,H))}const qe=E=>i.go(E);let ts;const ns=new Set,Dn={currentRoute:l,listening:!0,addRoute:p,removeRoute:m,clearRoutes:e.clearRoutes,hasRoute:k,getRoutes:y,resolve:L,options:t,push:S,replace:v,go:qe,back:()=>qe(-1),forward:()=>qe(1),beforeEach:r.add,beforeResolve:o.add,afterEach:a.add,onError:Te.add,isReady:Ut,install(E){E.component("RouterLink",Fy),E.component("RouterView",$y),E.config.globalProperties.$router=Dn,Object.defineProperty(E.config.globalProperties,"$route",{enumerable:!0,get:()=>vn(l)}),as&&!ts&&l.value===an&&(ts=!0,S(i.location).catch(V=>{}));const H={};for(const V in an)Object.defineProperty(H,V,{get:()=>l.value[V],enumerable:!0});E.provide(eo,Dn),E.provide(nl,Oh(H)),E.provide(ua,l);const M=E.unmount;ns.add(E),E.unmount=function(){ns.delete(E),ns.size<1&&(c=an,ne&&ne(),ne=null,l.value=an,ts=!1,de=!1),M()}}};function at(E){return E.reduce((H,M)=>H.then(()=>$(M)),Promise.resolve())}return Dn}const Wy={class:"min-h-screen bg-slate-900 flex items-center justify-center p-4"},jy={__name:"Home",setup(t){const e=Bm(),n=()=>{const s=Math.random().toString(36).substring(2,5)+"-"+Math.random().toString(36).substring(2,5);e.push(`/game/${s}`)};return(s,i)=>(be(),we("div",Wy,[B("div",{class:"max-w-md w-full bg-slate-800 p-8 rounded-2xl shadow-2xl text-center border border-slate-700"},[i[0]||(i[0]=B("h1",{class:"text-4xl font-black text-amber-500 mb-2 uppercase tracking-tighter"},"Petteia",-1)),i[1]||(i[1]=B("p",{class:"text-slate-400 mb-8 text-sm"},"    ",-1)),B("button",{onClick:n,class:"w-full bg-amber-600 hover:bg-amber-500 text-white font-bold py-4 rounded-xl transition-all transform active:scale-95 shadow-lg shadow-amber-900/20"},"    "),i[2]||(i[2]=B("div",{class:"mt-6 pt-6 border-t border-slate-700"},[B("p",{class:"text-xs text-slate-500 italic"},"      ,   . ")],-1))])]))}},Gy=()=>{};var tu={};const jd={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};const A=function(t,e){if(!t)throw xs(e)},xs=function(t){return new Error("Firebase Database ("+jd.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};const Gd=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Ky=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const r=t[n++],o=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return e.join("")},il={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=r>>2,h=(r&3)<<4|a>>4;let d=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(d=64)),s.push(n[u],n[h],n[d],n[p])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Gd(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Ky(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||a==null||c==null||h==null)throw new zy;const d=r<<2|a>>4;if(s.push(d),c!==64){const p=a<<4&240|c>>2;if(s.push(p),h!==64){const m=c<<6&192|h;s.push(m)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class zy extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Kd=function(t){const e=Gd(t);return il.encodeByteArray(e,!0)},vr=function(t){return Kd(t).replace(/\./g,"")},br=function(t){try{return il.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function qy(t){return zd(void 0,t)}function zd(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!Yy(n)||(t[n]=zd(t[n],e[n]));return t}function Yy(t){return t!=="__proto__"}function Qy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Jy=()=>Qy().__FIREBASE_DEFAULTS__,Xy=()=>{if(typeof process>"u"||typeof tu>"u")return;const t=tu.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Zy=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&br(t[1]);return e&&JSON.parse(e)},rl=()=>{try{return Gy()||Jy()||Xy()||Zy()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},qd=t=>rl()?.emulatorHosts?.[t],ev=t=>{const e=qd(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Yd=()=>rl()?.config,Qd=t=>rl()?.[`_${t}`];class Mi{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}function Os(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Jd(t){return(await fetch(t,{credentials:"include"})).ok}function tv(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...t};return[vr(JSON.stringify(n)),vr(JSON.stringify(o)),""].join(".")}const ii={};function nv(){const t={prod:[],emulator:[]};for(const e of Object.keys(ii))ii[e]?t.emulator.push(e):t.prod.push(e);return t}function sv(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let nu=!1;function Xd(t,e){if(typeof window>"u"||typeof document>"u"||!Os(window.location.host)||ii[t]===e||ii[t]||nu)return;ii[t]=e;function n(d){return`__firebase__banner__${d}`}const s="__firebase__banner",r=nv().prod.length>0;function o(){const d=document.getElementById(s);d&&d.remove()}function a(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,p){d.setAttribute("width","24"),d.setAttribute("id",p),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{nu=!0,o()},d}function u(d,p){d.setAttribute("id",p),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=sv(s),p=n("text"),m=document.getElementById(p)||document.createElement("span"),y=n("learnmore"),k=document.getElementById(y)||document.createElement("a"),L=n("preprendIcon"),R=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const F=d.element;a(F),u(k,y);const S=c();l(R,L),F.append(R,m,k,S),document.body.appendChild(F)}r?(m.innerText="Preview backend disconnected.",R.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(R.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function ze(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ol(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ze())}function iv(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rv(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Zd(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ov(){const t=ze();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function av(){return jd.NODE_ADMIN===!0}function lv(){try{return typeof indexedDB=="object"}catch{return!1}}function cv(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(n){e(n)}})}const uv="FirebaseError";class On extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=uv,Object.setPrototypeOf(this,On.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Li.prototype.create)}}class Li{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?hv(r,s):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new On(i,a,s)}}function hv(t,e){return t.replace(dv,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const dv=/\{\$([^}]+)}/g;function vi(t){return JSON.parse(t)}function Pe(t){return JSON.stringify(t)}const ef=function(t){let e={},n={},s={},i="";try{const r=t.split(".");e=vi(br(r[0])||""),n=vi(br(r[1])||""),i=r[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:i}},fv=function(t){const e=ef(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},pv=function(t){const e=ef(t).claims;return typeof e=="object"&&e.admin===!0};function Ft(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ts(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function pa(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function wr(t,e,n){const s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s}function zn(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],o=e[i];if(su(r)&&su(o)){if(!zn(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function su(t){return t!==null&&typeof t=="object"}function Ds(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}class gv{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)s[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)s[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=s[h-3]^s[h-8]^s[h-14]^s[h-16];s[h]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],r=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let h=0;h<80;h++){h<40?h<20?(c=a^r&(o^a),u=1518500249):(c=r^o^a,u=1859775393):h<60?(c=r&o|a&(r|o),u=2400959708):(c=r^o^a,u=3395469782);const d=(i<<5|i>>>27)+c+l+u+s[h]&4294967295;l=a,a=o,o=(r<<30|r>>>2)&4294967295,r=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let i=0;const r=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(r[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}else for(;i<n;)if(r[o]=e[i],++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let r=24;r>=0;r-=8)e[s]=this.chain_[i]>>r&255,++s;return e}}function _v(t,e){const n=new mv(t,e);return n.subscribe.bind(n)}class mv{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let i;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");yv(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:s},i.next===void 0&&(i.next=Fo),i.error===void 0&&(i.error=Fo),i.complete===void 0&&(i.complete=Fo);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function yv(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Fo(){}function no(t,e){return`${t} failed: ${e} argument `}const vv=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);if(i>=55296&&i<=56319){const r=i-55296;s++,A(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;i=65536+(r<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},so=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};function ot(t){return t&&t._delegate?t._delegate:t}class qn{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Bn="[DEFAULT]";class bv{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Mi;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ev(e))try{this.getOrInitializeService({instanceIdentifier:Bn})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=Bn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Bn){return this.instances.has(e)}getOptions(e=Bn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);s===a&&o.resolve(i)}return i}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(s)??new Set;i.add(e),this.onInitCallbacks.set(s,i);const r=this.instances.get(s);return r&&e(r,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:wv(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Bn){return this.component?this.component.multipleInstances?e:Bn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wv(t){return t===Bn?void 0:t}function Ev(t){return t.instantiationMode==="EAGER"}class Cv{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new bv(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(fe||(fe={}));const Iv={debug:fe.DEBUG,verbose:fe.VERBOSE,info:fe.INFO,warn:fe.WARN,error:fe.ERROR,silent:fe.SILENT},Tv=fe.INFO,Sv={[fe.DEBUG]:"log",[fe.VERBOSE]:"log",[fe.INFO]:"info",[fe.WARN]:"warn",[fe.ERROR]:"error"},Rv=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=Sv[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class al{constructor(e){this.name=e,this._logLevel=Tv,this._logHandler=Rv,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Iv[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,fe.DEBUG,...e),this._logHandler(this,fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,fe.VERBOSE,...e),this._logHandler(this,fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,fe.INFO,...e),this._logHandler(this,fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,fe.WARN,...e),this._logHandler(this,fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,fe.ERROR,...e),this._logHandler(this,fe.ERROR,...e)}}const Av=(t,e)=>e.some(n=>t instanceof n);let iu,ru;function Nv(){return iu||(iu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Pv(){return ru||(ru=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const tf=new WeakMap,ga=new WeakMap,nf=new WeakMap,Uo=new WeakMap,ll=new WeakMap;function kv(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",o)},r=()=>{n(bn(t.result)),i()},o=()=>{s(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&tf.set(n,t)}).catch(()=>{}),ll.set(e,t),e}function xv(t){if(ga.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",o),t.removeEventListener("abort",o)},r=()=>{n(),i()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",o),t.addEventListener("abort",o)});ga.set(t,e)}let _a={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ga.get(t);if(e==="objectStoreNames")return t.objectStoreNames||nf.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return bn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Ov(t){_a=t(_a)}function Dv(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Bo(this),e,...n);return nf.set(s,e.sort?e.sort():[e]),bn(s)}:Pv().includes(t)?function(...e){return t.apply(Bo(this),e),bn(tf.get(this))}:function(...e){return bn(t.apply(Bo(this),e))}}function Mv(t){return typeof t=="function"?Dv(t):(t instanceof IDBTransaction&&xv(t),Av(t,Nv())?new Proxy(t,_a):t)}function bn(t){if(t instanceof IDBRequest)return kv(t);if(Uo.has(t))return Uo.get(t);const e=Mv(t);return e!==t&&(Uo.set(t,e),ll.set(e,t)),e}const Bo=t=>ll.get(t);function Lv(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(t,e),a=bn(o);return s&&o.addEventListener("upgradeneeded",l=>{s(bn(o.result),l.oldVersion,l.newVersion,bn(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const Fv=["get","getKey","getAll","getAllKeys","count"],Uv=["put","add","delete","clear"],Ho=new Map;function ou(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ho.get(e))return Ho.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=Uv.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||Fv.includes(n)))return;const r=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return Ho.set(e,r),r}Ov(t=>({...t,get:(e,n,s)=>ou(e,n)||t.get(e,n,s),has:(e,n)=>!!ou(e,n)||t.has(e,n)}));class Bv{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Hv(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function Hv(t){return t.getComponent()?.type==="VERSION"}const ma="@firebase/app",au="0.14.8";const Xt=new al("@firebase/app"),$v="@firebase/app-compat",Vv="@firebase/analytics-compat",Wv="@firebase/analytics",jv="@firebase/app-check-compat",Gv="@firebase/app-check",Kv="@firebase/auth",zv="@firebase/auth-compat",qv="@firebase/database",Yv="@firebase/data-connect",Qv="@firebase/database-compat",Jv="@firebase/functions",Xv="@firebase/functions-compat",Zv="@firebase/installations",eb="@firebase/installations-compat",tb="@firebase/messaging",nb="@firebase/messaging-compat",sb="@firebase/performance",ib="@firebase/performance-compat",rb="@firebase/remote-config",ob="@firebase/remote-config-compat",ab="@firebase/storage",lb="@firebase/storage-compat",cb="@firebase/firestore",ub="@firebase/ai",hb="@firebase/firestore-compat",db="firebase",fb="12.9.0";const ya="[DEFAULT]",pb={[ma]:"fire-core",[$v]:"fire-core-compat",[Wv]:"fire-analytics",[Vv]:"fire-analytics-compat",[Gv]:"fire-app-check",[jv]:"fire-app-check-compat",[Kv]:"fire-auth",[zv]:"fire-auth-compat",[qv]:"fire-rtdb",[Yv]:"fire-data-connect",[Qv]:"fire-rtdb-compat",[Jv]:"fire-fn",[Xv]:"fire-fn-compat",[Zv]:"fire-iid",[eb]:"fire-iid-compat",[tb]:"fire-fcm",[nb]:"fire-fcm-compat",[sb]:"fire-perf",[ib]:"fire-perf-compat",[rb]:"fire-rc",[ob]:"fire-rc-compat",[ab]:"fire-gcs",[lb]:"fire-gcs-compat",[cb]:"fire-fst",[hb]:"fire-fst-compat",[ub]:"fire-vertex","fire-js":"fire-js",[db]:"fire-js-all"};const Er=new Map,gb=new Map,va=new Map;function lu(t,e){try{t.container.addComponent(e)}catch(n){Xt.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ss(t){const e=t.name;if(va.has(e))return Xt.debug(`There were multiple attempts to register component ${e}.`),!1;va.set(e,t);for(const n of Er.values())lu(n,t);for(const n of gb.values())lu(n,t);return!0}function cl(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function pt(t){return t==null?!1:t.settings!==void 0}const _b={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wn=new Li("app","Firebase",_b);class mb{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new qn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wn.create("app-deleted",{appName:this._name})}}const Ms=fb;function sf(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:ya,automaticDataCollectionEnabled:!0,...e},i=s.name;if(typeof i!="string"||!i)throw wn.create("bad-app-name",{appName:String(i)});if(n||(n=Yd()),!n)throw wn.create("no-options");const r=Er.get(i);if(r){if(zn(n,r.options)&&zn(s,r.config))return r;throw wn.create("duplicate-app",{appName:i})}const o=new Cv(i);for(const l of va.values())o.addComponent(l);const a=new mb(n,s,o);return Er.set(i,a),a}function rf(t=ya){const e=Er.get(t);if(!e&&t===ya&&Yd())return sf();if(!e)throw wn.create("no-app",{appName:t});return e}function En(t,e,n){let s=pb[t]??t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),r=e.match(/\s|\//);if(i||r){const o=[`Unable to register library "${s}" with version "${e}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&r&&o.push("and"),r&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xt.warn(o.join(" "));return}Ss(new qn(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const yb="firebase-heartbeat-database",vb=1,bi="firebase-heartbeat-store";let $o=null;function of(){return $o||($o=Lv(yb,vb,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(bi)}catch(n){console.warn(n)}}}}).catch(t=>{throw wn.create("idb-open",{originalErrorMessage:t.message})})),$o}async function bb(t){try{const n=(await of()).transaction(bi),s=await n.objectStore(bi).get(af(t));return await n.done,s}catch(e){if(e instanceof On)Xt.warn(e.message);else{const n=wn.create("idb-get",{originalErrorMessage:e?.message});Xt.warn(n.message)}}}async function cu(t,e){try{const s=(await of()).transaction(bi,"readwrite");await s.objectStore(bi).put(e,af(t)),await s.done}catch(n){if(n instanceof On)Xt.warn(n.message);else{const s=wn.create("idb-set",{originalErrorMessage:n?.message});Xt.warn(s.message)}}}function af(t){return`${t.name}!${t.options.appId}`}const wb=1024,Eb=30;class Cb{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Tb(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=uu();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(i=>i.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats.length>Eb){const i=Sb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=uu(),{heartbeatsToSend:n,unsentEntries:s}=Ib(this._heartbeatsCache.heartbeats),i=vr(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Xt.warn(e),""}}}function uu(){return new Date().toISOString().substring(0,10)}function Ib(t,e=wb){const n=[];let s=t.slice();for(const i of t){const r=n.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),hu(n)>e){r.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),hu(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class Tb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return lv()?cv().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await bb(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return cu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return cu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function hu(t){return vr(JSON.stringify({version:2,heartbeats:t})).length}function Sb(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}function Rb(t){Ss(new qn("platform-logger",e=>new Bv(e),"PRIVATE")),Ss(new qn("heartbeat",e=>new Cb(e),"PRIVATE")),En(ma,au,t),En(ma,au,"esm2020"),En("fire-js","")}Rb("");var Ab="firebase",Nb="12.9.0";En(Ab,Nb,"app");var du={};const fu="@firebase/database",pu="1.1.0";let lf="";function Pb(t){lf=t}class kb{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Pe(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:vi(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class xb{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Ft(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const cf=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new kb(e)}}catch{}return new xb},Wn=cf("localStorage"),Ob=cf("sessionStorage");const _s=new al("@firebase/database"),Db=(function(){let t=1;return function(){return t++}})(),uf=function(t){const e=vv(t),n=new gv;n.update(e);const s=n.digest();return il.encodeByteArray(s)},Fi=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=Fi.apply(null,s):typeof s=="object"?e+=Pe(s):e+=s,e+=" "}return e};let ri=null,gu=!0;const Mb=function(t,e){A(!0,"Can't turn on custom loggers persistently."),_s.logLevel=fe.VERBOSE,ri=_s.log.bind(_s)},Me=function(...t){if(gu===!0&&(gu=!1,ri===null&&Ob.get("logging_enabled")===!0&&Mb()),ri){const e=Fi.apply(null,t);ri(e)}},Ui=function(t){return function(...e){Me(t,...e)}},ba=function(...t){const e="FIREBASE INTERNAL ERROR: "+Fi(...t);_s.error(e)},Zt=function(...t){const e=`FIREBASE FATAL ERROR: ${Fi(...t)}`;throw _s.error(e),new Error(e)},Ke=function(...t){const e="FIREBASE WARNING: "+Fi(...t);_s.warn(e)},Lb=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ke("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ul=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},Fb=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Rs="[MIN_NAME]",Yn="[MAX_NAME]",Zn=function(t,e){if(t===e)return 0;if(t===Rs||e===Yn)return-1;if(e===Rs||t===Yn)return 1;{const n=_u(t),s=_u(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},Ub=function(t,e){return t===e?0:t<e?-1:1},Gs=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Pe(e))},hl=function(t){if(typeof t!="object"||t===null)return Pe(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=Pe(e[s]),n+=":",n+=hl(t[e[s]]);return n+="}",n},hf=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let i=0;i<n;i+=e)i+e>n?s.push(t.substring(i,n)):s.push(t.substring(i,i+e));return s};function Le(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const df=function(t){A(!ul(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let i,r,o,a,l;t===0?(r=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),r=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(r=0,o=Math.round(t/Math.pow(2,1-s-n))));const c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(i?1:0),c.reverse();const u=c.join("");let h="";for(l=0;l<64;l+=8){let d=parseInt(u.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},Bb=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Hb=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function $b(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const Vb=new RegExp("^-?(0*)\\d{1,10}$"),Wb=-2147483648,jb=2147483647,_u=function(t){if(Vb.test(t)){const e=Number(t);if(e>=Wb&&e<=jb)return e}return null},Ls=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Ke("Exception was thrown by user callback.",n),e},Math.floor(0))}},Gb=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},oi=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};class Kb{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,pt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){Ke(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}class zb{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Me("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ke(e)}}class sr{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}sr.OWNER="owner";const dl="5",ff="v",pf="s",gf="r",_f="f",mf=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,yf="ls",vf="p",wa="ac",bf="websocket",wf="long_polling";class Ef{constructor(e,n,s,i,r=!1,o="",a=!1,l=!1,c=null){this.secure=n,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Wn.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Wn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function qb(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Cf(t,e,n){A(typeof e=="string","typeof type must == string"),A(typeof n=="object","typeof params must == object");let s;if(e===bf)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===wf)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);qb(t)&&(n.ns=t.namespace);const i=[];return Le(n,(r,o)=>{i.push(r+"="+o)}),s+i.join("&")}class Yb{constructor(){this.counters_={}}incrementCounter(e,n=1){Ft(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return qy(this.counters_)}}const Vo={},Wo={};function fl(t){const e=t.toString();return Vo[e]||(Vo[e]=new Yb),Vo[e]}function Qb(t,e){const n=t.toString();return Wo[n]||(Wo[n]=e()),Wo[n]}class Jb{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&Ls(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const mu="start",Xb="close",Zb="pLPCommand",ew="pRTLPCB",If="id",Tf="pw",Sf="ser",tw="cb",nw="seg",sw="ts",iw="d",rw="dframe",Rf=1870,Af=30,ow=Rf-Af,aw=25e3,lw=3e4;class cs{constructor(e,n,s,i,r,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ui(e),this.stats_=fl(n),this.urlFn=l=>(this.appCheckToken&&(l[wa]=this.appCheckToken),Cf(n,wf,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Jb(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(lw)),Fb(()=>{if(this.isClosed_)return;this.scriptTagHolder=new pl((...r)=>{const[o,a,l,c,u]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===mu)this.id=a,this.password=l;else if(o===Xb)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[mu]="t",s[Sf]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[tw]=this.scriptTagHolder.uniqueCallbackIdentifier),s[ff]=dl,this.transportSessionId&&(s[pf]=this.transportSessionId),this.lastSessionId&&(s[yf]=this.lastSessionId),this.applicationId&&(s[vf]=this.applicationId),this.appCheckToken&&(s[wa]=this.appCheckToken),typeof location<"u"&&location.hostname&&mf.test(location.hostname)&&(s[gf]=_f);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){cs.forceAllow_=!0}static forceDisallow(){cs.forceDisallow_=!0}static isAvailable(){return cs.forceAllow_?!0:!cs.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Bb()&&!Hb()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Pe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=Kd(n),i=hf(s,ow);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[rw]="t",s[If]=e,s[Tf]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Pe(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class pl{constructor(e,n,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Db(),window[Zb+this.uniqueCallbackIdentifier]=e,window[ew+this.uniqueCallbackIdentifier]=n,this.myIFrame=pl.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Me("frame writing exception"),a.stack&&Me(a.stack),Me(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Me("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[If]=this.myID,e[Tf]=this.myPW,e[Sf]=this.currentSerial;let n=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Af+s.length<=Rf;){const o=this.pendingSegs.shift();s=s+"&"+nw+i+"="+o.seg+"&"+sw+i+"="+o.ts+"&"+iw+i+"="+o.d,i++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(s,Math.floor(aw)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{Me("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}const cw=16384,uw=45e3;let Cr=null;typeof MozWebSocket<"u"?Cr=MozWebSocket:typeof WebSocket<"u"&&(Cr=WebSocket);class gt{constructor(e,n,s,i,r,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ui(this.connId),this.stats_=fl(n),this.connURL=gt.connectionURL_(n,o,a,i,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,i,r){const o={};return o[ff]=dl,typeof location<"u"&&location.hostname&&mf.test(location.hostname)&&(o[gf]=_f),n&&(o[pf]=n),s&&(o[yf]=s),i&&(o[wa]=i),r&&(o[vf]=r),Cf(e,bf,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Wn.set("previous_websocket_failure",!0);try{let s;av(),this.mySock=new Cr(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){gt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&Cr!==null&&!gt.forceDisallow_}static previouslyFailed(){return Wn.isInMemoryStorage||Wn.get("previous_websocket_failure")===!0}markConnectionHealthy(){Wn.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=vi(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(A(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=Pe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=hf(n,cw);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(uw))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}gt.responsesRequiredToBeHealthy=2;gt.healthyTimeout=3e4;class wi{static get ALL_TRANSPORTS(){return[cs,gt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=gt&&gt.isAvailable();let s=n&&!gt.previouslyFailed();if(e.webSocketOnly&&(n||Ke("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[gt];else{const i=this.transports_=[];for(const r of wi.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r);wi.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}wi.globalTransportInitialized_=!1;const hw=6e4,dw=5e3,fw=10*1024,pw=100*1024,jo="t",yu="d",gw="s",vu="r",_w="e",bu="o",wu="a",Eu="n",Cu="p",mw="h";class yw{constructor(e,n,s,i,r,o,a,l,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ui("c:"+this.id+":"),this.transportManager_=new wi(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=oi(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>pw?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>fw?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(jo in e){const n=e[jo];n===wu?this.upgradeIfSecondaryHealthy_():n===vu?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===bu&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Gs("t",e),s=Gs("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Cu,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:wu,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Eu,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Gs("t",e),s=Gs("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Gs(jo,e);if(yu in e){const s=e[yu];if(n===mw){const i={...s};this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===Eu){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===gw?this.onConnectionShutdown_(s):n===vu?this.onReset_(s):n===_w?ba("Server Error: "+s):n===bu?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ba("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),dl!==s&&Ke("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),oi(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(hw))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):oi(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(dw))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Cu,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Wn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Nf{put(e,n,s,i){}merge(e,n,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}class Pf{constructor(e){this.allowedEvents_=e,this.listeners_={},A(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const i=this.getInitialEvent(e);i&&n.apply(s,i)}off(e,n,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===n&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){A(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}class Ir extends Pf{static getInstance(){return new Ir}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ol()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return A(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const Iu=32,Tu=768;class pe{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function oe(){return new pe("")}function Z(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function An(t){return t.pieces_.length-t.pieceNum_}function ve(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new pe(t.pieces_,e)}function gl(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function vw(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ei(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function kf(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new pe(e,0)}function Ce(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof pe)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&n.push(s[i])}return new pe(n,0)}function te(t){return t.pieceNum_>=t.pieces_.length}function Ge(t,e){const n=Z(t),s=Z(e);if(n===null)return e;if(n===s)return Ge(ve(t),ve(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function bw(t,e){const n=Ei(t,0),s=Ei(e,0);for(let i=0;i<n.length&&i<s.length;i++){const r=Zn(n[i],s[i]);if(r!==0)return r}return n.length===s.length?0:n.length<s.length?-1:1}function _l(t,e){if(An(t)!==An(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function ht(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(An(t)>An(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class ww{constructor(e,n){this.errorPrefix_=n,this.parts_=Ei(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=so(this.parts_[s]);xf(this)}}function Ew(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=so(e),xf(t)}function Cw(t){const e=t.parts_.pop();t.byteLength_-=so(e),t.parts_.length>0&&(t.byteLength_-=1)}function xf(t){if(t.byteLength_>Tu)throw new Error(t.errorPrefix_+"has a key path longer than "+Tu+" bytes ("+t.byteLength_+").");if(t.parts_.length>Iu)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Iu+") or object contains a cycle "+Hn(t))}function Hn(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}class ml extends Pf{static getInstance(){return new ml}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return A(e==="visible","Unknown event type: "+e),[this.visible_]}}const Ks=1e3,Iw=300*1e3,Su=30*1e3,Tw=1.3,Sw=3e4,Rw="server_kill",Ru=3;class qt extends Nf{constructor(e,n,s,i,r,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=qt.nextPersistentConnectionId_++,this.log_=Ui("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ks,this.maxReconnectDelay_=Iw,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ml.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Ir.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const i=++this.requestNumber_,r={r:i,a:e,b:n};this.log_(Pe(r)),A(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const n=new Mi,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,s,i){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),A(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),A(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:s};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},o="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,a=>{const l=a.d,c=a.s;qt.warnOnListenWarnings_(l,n),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Ft(e,"w")){const s=Ts(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();Ke(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||pv(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Su)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=fv(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,i=>{const r=i.s,o=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),A(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,n)}sendUnlisten_(e,n,s,i){this.log_("Unlisten on "+e+" for "+n);const r={p:e},o="n";i&&(r.q=s,r.t=i),this.sendRequest(o,r)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,i){const r={p:n,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,s,i){this.putInternal("p",e,n,s,i)}merge(e,n,s,i){this.putInternal("m",e,n,s,i)}putInternal(e,n,s,i,r){this.initConnection_();const o={p:n,d:s};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Pe(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):ba("Unrecognized action received from server: "+Pe(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){A(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ks,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ks,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Sw&&(this.reconnectDelay_=Ks),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Tw)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+qt.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,s())},c=function(h){A(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Me("getToken() completed but was canceled"):(Me("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new yw(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,p=>{Ke(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(Rw)},r))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Ke(h),l())}}}interrupt(e){Me("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Me("Resuming connection for reason: "+e),delete this.interruptReasons_[e],pa(this.interruptReasons_)&&(this.reconnectDelay_=Ks,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(r=>hl(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const s=new pe(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(n),r.delete(n),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,n){Me("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Ru&&(this.reconnectDelay_=Su,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Me("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Ru&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+lf.replace(/\./g,"-")]=1,ol()?e["framework.cordova"]=1:Zd()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Ir.getInstance().currentlyOnline();return pa(this.interruptReasons_)&&e}}qt.nextPersistentConnectionId_=0;qt.nextConnectionId_=0;class ee{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ee(e,n)}}class io{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new ee(Rs,e),i=new ee(Rs,n);return this.compare(s,i)!==0}minPost(){return ee.MIN}}let Yi;class Of extends io{static get __EMPTY_NODE(){return Yi}static set __EMPTY_NODE(e){Yi=e}compare(e,n){return Zn(e.name,n.name)}isDefinedOn(e){throw xs("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ee.MIN}maxPost(){return new ee(Yn,Yi)}makePost(e,n){return A(typeof e=="string","KeyIndex indexValue must always be a string."),new ee(e,Yi)}toString(){return".key"}}const ms=new Of;class Qi{constructor(e,n,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Oe{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s??Oe.RED,this.left=i??et.EMPTY_NODE,this.right=r??et.EMPTY_NODE}copy(e,n,s,i,r){return new Oe(e??this.key,n??this.value,s??this.color,i??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return et.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,i;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return et.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Oe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Oe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Oe.RED=!0;Oe.BLACK=!1;class Aw{copy(e,n,s,i,r){return this}insert(e,n,s){return new Oe(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class et{constructor(e,n=et.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new et(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Oe.BLACK,null,null))}remove(e){return new et(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Oe.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,i=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Qi(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Qi(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Qi(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Qi(this.root_,null,this.comparator_,!0,e)}}et.EMPTY_NODE=new Aw;function Nw(t,e){return Zn(t.name,e.name)}function yl(t,e){return Zn(t,e)}let Ea;function Pw(t){Ea=t}const Df=function(t){return typeof t=="number"?"number:"+df(t):"string:"+t},Mf=function(t){if(t.isLeafNode()){const e=t.val();A(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Ft(e,".sv"),"Priority must be a string or number.")}else A(t===Ea||t.isEmpty(),"priority of unexpected type.");A(t===Ea||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Au;class xe{static set __childrenNodeConstructor(e){Au=e}static get __childrenNodeConstructor(){return Au}constructor(e,n=xe.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,A(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Mf(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new xe(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:xe.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return te(e)?this:Z(e)===".priority"?this.priorityNode_:xe.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:xe.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=Z(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(A(s!==".priority"||An(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,xe.__childrenNodeConstructor.EMPTY_NODE.updateChild(ve(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Df(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=df(this.value_):e+=this.value_,this.lazyHash_=uf(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===xe.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof xe.__childrenNodeConstructor?-1:(A(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,i=xe.VALUE_TYPE_ORDER.indexOf(n),r=xe.VALUE_TYPE_ORDER.indexOf(s);return A(i>=0,"Unknown leaf type: "+n),A(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}xe.VALUE_TYPE_ORDER=["object","boolean","number","string"];let Lf,Ff;function kw(t){Lf=t}function xw(t){Ff=t}class Ow extends io{compare(e,n){const s=e.node.getPriority(),i=n.node.getPriority(),r=s.compareTo(i);return r===0?Zn(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ee.MIN}maxPost(){return new ee(Yn,new xe("[PRIORITY-POST]",Ff))}makePost(e,n){const s=Lf(e);return new ee(n,new xe("[PRIORITY-POST]",s))}toString(){return".priority"}}const Ie=new Ow;const Dw=Math.log(2);class Mw{constructor(e){const n=r=>parseInt(Math.log(r)/Dw,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Tr=function(t,e,n,s){t.sort(e);const i=function(l,c){const u=c-l;let h,d;if(u===0)return null;if(u===1)return h=t[l],d=n?n(h):h,new Oe(d,h.node,Oe.BLACK,null,null);{const p=parseInt(u/2,10)+l,m=i(l,p),y=i(p+1,c);return h=t[p],d=n?n(h):h,new Oe(d,h.node,Oe.BLACK,m,y)}},r=function(l){let c=null,u=null,h=t.length;const d=function(m,y){const k=h-m,L=h;h-=m;const R=i(k+1,L),F=t[k],S=n?n(F):F;p(new Oe(S,F.node,y,null,R))},p=function(m){c?(c.left=m,c=m):(u=m,c=m)};for(let m=0;m<l.count;++m){const y=l.nextBitIsOne(),k=Math.pow(2,l.count-(m+1));y?d(k,Oe.BLACK):(d(k,Oe.BLACK),d(k,Oe.RED))}return u},o=new Mw(t.length),a=r(o);return new et(s||e,a)};let Go;const is={};class Gt{static get Default(){return A(is&&Ie,"ChildrenNode.ts has not been loaded"),Go=Go||new Gt({".priority":is},{".priority":Ie}),Go}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=Ts(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof et?n:null}hasIndex(e){return Ft(this.indexSet_,e.toString())}addIndex(e,n){A(e!==ms,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=n.getIterator(ee.Wrap);let o=r.getNext();for(;o;)i=i||e.isDefinedOn(o.node),s.push(o),o=r.getNext();let a;i?a=Tr(s,e.getCompare()):a=is;const l=e.toString(),c={...this.indexSet_};c[l]=e;const u={...this.indexes_};return u[l]=a,new Gt(u,c)}addToIndexes(e,n){const s=wr(this.indexes_,(i,r)=>{const o=Ts(this.indexSet_,r);if(A(o,"Missing index implementation for "+r),i===is)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(ee.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Tr(a,o.getCompare())}else return is;else{const a=n.get(e.name);let l=i;return a&&(l=l.remove(new ee(e.name,a))),l.insert(e,e.node)}});return new Gt(s,this.indexSet_)}removeFromIndexes(e,n){const s=wr(this.indexes_,i=>{if(i===is)return i;{const r=n.get(e.name);return r?i.remove(new ee(e.name,r)):i}});return new Gt(s,this.indexSet_)}}let zs;class G{static get EMPTY_NODE(){return zs||(zs=new G(new et(yl),null,Gt.Default))}constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Mf(this.priorityNode_),this.children_.isEmpty()&&A(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||zs}updatePriority(e){return this.children_.isEmpty()?this:new G(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?zs:n}}getChild(e){const n=Z(e);return n===null?this:this.getImmediateChild(n).getChild(ve(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(A(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new ee(e,n);let i,r;n.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(s,this.children_));const o=i.isEmpty()?zs:this.priorityNode_;return new G(i,o,r)}}updateChild(e,n){const s=Z(e);if(s===null)return n;{A(Z(e)!==".priority"||An(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(ve(e),n);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,i=0,r=!0;if(this.forEachChild(Ie,(o,a)=>{n[o]=a.val(e),s++,r&&G.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):r=!1}),!e&&r&&i<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Df(this.getPriority().val())+":"),this.forEachChild(Ie,(n,s)=>{const i=s.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":uf(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new ee(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ee(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ee(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,ee.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,ee.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Bi?-1:0}withIndex(e){if(e===ms||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new G(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===ms||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(Ie),i=n.getIterator(Ie);let r=s.getNext(),o=i.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=s.getNext(),o=i.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===ms?null:this.indexMap_.get(e.toString())}}G.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Lw extends G{constructor(){super(new et(yl),G.EMPTY_NODE,Gt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return G.EMPTY_NODE}isEmpty(){return!1}}const Bi=new Lw;Object.defineProperties(ee,{MIN:{value:new ee(Rs,G.EMPTY_NODE)},MAX:{value:new ee(Yn,Bi)}});Of.__EMPTY_NODE=G.EMPTY_NODE;xe.__childrenNodeConstructor=G;Pw(Bi);xw(Bi);const Fw=!0;function Ne(t,e=null){if(t===null)return G.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),A(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new xe(n,Ne(e))}if(!(t instanceof Array)&&Fw){const n=[];let s=!1;if(Le(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=Ne(a);l.isEmpty()||(s=s||!l.getPriority().isEmpty(),n.push(new ee(o,l)))}}),n.length===0)return G.EMPTY_NODE;const r=Tr(n,Nw,o=>o.name,yl);if(s){const o=Tr(n,Ie.getCompare());return new G(r,Ne(e),new Gt({".priority":o},{".priority":Ie}))}else return new G(r,Ne(e),Gt.Default)}else{let n=G.EMPTY_NODE;return Le(t,(s,i)=>{if(Ft(t,s)&&s.substring(0,1)!=="."){const r=Ne(i);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(s,r))}}),n.updatePriority(Ne(e))}}kw(Ne);class Uw extends io{constructor(e){super(),this.indexPath_=e,A(!te(e)&&Z(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),i=this.extractChild(n.node),r=s.compareTo(i);return r===0?Zn(e.name,n.name):r}makePost(e,n){const s=Ne(e),i=G.EMPTY_NODE.updateChild(this.indexPath_,s);return new ee(n,i)}maxPost(){const e=G.EMPTY_NODE.updateChild(this.indexPath_,Bi);return new ee(Yn,e)}toString(){return Ei(this.indexPath_,0).join("/")}}class Bw extends io{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Zn(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ee.MIN}maxPost(){return ee.MAX}makePost(e,n){const s=Ne(e);return new ee(n,s)}toString(){return".value"}}const Hw=new Bw;function Uf(t){return{type:"value",snapshotNode:t}}function As(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ci(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ii(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function $w(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}class vl{constructor(e){this.index_=e}updateChild(e,n,s,i,r,o){A(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(s.getChild(i))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(Ci(n,a)):A(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(As(n,s)):o.trackChildChange(Ii(n,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(Ie,(i,r)=>{n.hasChild(i)||s.trackChildChange(Ci(i,r))}),n.isLeafNode()||n.forEachChild(Ie,(i,r)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(r)||s.trackChildChange(Ii(i,r,o))}else s.trackChildChange(As(i,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?G.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Ti{constructor(e){this.indexedFilter_=new vl(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Ti.getStartPost_(e),this.endPost_=Ti.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,i,r,o){return this.matches(new ee(n,s))||(s=G.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,i,r,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=G.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(G.EMPTY_NODE);const r=this;return n.forEachChild(Ie,(o,a)=>{r.matches(new ee(o,a))||(i=i.updateImmediateChild(o,G.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}class Vw{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new Ti(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,i,r,o){return this.rangedFilter_.matches(new ee(n,s))||(s=G.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,i,r,o):this.fullLimitUpdateChild_(e,n,s,r,o)}updateFullNode(e,n,s){let i;if(n.isLeafNode()||n.isEmpty())i=G.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=G.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;r.hasNext()&&o<this.limit_;){const a=r.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(G.EMPTY_NODE);let r;this.reverse_?r=i.getReverseIterator(this.index_):r=i.getIterator(this.index_);let o=0;for(;r.hasNext();){const a=r.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,G.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,i,r){let o;if(this.reverse_){const h=this.index_.getCompare();o=(d,p)=>h(p,d)}else o=this.index_.getCompare();const a=e;A(a.numChildren()===this.limit_,"");const l=new ee(n,s),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(n)){const h=a.getImmediateChild(n);let d=i.getChildAfterChild(this.index_,c,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);const p=d==null?1:o(d,l);if(u&&!s.isEmpty()&&p>=0)return r?.trackChildChange(Ii(n,s,h)),a.updateImmediateChild(n,s);{r?.trackChildChange(Ci(n,h));const y=a.updateImmediateChild(n,G.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(r?.trackChildChange(As(d.name,d.node)),y.updateImmediateChild(d.name,d.node)):y}}else return s.isEmpty()?e:u&&o(c,l)>=0?(r!=null&&(r.trackChildChange(Ci(c.name,c.node)),r.trackChildChange(As(n,s))),a.updateImmediateChild(n,s).updateImmediateChild(c.name,G.EMPTY_NODE)):e}}class bl{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ie}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return A(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return A(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Rs}hasEnd(){return this.endSet_}getIndexEndValue(){return A(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return A(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Yn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return A(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ie}copy(){const e=new bl;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Ww(t){return t.loadsAllData()?new vl(t.getIndex()):t.hasLimit()?new Vw(t):new Ti(t)}function Nu(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Ie?n="$priority":t.index_===Hw?n="$value":t.index_===ms?n="$key":(A(t.index_ instanceof Uw,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Pe(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=Pe(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+Pe(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=Pe(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+Pe(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Pu(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ie&&(e.i=t.index_.toString()),e}class Sr extends Nf{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(A(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=Ui("p:rest:"),this.listens_={}}listen(e,n,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=Sr.getListenId_(e,s),a={};this.listens_[o]=a;const l=Nu(e._queryParams);this.restRequest_(r+".json",l,(c,u)=>{let h=u;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(r,h,!1,s),Ts(this.listens_,o)===a){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",i(d,null)}})}unlisten(e,n){const s=Sr.getListenId_(e,n);delete this.listens_[s]}get(e){const n=Nu(e._queryParams),s=e._path.toString(),i=new Mi;return this.restRequest_(s+".json",n,(r,o)=>{let a=o;r===404&&(a=null,r=null),r===null?(this.onDataUpdate_(s,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(n.auth=i.accessToken),r&&r.token&&(n.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ds(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=vi(a.responseText)}catch{Ke("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,l)}else a.status!==401&&a.status!==404&&Ke("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}class jw{constructor(){this.rootNode_=G.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}function Rr(){return{value:null,children:new Map}}function Bf(t,e,n){if(te(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=Z(e);t.children.has(s)||t.children.set(s,Rr());const i=t.children.get(s);e=ve(e),Bf(i,e,n)}}function Ca(t,e,n){t.value!==null?n(e,t.value):Gw(t,(s,i)=>{const r=new pe(e.toString()+"/"+s);Ca(i,r,n)})}function Gw(t,e){t.children.forEach((n,s)=>{e(s,n)})}class Kw{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&Le(this.last_,(s,i)=>{n[s]=n[s]-i}),this.last_=e,n}}const ku=10*1e3,zw=30*1e3,qw=300*1e3;class Yw{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Kw(e);const s=ku+(zw-ku)*Math.random();oi(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;Le(e,(i,r)=>{r>0&&Ft(this.statsToReport_,i)&&(n[i]=r,s=!0)}),s&&this.server_.reportStats(n),oi(this.reportStats_.bind(this),Math.floor(Math.random()*2*qw))}}var _t;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(_t||(_t={}));function wl(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function El(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Cl(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}class Ar{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=_t.ACK_USER_WRITE,this.source=wl()}operationForChild(e){if(te(this.path)){if(this.affectedTree.value!=null)return A(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new pe(e));return new Ar(oe(),n,this.revert)}}else return A(Z(this.path)===e,"operationForChild called for unrelated child."),new Ar(ve(this.path),this.affectedTree,this.revert)}}class Si{constructor(e,n){this.source=e,this.path=n,this.type=_t.LISTEN_COMPLETE}operationForChild(e){return te(this.path)?new Si(this.source,oe()):new Si(this.source,ve(this.path))}}class Qn{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=_t.OVERWRITE}operationForChild(e){return te(this.path)?new Qn(this.source,oe(),this.snap.getImmediateChild(e)):new Qn(this.source,ve(this.path),this.snap)}}class Ns{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=_t.MERGE}operationForChild(e){if(te(this.path)){const n=this.children.subtree(new pe(e));return n.isEmpty()?null:n.value?new Qn(this.source,oe(),n.value):new Ns(this.source,oe(),n)}else return A(Z(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ns(this.source,ve(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Nn{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(te(e))return this.isFullyInitialized()&&!this.filtered_;const n=Z(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Qw{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Jw(t,e,n,s){const i=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push($w(o.childName,o.snapshotNode))}),qs(t,i,"child_removed",e,s,n),qs(t,i,"child_added",e,s,n),qs(t,i,"child_moved",r,s,n),qs(t,i,"child_changed",e,s,n),qs(t,i,"value",e,s,n),i}function qs(t,e,n,s,i,r){const o=s.filter(a=>a.type===n);o.sort((a,l)=>Zw(t,a,l)),o.forEach(a=>{const l=Xw(t,a,r);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function Xw(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function Zw(t,e,n){if(e.childName==null||n.childName==null)throw xs("Should only compare child_ events.");const s=new ee(e.childName,e.snapshotNode),i=new ee(n.childName,n.snapshotNode);return t.index_.compare(s,i)}function ro(t,e){return{eventCache:t,serverCache:e}}function ai(t,e,n,s){return ro(new Nn(e,n,s),t.serverCache)}function Hf(t,e,n,s){return ro(t.eventCache,new Nn(e,n,s))}function Nr(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Jn(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let Ko;const eE=()=>(Ko||(Ko=new et(Ub)),Ko);class ye{static fromObject(e){let n=new ye(null);return Le(e,(s,i)=>{n=n.set(new pe(s),i)}),n}constructor(e,n=eE()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:oe(),value:this.value};if(te(e))return null;{const s=Z(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(ve(e),n);return r!=null?{path:Ce(new pe(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(te(e))return this;{const n=Z(e),s=this.children.get(n);return s!==null?s.subtree(ve(e)):new ye(null)}}set(e,n){if(te(e))return new ye(n,this.children);{const s=Z(e),r=(this.children.get(s)||new ye(null)).set(ve(e),n),o=this.children.insert(s,r);return new ye(this.value,o)}}remove(e){if(te(e))return this.children.isEmpty()?new ye(null):new ye(null,this.children);{const n=Z(e),s=this.children.get(n);if(s){const i=s.remove(ve(e));let r;return i.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,i),this.value===null&&r.isEmpty()?new ye(null):new ye(this.value,r)}else return this}}get(e){if(te(e))return this.value;{const n=Z(e),s=this.children.get(n);return s?s.get(ve(e)):null}}setTree(e,n){if(te(e))return n;{const s=Z(e),r=(this.children.get(s)||new ye(null)).setTree(ve(e),n);let o;return r.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,r),new ye(this.value,o)}}fold(e){return this.fold_(oe(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(Ce(e,i),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,oe(),n)}findOnPath_(e,n,s){const i=this.value?s(n,this.value):!1;if(i)return i;if(te(e))return null;{const r=Z(e),o=this.children.get(r);return o?o.findOnPath_(ve(e),Ce(n,r),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,oe(),n)}foreachOnPath_(e,n,s){if(te(e))return this;{this.value&&s(n,this.value);const i=Z(e),r=this.children.get(i);return r?r.foreachOnPath_(ve(e),Ce(n,i),s):new ye(null)}}foreach(e){this.foreach_(oe(),e)}foreach_(e,n){this.children.inorderTraversal((s,i)=>{i.foreach_(Ce(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}class bt{constructor(e){this.writeTree_=e}static empty(){return new bt(new ye(null))}}function li(t,e,n){if(te(e))return new bt(new ye(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const o=Ge(i,e);return r=r.updateChild(o,n),new bt(t.writeTree_.set(i,r))}else{const i=new ye(n),r=t.writeTree_.setTree(e,i);return new bt(r)}}}function Ia(t,e,n){let s=t;return Le(n,(i,r)=>{s=li(s,Ce(e,i),r)}),s}function xu(t,e){if(te(e))return bt.empty();{const n=t.writeTree_.setTree(e,new ye(null));return new bt(n)}}function Ta(t,e){return es(t,e)!=null}function es(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Ge(n.path,e)):null}function Ou(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ie,(s,i)=>{e.push(new ee(s,i))}):t.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new ee(s,i.value))}),e}function Cn(t,e){if(te(e))return t;{const n=es(t,e);return n!=null?new bt(new ye(n)):new bt(t.writeTree_.subtree(e))}}function Sa(t){return t.writeTree_.isEmpty()}function Ps(t,e){return $f(oe(),t.writeTree_,e)}function $f(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(A(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):n=$f(Ce(t,i),r,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Ce(t,".priority"),s)),n}}function oo(t,e){return Gf(e,t)}function tE(t,e,n,s,i){A(s>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:i}),i&&(t.visibleWrites=li(t.visibleWrites,e,n)),t.lastWriteId=s}function nE(t,e,n,s){A(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=Ia(t.visibleWrites,e,n),t.lastWriteId=s}function sE(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function iE(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);A(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let i=s.visible,r=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&rE(a,s.path)?i=!1:ht(s.path,a.path)&&(r=!0)),o--}if(i){if(r)return oE(t),!0;if(s.snap)t.visibleWrites=xu(t.visibleWrites,s.path);else{const a=s.children;Le(a,l=>{t.visibleWrites=xu(t.visibleWrites,Ce(s.path,l))})}return!0}else return!1}function rE(t,e){if(t.snap)return ht(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&ht(Ce(t.path,n),e))return!0;return!1}function oE(t){t.visibleWrites=Vf(t.allWrites,aE,oe()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function aE(t){return t.visible}function Vf(t,e,n){let s=bt.empty();for(let i=0;i<t.length;++i){const r=t[i];if(e(r)){const o=r.path;let a;if(r.snap)ht(n,o)?(a=Ge(n,o),s=li(s,a,r.snap)):ht(o,n)&&(a=Ge(o,n),s=li(s,oe(),r.snap.getChild(a)));else if(r.children){if(ht(n,o))a=Ge(n,o),s=Ia(s,a,r.children);else if(ht(o,n))if(a=Ge(o,n),te(a))s=Ia(s,oe(),r.children);else{const l=Ts(r.children,Z(a));if(l){const c=l.getChild(ve(a));s=li(s,oe(),c)}}}else throw xs("WriteRecord should have .snap or .children")}}return s}function Wf(t,e,n,s,i){if(!s&&!i){const r=es(t.visibleWrites,e);if(r!=null)return r;{const o=Cn(t.visibleWrites,e);if(Sa(o))return n;if(n==null&&!Ta(o,oe()))return null;{const a=n||G.EMPTY_NODE;return Ps(o,a)}}}else{const r=Cn(t.visibleWrites,e);if(!i&&Sa(r))return n;if(!i&&n==null&&!Ta(r,oe()))return null;{const o=function(c){return(c.visible||i)&&(!s||!~s.indexOf(c.writeId))&&(ht(c.path,e)||ht(e,c.path))},a=Vf(t.allWrites,o,e),l=n||G.EMPTY_NODE;return Ps(a,l)}}}function lE(t,e,n){let s=G.EMPTY_NODE;const i=es(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ie,(r,o)=>{s=s.updateImmediateChild(r,o)}),s;if(n){const r=Cn(t.visibleWrites,e);return n.forEachChild(Ie,(o,a)=>{const l=Ps(Cn(r,new pe(o)),a);s=s.updateImmediateChild(o,l)}),Ou(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const r=Cn(t.visibleWrites,e);return Ou(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function cE(t,e,n,s,i){A(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=Ce(e,n);if(Ta(t.visibleWrites,r))return null;{const o=Cn(t.visibleWrites,r);return Sa(o)?i.getChild(n):Ps(o,i.getChild(n))}}function uE(t,e,n,s){const i=Ce(e,n),r=es(t.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(n)){const o=Cn(t.visibleWrites,i);return Ps(o,s.getNode().getImmediateChild(n))}else return null}function hE(t,e){return es(t.visibleWrites,e)}function dE(t,e,n,s,i,r,o){let a;const l=Cn(t.visibleWrites,e),c=es(l,oe());if(c!=null)a=c;else if(n!=null)a=Ps(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),d=r?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let p=d.getNext();for(;p&&u.length<i;)h(p,s)!==0&&u.push(p),p=d.getNext();return u}else return[]}function fE(){return{visibleWrites:bt.empty(),allWrites:[],lastWriteId:-1}}function Pr(t,e,n,s){return Wf(t.writeTree,t.treePath,e,n,s)}function Il(t,e){return lE(t.writeTree,t.treePath,e)}function Du(t,e,n,s){return cE(t.writeTree,t.treePath,e,n,s)}function kr(t,e){return hE(t.writeTree,Ce(t.treePath,e))}function pE(t,e,n,s,i,r){return dE(t.writeTree,t.treePath,e,n,s,i,r)}function Tl(t,e,n){return uE(t.writeTree,t.treePath,e,n)}function jf(t,e){return Gf(Ce(t.treePath,e),t.writeTree)}function Gf(t,e){return{treePath:t,writeTree:e}}class gE{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;A(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),A(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(s,Ii(s,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(s,Ci(s,i.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(s,As(s,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(s,Ii(s,e.snapshotNode,i.oldSnap));else throw xs("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}class _E{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Kf=new _E;class Sl{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Nn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Tl(this.writes_,e,s)}}getChildAfterChild(e,n,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Jn(this.viewCache_),r=pE(this.writes_,i,n,1,s,e);return r.length===0?null:r[0]}}function mE(t){return{filter:t}}function yE(t,e){A(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),A(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function vE(t,e,n,s,i){const r=new gE;let o,a;if(n.type===_t.OVERWRITE){const c=n;c.source.fromUser?o=Ra(t,e,c.path,c.snap,s,i,r):(A(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!te(c.path),o=xr(t,e,c.path,c.snap,s,i,a,r))}else if(n.type===_t.MERGE){const c=n;c.source.fromUser?o=wE(t,e,c.path,c.children,s,i,r):(A(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=Aa(t,e,c.path,c.children,s,i,a,r))}else if(n.type===_t.ACK_USER_WRITE){const c=n;c.revert?o=IE(t,e,c.path,s,i,r):o=EE(t,e,c.path,c.affectedTree,s,i,r)}else if(n.type===_t.LISTEN_COMPLETE)o=CE(t,e,n.path,s,r);else throw xs("Unknown operation type: "+n.type);const l=r.getChanges();return bE(e,o,l),{viewCache:o,changes:l}}function bE(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=Nr(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&n.push(Uf(Nr(e)))}}function zf(t,e,n,s,i,r){const o=e.eventCache;if(kr(s,n)!=null)return e;{let a,l;if(te(n))if(A(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Jn(e),u=c instanceof G?c:G.EMPTY_NODE,h=Il(s,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,r)}else{const c=Pr(s,Jn(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,r)}else{const c=Z(n);if(c===".priority"){A(An(n)===1,"Can't have a priority with additional path components");const u=o.getNode();l=e.serverCache.getNode();const h=Du(s,n,u,l);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{const u=ve(n);let h;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const d=Du(s,n,o.getNode(),l);d!=null?h=o.getNode().getImmediateChild(c).updateChild(u,d):h=o.getNode().getImmediateChild(c)}else h=Tl(s,c,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),c,h,u,i,r):a=o.getNode()}}return ai(e,a,o.isFullyInitialized()||te(n),t.filter.filtersNodes())}}function xr(t,e,n,s,i,r,o,a){const l=e.serverCache;let c;const u=o?t.filter:t.filter.getIndexedFilter();if(te(n))c=u.updateFullNode(l.getNode(),s,null);else if(u.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(n,s);c=u.updateFullNode(l.getNode(),p,null)}else{const p=Z(n);if(!l.isCompleteForPath(n)&&An(n)>1)return e;const m=ve(n),k=l.getNode().getImmediateChild(p).updateChild(m,s);p===".priority"?c=u.updatePriority(l.getNode(),k):c=u.updateChild(l.getNode(),p,k,m,Kf,null)}const h=Hf(e,c,l.isFullyInitialized()||te(n),u.filtersNodes()),d=new Sl(i,h,r);return zf(t,h,n,i,d,a)}function Ra(t,e,n,s,i,r,o){const a=e.eventCache;let l,c;const u=new Sl(i,e,r);if(te(n))c=t.filter.updateFullNode(e.eventCache.getNode(),s,o),l=ai(e,c,!0,t.filter.filtersNodes());else{const h=Z(n);if(h===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),s),l=ai(e,c,a.isFullyInitialized(),a.isFiltered());else{const d=ve(n),p=a.getNode().getImmediateChild(h);let m;if(te(d))m=s;else{const y=u.getCompleteChild(h);y!=null?gl(d)===".priority"&&y.getChild(kf(d)).isEmpty()?m=y:m=y.updateChild(d,s):m=G.EMPTY_NODE}if(p.equals(m))l=e;else{const y=t.filter.updateChild(a.getNode(),h,m,d,u,o);l=ai(e,y,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function Mu(t,e){return t.eventCache.isCompleteForChild(e)}function wE(t,e,n,s,i,r,o){let a=e;return s.foreach((l,c)=>{const u=Ce(n,l);Mu(e,Z(u))&&(a=Ra(t,a,u,c,i,r,o))}),s.foreach((l,c)=>{const u=Ce(n,l);Mu(e,Z(u))||(a=Ra(t,a,u,c,i,r,o))}),a}function Lu(t,e,n){return n.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function Aa(t,e,n,s,i,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;te(n)?c=s:c=new ye(null).setTree(n,s);const u=e.serverCache.getNode();return c.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const p=e.serverCache.getNode().getImmediateChild(h),m=Lu(t,p,d);l=xr(t,l,new pe(h),m,i,r,o,a)}}),c.children.inorderTraversal((h,d)=>{const p=!e.serverCache.isCompleteForChild(h)&&d.value===null;if(!u.hasChild(h)&&!p){const m=e.serverCache.getNode().getImmediateChild(h),y=Lu(t,m,d);l=xr(t,l,new pe(h),y,i,r,o,a)}}),l}function EE(t,e,n,s,i,r,o){if(kr(i,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(s.value!=null){if(te(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return xr(t,e,n,l.getNode().getChild(n),i,r,a,o);if(te(n)){let c=new ye(null);return l.getNode().forEachChild(ms,(u,h)=>{c=c.set(new pe(u),h)}),Aa(t,e,n,c,i,r,a,o)}else return e}else{let c=new ye(null);return s.foreach((u,h)=>{const d=Ce(n,u);l.isCompleteForPath(d)&&(c=c.set(u,l.getNode().getChild(d)))}),Aa(t,e,n,c,i,r,a,o)}}function CE(t,e,n,s,i){const r=e.serverCache,o=Hf(e,r.getNode(),r.isFullyInitialized()||te(n),r.isFiltered());return zf(t,o,n,s,Kf,i)}function IE(t,e,n,s,i,r){let o;if(kr(s,n)!=null)return e;{const a=new Sl(s,e,i),l=e.eventCache.getNode();let c;if(te(n)||Z(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Pr(s,Jn(e));else{const h=e.serverCache.getNode();A(h instanceof G,"serverChildren would be complete if leaf node"),u=Il(s,h)}u=u,c=t.filter.updateFullNode(l,u,r)}else{const u=Z(n);let h=Tl(s,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=l.getImmediateChild(u)),h!=null?c=t.filter.updateChild(l,u,h,ve(n),a,r):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,G.EMPTY_NODE,ve(n),a,r):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Pr(s,Jn(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,r)))}return o=e.serverCache.isFullyInitialized()||kr(s,oe())!=null,ai(e,c,o,t.filter.filtersNodes())}}class TE{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new vl(s.getIndex()),r=Ww(s);this.processor_=mE(r);const o=n.serverCache,a=n.eventCache,l=i.updateFullNode(G.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(G.EMPTY_NODE,a.getNode(),null),u=new Nn(l,o.isFullyInitialized(),i.filtersNodes()),h=new Nn(c,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=ro(h,u),this.eventGenerator_=new Qw(this.query_)}get query(){return this.query_}}function SE(t){return t.viewCache_.serverCache.getNode()}function RE(t){return Nr(t.viewCache_)}function AE(t,e){const n=Jn(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!te(e)&&!n.getImmediateChild(Z(e)).isEmpty())?n.getChild(e):null}function Fu(t){return t.eventRegistrations_.length===0}function NE(t,e){t.eventRegistrations_.push(e)}function Uu(t,e,n){const s=[];if(n){A(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(r=>{const o=r.createCancelEvent(n,i);o&&s.push(o)})}if(e){let i=[];for(let r=0;r<t.eventRegistrations_.length;++r){const o=t.eventRegistrations_[r];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return s}function Bu(t,e,n,s){e.type===_t.MERGE&&e.source.queryId!==null&&(A(Jn(t.viewCache_),"We should always have a full cache before handling merges"),A(Nr(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,r=vE(t.processor_,i,e,n,s);return yE(t.processor_,r.viewCache),A(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,qf(t,r.changes,r.viewCache.eventCache.getNode(),null)}function PE(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ie,(r,o)=>{s.push(As(r,o))}),n.isFullyInitialized()&&s.push(Uf(n.getNode())),qf(t,s,n.getNode(),e)}function qf(t,e,n,s){const i=s?[s]:t.eventRegistrations_;return Jw(t.eventGenerator_,e,n,i)}let Or;class Yf{constructor(){this.views=new Map}}function kE(t){A(!Or,"__referenceConstructor has already been defined"),Or=t}function xE(){return A(Or,"Reference.ts has not been loaded"),Or}function OE(t){return t.views.size===0}function Rl(t,e,n,s){const i=e.source.queryId;if(i!==null){const r=t.views.get(i);return A(r!=null,"SyncTree gave us an op for an invalid query."),Bu(r,e,n,s)}else{let r=[];for(const o of t.views.values())r=r.concat(Bu(o,e,n,s));return r}}function Qf(t,e,n,s,i){const r=e._queryIdentifier,o=t.views.get(r);if(!o){let a=Pr(n,i?s:null),l=!1;a?l=!0:s instanceof G?(a=Il(n,s),l=!1):(a=G.EMPTY_NODE,l=!1);const c=ro(new Nn(a,l,!1),new Nn(s,i,!1));return new TE(e,c)}return o}function DE(t,e,n,s,i,r){const o=Qf(t,e,s,i,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),NE(o,n),PE(o,n)}function ME(t,e,n,s){const i=e._queryIdentifier,r=[];let o=[];const a=Pn(t);if(i==="default")for(const[l,c]of t.views.entries())o=o.concat(Uu(c,n,s)),Fu(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||r.push(c.query));else{const l=t.views.get(i);l&&(o=o.concat(Uu(l,n,s)),Fu(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||r.push(l.query)))}return a&&!Pn(t)&&r.push(new(xE())(e._repo,e._path)),{removed:r,events:o}}function Jf(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function In(t,e){let n=null;for(const s of t.views.values())n=n||AE(s,e);return n}function Xf(t,e){if(e._queryParams.loadsAllData())return ao(t);{const s=e._queryIdentifier;return t.views.get(s)}}function Zf(t,e){return Xf(t,e)!=null}function Pn(t){return ao(t)!=null}function ao(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let Dr;function LE(t){A(!Dr,"__referenceConstructor has already been defined"),Dr=t}function FE(){return A(Dr,"Reference.ts has not been loaded"),Dr}let UE=1;class Hu{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ye(null),this.pendingWriteTree_=fE(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ep(t,e,n,s,i){return tE(t.pendingWriteTree_,e,n,s,i),i?Fs(t,new Qn(wl(),e,n)):[]}function BE(t,e,n,s){nE(t.pendingWriteTree_,e,n,s);const i=ye.fromObject(n);return Fs(t,new Ns(wl(),e,i))}function mn(t,e,n=!1){const s=sE(t.pendingWriteTree_,e);if(iE(t.pendingWriteTree_,e)){let r=new ye(null);return s.snap!=null?r=r.set(oe(),!0):Le(s.children,o=>{r=r.set(new pe(o),!0)}),Fs(t,new Ar(s.path,r,n))}else return[]}function Hi(t,e,n){return Fs(t,new Qn(El(),e,n))}function HE(t,e,n){const s=ye.fromObject(n);return Fs(t,new Ns(El(),e,s))}function $E(t,e){return Fs(t,new Si(El(),e))}function VE(t,e,n){const s=Nl(t,n);if(s){const i=Pl(s),r=i.path,o=i.queryId,a=Ge(r,e),l=new Si(Cl(o),a);return kl(t,r,l)}else return[]}function Mr(t,e,n,s,i=!1){const r=e._path,o=t.syncPointTree_.get(r);let a=[];if(o&&(e._queryIdentifier==="default"||Zf(o,e))){const l=ME(o,e,n,s);OE(o)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const c=l.removed;if(a=l.events,!i){const u=c.findIndex(d=>d._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(r,(d,p)=>Pn(p));if(u&&!h){const d=t.syncPointTree_.subtree(r);if(!d.isEmpty()){const p=GE(d);for(let m=0;m<p.length;++m){const y=p[m],k=y.query,L=ip(t,y);t.listenProvider_.startListening(ci(k),Ri(t,k),L.hashFn,L.onComplete)}}}!h&&c.length>0&&!s&&(u?t.listenProvider_.stopListening(ci(e),null):c.forEach(d=>{const p=t.queryToTagMap.get(lo(d));t.listenProvider_.stopListening(ci(d),p)}))}KE(t,c)}return a}function tp(t,e,n,s){const i=Nl(t,s);if(i!=null){const r=Pl(i),o=r.path,a=r.queryId,l=Ge(o,e),c=new Qn(Cl(a),l,n);return kl(t,o,c)}else return[]}function WE(t,e,n,s){const i=Nl(t,s);if(i){const r=Pl(i),o=r.path,a=r.queryId,l=Ge(o,e),c=ye.fromObject(n),u=new Ns(Cl(a),l,c);return kl(t,o,u)}else return[]}function Na(t,e,n,s=!1){const i=e._path;let r=null,o=!1;t.syncPointTree_.foreachOnPath(i,(d,p)=>{const m=Ge(d,i);r=r||In(p,m),o=o||Pn(p)});let a=t.syncPointTree_.get(i);a?(o=o||Pn(a),r=r||In(a,oe())):(a=new Yf,t.syncPointTree_=t.syncPointTree_.set(i,a));let l;r!=null?l=!0:(l=!1,r=G.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((p,m)=>{const y=In(m,oe());y&&(r=r.updateImmediateChild(p,y))}));const c=Zf(a,e);if(!c&&!e._queryParams.loadsAllData()){const d=lo(e);A(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");const p=zE();t.queryToTagMap.set(d,p),t.tagToQueryMap.set(p,d)}const u=oo(t.pendingWriteTree_,i);let h=DE(a,e,n,u,r,l);if(!c&&!o&&!s){const d=Xf(a,e);h=h.concat(qE(t,e,d))}return h}function Al(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=Ge(o,e),c=In(a,l);if(c)return c});return Wf(i,e,r,n,!0)}function jE(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(c,u)=>{const h=Ge(c,n);s=s||In(u,h)});let i=t.syncPointTree_.get(n);i?s=s||In(i,oe()):(i=new Yf,t.syncPointTree_=t.syncPointTree_.set(n,i));const r=s!=null,o=r?new Nn(s,!0,!1):null,a=oo(t.pendingWriteTree_,e._path),l=Qf(i,e,a,r?o.getNode():G.EMPTY_NODE,r);return RE(l)}function Fs(t,e){return np(e,t.syncPointTree_,null,oo(t.pendingWriteTree_,oe()))}function np(t,e,n,s){if(te(t.path))return sp(t,e,n,s);{const i=e.get(oe());n==null&&i!=null&&(n=In(i,oe()));let r=[];const o=Z(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const c=n?n.getImmediateChild(o):null,u=jf(s,o);r=r.concat(np(a,l,c,u))}return i&&(r=r.concat(Rl(i,t,s,n))),r}}function sp(t,e,n,s){const i=e.get(oe());n==null&&i!=null&&(n=In(i,oe()));let r=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,c=jf(s,o),u=t.operationForChild(o);u&&(r=r.concat(sp(u,a,l,c)))}),i&&(r=r.concat(Rl(i,t,s,n))),r}function ip(t,e){const n=e.query,s=Ri(t,n);return{hashFn:()=>(SE(e)||G.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return s?VE(t,n._path,s):$E(t,n._path);{const r=$b(i,n);return Mr(t,n,null,r)}}}}function Ri(t,e){const n=lo(e);return t.queryToTagMap.get(n)}function lo(t){return t._path.toString()+"$"+t._queryIdentifier}function Nl(t,e){return t.tagToQueryMap.get(e)}function Pl(t){const e=t.indexOf("$");return A(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new pe(t.substr(0,e))}}function kl(t,e,n){const s=t.syncPointTree_.get(e);A(s,"Missing sync point for query tag that we're tracking");const i=oo(t.pendingWriteTree_,e);return Rl(s,n,i,null)}function GE(t){return t.fold((e,n,s)=>{if(n&&Pn(n))return[ao(n)];{let i=[];return n&&(i=Jf(n)),Le(s,(r,o)=>{i=i.concat(o)}),i}})}function ci(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(FE())(t._repo,t._path):t}function KE(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const i=lo(s),r=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(r)}}}function zE(){return UE++}function qE(t,e,n){const s=e._path,i=Ri(t,e),r=ip(t,n),o=t.listenProvider_.startListening(ci(e),i,r.hashFn,r.onComplete),a=t.syncPointTree_.subtree(s);if(i)A(!Pn(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,h)=>{if(!te(c)&&u&&Pn(u))return[ao(u).query];{let d=[];return u&&(d=d.concat(Jf(u).map(p=>p.query))),Le(h,(p,m)=>{d=d.concat(m)}),d}});for(let c=0;c<l.length;++c){const u=l[c];t.listenProvider_.stopListening(ci(u),Ri(t,u))}}return o}class xl{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new xl(n)}node(){return this.node_}}class Ol{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Ce(this.path_,e);return new Ol(this.syncTree_,n)}node(){return Al(this.syncTree_,this.path_)}}const YE=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},$u=function(t,e,n){if(!t||typeof t!="object")return t;if(A(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return QE(t[".sv"],e,n);if(typeof t[".sv"]=="object")return JE(t[".sv"],e);A(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},QE=function(t,e,n){if(t==="timestamp")return n.timestamp;A(!1,"Unexpected server value: "+t)},JE=function(t,e,n){t.hasOwnProperty("increment")||A(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&A(!1,"Unexpected increment value: "+s);const i=e.node();if(A(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const o=i.getValue();return typeof o!="number"?s:o+s},rp=function(t,e,n,s){return Dl(e,new Ol(n,t),s)},op=function(t,e,n){return Dl(t,new xl(e),n)};function Dl(t,e,n){const s=t.getPriority().val(),i=$u(s,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const o=t,a=$u(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new xe(a,Ne(i)):t}else{const o=t;return r=o,i!==o.getPriority().val()&&(r=r.updatePriority(new xe(i))),o.forEachChild(Ie,(a,l)=>{const c=Dl(l,e.getImmediateChild(a),n);c!==l&&(r=r.updateImmediateChild(a,c))}),r}}class Ml{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function Ll(t,e){let n=e instanceof pe?e:new pe(e),s=t,i=Z(n);for(;i!==null;){const r=Ts(s.node.children,i)||{children:{},childCount:0};s=new Ml(i,s,r),n=ve(n),i=Z(n)}return s}function Us(t){return t.node.value}function ap(t,e){t.node.value=e,Pa(t)}function lp(t){return t.node.childCount>0}function XE(t){return Us(t)===void 0&&!lp(t)}function co(t,e){Le(t.node.children,(n,s)=>{e(new Ml(n,t,s))})}function cp(t,e,n,s){n&&e(t),co(t,i=>{cp(i,e,!0)})}function ZE(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function $i(t){return new pe(t.parent===null?t.name:$i(t.parent)+"/"+t.name)}function Pa(t){t.parent!==null&&eC(t.parent,t.name,t)}function eC(t,e,n){const s=XE(n),i=Ft(t.node.children,e);s&&i?(delete t.node.children[e],t.node.childCount--,Pa(t)):!s&&!i&&(t.node.children[e]=n.node,t.node.childCount++,Pa(t))}const tC=/[\[\].#$\/\u0000-\u001F\u007F]/,nC=/[\[\].#$\u0000-\u001F\u007F]/,zo=10*1024*1024,Fl=function(t){return typeof t=="string"&&t.length!==0&&!tC.test(t)},up=function(t){return typeof t=="string"&&t.length!==0&&!nC.test(t)},sC=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),up(t)},iC=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!ul(t)||t&&typeof t=="object"&&Ft(t,".sv")},hp=function(t,e,n,s){s&&e===void 0||uo(no(t,"value"),e,n)},uo=function(t,e,n){const s=n instanceof pe?new ww(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Hn(s));if(typeof e=="function")throw new Error(t+"contains a function "+Hn(s)+" with contents = "+e.toString());if(ul(e))throw new Error(t+"contains "+e.toString()+" "+Hn(s));if(typeof e=="string"&&e.length>zo/3&&so(e)>zo)throw new Error(t+"contains a string greater than "+zo+" utf8 bytes "+Hn(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(Le(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!Fl(o)))throw new Error(t+" contains an invalid key ("+o+") "+Hn(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Ew(s,o),uo(t,a,s),Cw(s)}),i&&r)throw new Error(t+' contains ".value" child '+Hn(s)+" in addition to actual children.")}},rC=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const r=Ei(s);for(let o=0;o<r.length;o++)if(!(r[o]===".priority"&&o===r.length-1)){if(!Fl(r[o]))throw new Error(t+"contains an invalid key ("+r[o]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(bw);let i=null;for(n=0;n<e.length;n++){if(s=e[n],i!==null&&ht(i,s))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+s.toString());i=s}},oC=function(t,e,n,s){const i=no(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const r=[];Le(e,(o,a)=>{const l=new pe(o);if(uo(i,a,Ce(n,l)),gl(l)===".priority"&&!iC(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(l)}),rC(i,r)},dp=function(t,e,n,s){if(!up(n))throw new Error(no(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},aC=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),dp(t,e,n)},fp=function(t,e){if(Z(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},lC=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Fl(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!sC(n))throw new Error(no(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};class cC{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ho(t,e){let n=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();n!==null&&!_l(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(i)}n&&t.eventLists_.push(n)}function pp(t,e,n){ho(t,n),gp(t,s=>_l(s,e))}function ft(t,e,n){ho(t,n),gp(t,s=>ht(s,e)||ht(e,s))}function gp(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const i=t.eventLists_[s];if(i){const r=i.path;e(r)?(uC(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function uC(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();ri&&Me("event: "+n.toString()),Ls(s)}}}const hC="repo_interrupt",dC=25;class fC{constructor(e,n,s,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new cC,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Rr(),this.transactionQueueTree_=new Ml,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function pC(t,e,n){if(t.stats_=fl(t.repoInfo_),t.forceRestClient_||Gb())t.server_=new Sr(t.repoInfo_,(s,i,r,o)=>{Vu(t,s,i,r,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Wu(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Pe(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new qt(t.repoInfo_,e,(s,i,r,o)=>{Vu(t,s,i,r,o)},s=>{Wu(t,s)},s=>{gC(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=Qb(t.repoInfo_,()=>new Yw(t.stats_,t.server_)),t.infoData_=new jw,t.infoSyncTree_=new Hu({startListening:(s,i,r,o)=>{let a=[];const l=t.infoData_.getNode(s._path);return l.isEmpty()||(a=Hi(t.infoSyncTree_,s._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Ul(t,"connected",!1),t.serverSyncTree_=new Hu({startListening:(s,i,r,o)=>(t.server_.listen(s,r,i,(a,l)=>{const c=o(a,l);ft(t.eventQueue_,s._path,c)}),[]),stopListening:(s,i)=>{t.server_.unlisten(s,i)}})}function _p(t){const n=t.infoData_.getNode(new pe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function fo(t){return YE({timestamp:_p(t)})}function Vu(t,e,n,s,i){t.dataUpdateCount++;const r=new pe(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(s){const l=wr(n,c=>Ne(c));o=WE(t.serverSyncTree_,r,l,i)}else{const l=Ne(n);o=tp(t.serverSyncTree_,r,l,i)}else if(s){const l=wr(n,c=>Ne(c));o=HE(t.serverSyncTree_,r,l)}else{const l=Ne(n);o=Hi(t.serverSyncTree_,r,l)}let a=r;o.length>0&&(a=ks(t,r)),ft(t.eventQueue_,a,o)}function Wu(t,e){Ul(t,"connected",e),e===!1&&vC(t)}function gC(t,e){Le(e,(n,s)=>{Ul(t,n,s)})}function Ul(t,e,n){const s=new pe("/.info/"+e),i=Ne(n);t.infoData_.updateSnapshot(s,i);const r=Hi(t.infoSyncTree_,s,i);ft(t.eventQueue_,s,r)}function Bl(t){return t.nextWriteId_++}function _C(t,e,n){const s=jE(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(i=>{const r=Ne(i).withIndex(e._queryParams.getIndex());Na(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Hi(t.serverSyncTree_,e._path,r);else{const a=Ri(t.serverSyncTree_,e);o=tp(t.serverSyncTree_,e._path,r,a)}return ft(t.eventQueue_,e._path,o),Mr(t.serverSyncTree_,e,n,null,!0),r},i=>(Vi(t,"get for query "+Pe(e)+" failed: "+i),Promise.reject(new Error(i))))}function mC(t,e,n,s,i){Vi(t,"set",{path:e.toString(),value:n,priority:s});const r=fo(t),o=Ne(n,s),a=Al(t.serverSyncTree_,e),l=op(o,a,r),c=Bl(t),u=ep(t.serverSyncTree_,e,l,c,!0);ho(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,p)=>{const m=d==="ok";m||Ke("set at "+e+" failed: "+d);const y=mn(t.serverSyncTree_,c,!m);ft(t.eventQueue_,e,y),ka(t,i,d,p)});const h=$l(t,e);ks(t,h),ft(t.eventQueue_,h,[])}function yC(t,e,n,s){Vi(t,"update",{path:e.toString(),value:n});let i=!0;const r=fo(t),o={};if(Le(n,(a,l)=>{i=!1,o[a]=rp(Ce(e,a),Ne(l),t.serverSyncTree_,r)}),i)Me("update() called with empty data.  Don't do anything."),ka(t,s,"ok",void 0);else{const a=Bl(t),l=BE(t.serverSyncTree_,e,o,a);ho(t.eventQueue_,l),t.server_.merge(e.toString(),n,(c,u)=>{const h=c==="ok";h||Ke("update at "+e+" failed: "+c);const d=mn(t.serverSyncTree_,a,!h),p=d.length>0?ks(t,e):e;ft(t.eventQueue_,p,d),ka(t,s,c,u)}),Le(n,c=>{const u=$l(t,Ce(e,c));ks(t,u)}),ft(t.eventQueue_,e,[])}}function vC(t){Vi(t,"onDisconnectEvents");const e=fo(t),n=Rr();Ca(t.onDisconnect_,oe(),(i,r)=>{const o=rp(i,r,t.serverSyncTree_,e);Bf(n,i,o)});let s=[];Ca(n,oe(),(i,r)=>{s=s.concat(Hi(t.serverSyncTree_,i,r));const o=$l(t,i);ks(t,o)}),t.onDisconnect_=Rr(),ft(t.eventQueue_,oe(),s)}function bC(t,e,n){let s;Z(e._path)===".info"?s=Na(t.infoSyncTree_,e,n):s=Na(t.serverSyncTree_,e,n),pp(t.eventQueue_,e._path,s)}function wC(t,e,n){let s;Z(e._path)===".info"?s=Mr(t.infoSyncTree_,e,n):s=Mr(t.serverSyncTree_,e,n),pp(t.eventQueue_,e._path,s)}function EC(t){t.persistentConnection_&&t.persistentConnection_.interrupt(hC)}function Vi(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Me(n,...e)}function ka(t,e,n,s){e&&Ls(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let r=i;s&&(r+=": "+s);const o=new Error(r);o.code=i,e(o)}})}function mp(t,e,n){return Al(t.serverSyncTree_,e,n)||G.EMPTY_NODE}function Hl(t,e=t.transactionQueueTree_){if(e||po(t,e),Us(e)){const n=vp(t,e);A(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&CC(t,$i(e),n)}else lp(e)&&co(e,n=>{Hl(t,n)})}function CC(t,e,n){const s=n.map(c=>c.currentWriteId),i=mp(t,e,s);let r=i;const o=i.hash();for(let c=0;c<n.length;c++){const u=n[c];A(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=Ge(e,u.path);r=r.updateChild(h,u.currentOutputSnapshotRaw)}const a=r.val(!0),l=e;t.server_.put(l.toString(),a,c=>{Vi(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(mn(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();po(t,Ll(t.transactionQueueTree_,e)),Hl(t,t.transactionQueueTree_),ft(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)Ls(h[d])}else{if(c==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Ke("transaction at "+l.toString()+" failed: "+c);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=c}ks(t,e)}},o)}function ks(t,e){const n=yp(t,e),s=$i(n),i=vp(t,n);return IC(t,i,s),s}function IC(t,e,n){if(e.length===0)return;const s=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=Ge(n,l.path);let u=!1,h;if(A(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,h=l.abortReason,i=i.concat(mn(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=dC)u=!0,h="maxretry",i=i.concat(mn(t.serverSyncTree_,l.currentWriteId,!0));else{const d=mp(t,l.path,o);l.currentInputSnapshot=d;const p=e[a].update(d.val());if(p!==void 0){uo("transaction failed: Data returned ",p,l.path);let m=Ne(p);typeof p=="object"&&p!=null&&Ft(p,".priority")||(m=m.updatePriority(d.getPriority()));const k=l.currentWriteId,L=fo(t),R=op(m,d,L);l.currentOutputSnapshotRaw=m,l.currentOutputSnapshotResolved=R,l.currentWriteId=Bl(t),o.splice(o.indexOf(k),1),i=i.concat(ep(t.serverSyncTree_,l.path,R,l.currentWriteId,l.applyLocally)),i=i.concat(mn(t.serverSyncTree_,k,!0))}else u=!0,h="nodata",i=i.concat(mn(t.serverSyncTree_,l.currentWriteId,!0))}ft(t.eventQueue_,n,i),i=[],u&&(e[a].status=2,(function(d){setTimeout(d,Math.floor(0))})(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(h),!1,null))))}po(t,t.transactionQueueTree_);for(let a=0;a<s.length;a++)Ls(s[a]);Hl(t,t.transactionQueueTree_)}function yp(t,e){let n,s=t.transactionQueueTree_;for(n=Z(e);n!==null&&Us(s)===void 0;)s=Ll(s,n),e=ve(e),n=Z(e);return s}function vp(t,e){const n=[];return bp(t,e,n),n.sort((s,i)=>s.order-i.order),n}function bp(t,e,n){const s=Us(e);if(s)for(let i=0;i<s.length;i++)n.push(s[i]);co(e,i=>{bp(t,i,n)})}function po(t,e){const n=Us(e);if(n){let s=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[s]=n[i],s++);n.length=s,ap(e,n.length>0?n:void 0)}co(e,s=>{po(t,s)})}function $l(t,e){const n=$i(yp(t,e)),s=Ll(t.transactionQueueTree_,e);return ZE(s,i=>{qo(t,i)}),qo(t,s),cp(s,i=>{qo(t,i)}),n}function qo(t,e){const n=Us(e);if(n){const s=[];let i=[],r=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(A(r===o-1,"All SENT items should be at beginning of queue."),r=o,n[o].status=3,n[o].abortReason="set"):(A(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(mn(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?ap(e,void 0):n.length=r+1,ft(t.eventQueue_,$i(e),i);for(let o=0;o<s.length;o++)Ls(s[o])}}function TC(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let i=n[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function SC(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Ke(`Invalid query segment '${n}' in query '${t}'`)}return e}const ju=function(t,e){const n=RC(t),s=n.namespace;n.domain==="firebase.com"&&Zt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Zt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||Lb();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Ef(n.host,n.secure,s,i,e,"",s!==n.subdomain),path:new pe(n.pathString)}},RC=function(t){let e="",n="",s="",i="",r="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(i=TC(t.substring(u,h)));const d=SC(t.substring(Math.min(t.length,h)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const p=e.slice(0,c);if(p.toLowerCase()==="localhost")n="localhost";else if(p.split(".").length<=2)n=p;else{const m=e.indexOf(".");s=e.substring(0,m).toLowerCase(),n=e.substring(m+1),r=s}"ns"in d&&(r=d.ns)}return{host:e,port:l,domain:n,subdomain:s,secure:o,scheme:a,pathString:i,namespace:r}};const Gu="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",AC=(function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let i;const r=new Array(8);for(i=7;i>=0;i--)r[i]=Gu.charAt(n%64),n=Math.floor(n/64);A(n===0,"Cannot push at time == 0");let o=r.join("");if(s){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=Gu.charAt(e[i]);return A(o.length===20,"nextPushId: Length should be 20."),o}})();class NC{constructor(e,n,s,i){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Pe(this.snapshot.exportVal())}}class PC{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class wp{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return A(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Vl{constructor(e,n,s,i){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=i}get key(){return te(this._path)?null:gl(this._path)}get ref(){return new sn(this._repo,this._path)}get _queryIdentifier(){const e=Pu(this._queryParams),n=hl(e);return n==="{}"?"default":n}get _queryObject(){return Pu(this._queryParams)}isEqual(e){if(e=ot(e),!(e instanceof Vl))return!1;const n=this._repo===e._repo,s=_l(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+vw(this._path)}}class sn extends Vl{constructor(e,n){super(e,n,new bl,!1)}get parent(){const e=kf(this._path);return e===null?null:new sn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Ai{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new pe(e),s=Ni(this.ref,e);return new Ai(this._node.getChild(n),s,Ie)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,i)=>e(new Ai(i,Ni(this.ref,s),Ie)))}hasChild(e){const n=new pe(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ir(t,e){return t=ot(t),t._checkNotDeleted("ref"),e!==void 0?Ni(t._root,e):t._root}function Ni(t,e){return t=ot(t),Z(t._path)===null?aC("child","path",e):dp("child","path",e),new sn(t._repo,Ce(t._path,e))}function kC(t,e){t=ot(t),fp("push",t._path),hp("push",e,t._path,!0);const n=_p(t._repo),s=AC(n),i=Ni(t,s),r=Ni(t,s);let o;return e!=null?o=Wl(r,e).then(()=>r):o=Promise.resolve(r),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function Wl(t,e){t=ot(t),fp("set",t._path),hp("set",e,t._path,!1);const n=new Mi;return mC(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function ui(t,e){oC("update",e,t._path);const n=new Mi;return yC(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function xC(t){t=ot(t);const e=new wp(()=>{}),n=new go(e);return _C(t._repo,t,n).then(s=>new Ai(s,new sn(t._repo,t._path),t._queryParams.getIndex()))}class go{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new NC("value",this,new Ai(e.snapshotNode,new sn(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new PC(this,e,n):null}matches(e){return e instanceof go?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function OC(t,e,n,s,i){const r=new wp(n,void 0),o=new go(r);return bC(t._repo,t,o),()=>wC(t._repo,t,o)}function Ep(t,e,n,s){return OC(t,"value",e)}kE(sn);LE(sn);const DC="FIREBASE_DATABASE_EMULATOR_HOST",xa={};let MC=!1;function LC(t,e,n,s){const i=e.lastIndexOf(":"),r=e.substring(0,i),o=Os(r);t.repoInfo_=new Ef(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(t.authTokenProvider_=s)}function FC(t,e,n,s,i){let r=s||t.options.databaseURL;r===void 0&&(t.options.projectId||Zt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Me("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=ju(r,i),a=o.repoInfo,l;typeof process<"u"&&du&&(l=du[DC]),l?(r=`http://${l}?ns=${a.namespace}`,o=ju(r,i),a=o.repoInfo):o.repoInfo.secure;const c=new zb(t.name,t.options,e);lC("Invalid Firebase Database URL",o),te(o.path)||Zt("Database URL must point to the root of a Firebase Database (not including a child path).");const u=BC(a,t,c,new Kb(t,n));return new HC(u,t)}function UC(t,e){const n=xa[e];(!n||n[t.key]!==t)&&Zt(`Database ${e}(${t.repoInfo_}) has already been deleted.`),EC(t),delete n[t.key]}function BC(t,e,n,s){let i=xa[e.name];i||(i={},xa[e.name]=i);let r=i[t.toURLString()];return r&&Zt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new fC(t,MC,n,s),i[t.toURLString()]=r,r}class HC{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(pC(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new sn(this._repo,oe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(UC(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Zt("Cannot call "+e+" on a deleted database.")}}function $C(t=rf(),e){const n=cl(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=ev("database");s&&VC(n,...s)}return n}function VC(t,e,n,s={}){t=ot(t),t._checkNotDeleted("useEmulator");const i=`${e}:${n}`,r=t._repoInternal;if(t._instanceStarted){if(i===t._repoInternal.repoInfo_.host&&zn(s,r.repoInfo_.emulatorOptions))return;Zt("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&Zt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new sr(sr.OWNER);else if(s.mockUserToken){const a=typeof s.mockUserToken=="string"?s.mockUserToken:tv(s.mockUserToken,t.app.options.projectId);o=new sr(a)}Os(e)&&(Jd(e),Xd("Database",!0)),LC(r,i,s,o)}function WC(t){Pb(Ms),Ss(new qn("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return FC(s,i,r,n)},"PUBLIC").setMultipleInstances(!0)),En(fu,pu,t),En(fu,pu,"esm2020")}qt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};qt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};WC();function Cp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jC=Cp,Ip=new Li("auth","Firebase",Cp());const Lr=new al("@firebase/auth");function GC(t,...e){Lr.logLevel<=fe.WARN&&Lr.warn(`Auth (${Ms}): ${t}`,...e)}function rr(t,...e){Lr.logLevel<=fe.ERROR&&Lr.error(`Auth (${Ms}): ${t}`,...e)}function en(t,...e){throw jl(t,...e)}function Dt(t,...e){return jl(t,...e)}function Tp(t,e,n){const s={...jC(),[e]:n};return new Li("auth","Firebase",s).create(e,{appName:t.name})}function Tn(t){return Tp(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jl(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return Ip.create(t,...e)}function z(t,e,...n){if(!t)throw jl(e,...n)}function Kt(t){const e="INTERNAL ASSERTION FAILED: "+t;throw rr(e),new Error(e)}function tn(t,e){t||Kt(e)}function Oa(){return typeof self<"u"&&self.location?.href||""}function KC(){return Ku()==="http:"||Ku()==="https:"}function Ku(){return typeof self<"u"&&self.location?.protocol||null}function zC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(KC()||rv()||"connection"in navigator)?navigator.onLine:!0}function qC(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class Wi{constructor(e,n){this.shortDelay=e,this.longDelay=n,tn(n>e,"Short delay should be less than long delay!"),this.isMobile=ol()||Zd()}get(){return zC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Gl(t,e){tn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Sp{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Kt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Kt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Kt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const YC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const QC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],JC=new Wi(3e4,6e4);function _o(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Bs(t,e,n,s,i={}){return Rp(t,i,async()=>{let r={},o={};s&&(e==="GET"?o=s:r={body:JSON.stringify(s)});const a=Ds({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...r};return iv()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&Os(t.emulatorConfig.host)&&(c.credentials="include"),Sp.fetch()(await Np(t,t.config.apiHost,n,a),c)})}async function Rp(t,e,n){t._canInitEmulator=!1;const s={...YC,...e};try{const i=new XC(t),r=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw Ji(t,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ji(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Ji(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Ji(t,"user-disabled",o);const u=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Tp(t,u,c);en(t,u)}}catch(i){if(i instanceof On)throw i;en(t,"network-request-failed",{message:String(i)})}}async function Ap(t,e,n,s,i={}){const r=await Bs(t,e,n,s,i);return"mfaPendingCredential"in r&&en(t,"multi-factor-auth-required",{_serverResponse:r}),r}async function Np(t,e,n,s){const i=`${e}${n}?${s}`,r=t,o=r.config.emulator?Gl(t.config,i):`${t.config.apiScheme}://${i}`;return QC.includes(n)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}class XC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Dt(this.auth,"network-request-failed")),JC.get())})}}function Ji(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const i=Dt(t,e,s);return i.customData._tokenResponse=n,i}async function ZC(t,e){return Bs(t,"POST","/v1/accounts:delete",e)}async function Fr(t,e){return Bs(t,"POST","/v1/accounts:lookup",e)}function hi(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function eI(t,e=!1){const n=ot(t),s=await n.getIdToken(e),i=Kl(s);z(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,o=r?.sign_in_provider;return{claims:i,token:s,authTime:hi(Yo(i.auth_time)),issuedAtTime:hi(Yo(i.iat)),expirationTime:hi(Yo(i.exp)),signInProvider:o||null,signInSecondFactor:r?.sign_in_second_factor||null}}function Yo(t){return Number(t)*1e3}function Kl(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return rr("JWT malformed, contained fewer than 3 sections"),null;try{const i=br(n);return i?JSON.parse(i):(rr("Failed to decode base64 JWT payload"),null)}catch(i){return rr("Caught error parsing JWT payload as JSON",i?.toString()),null}}function zu(t){const e=Kl(t);return z(e,"internal-error"),z(typeof e.exp<"u","internal-error"),z(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Pi(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof On&&tI(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function tI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class nI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Da{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=hi(this.lastLoginAt),this.creationTime=hi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ur(t){const e=t.auth,n=await t.getIdToken(),s=await Pi(t,Fr(e,{idToken:n}));z(s?.users.length,e,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const r=i.providerUserInfo?.length?Pp(i.providerUserInfo):[],o=iI(t.providerData,r),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!o?.length,c=a?l:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Da(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function sI(t){const e=ot(t);await Ur(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function iI(t,e){return[...t.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function Pp(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function rI(t,e){const n=await Rp(t,{},async()=>{const s=Ds({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=t.config,o=await Np(t,i,"/v1/token",`key=${r}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:s};return t.emulatorConfig&&Os(t.emulatorConfig.host)&&(l.credentials="include"),Sp.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function oI(t,e){return Bs(t,"POST","/v2/accounts:revokeToken",_o(t,e))}class ys{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){z(e.idToken,"internal-error"),z(typeof e.idToken<"u","internal-error"),z(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):zu(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){z(e.length!==0,"internal-error");const n=zu(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(z(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:i,expiresIn:r}=await rI(e,n);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:i,expirationTime:r}=n,o=new ys;return s&&(z(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),i&&(z(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),r&&(z(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ys,this.toJSON())}_performRefresh(){return Kt("not implemented")}}function ln(t,e){z(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class mt{constructor({uid:e,auth:n,stsTokenManager:s,...i}){this.providerId="firebase",this.proactiveRefresh=new nI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Da(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Pi(this,this.stsTokenManager.getToken(this.auth,e));return z(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return eI(this,e)}reload(){return sI(this)}_assign(e){this!==e&&(z(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new mt({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){z(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Ur(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(pt(this.auth.app))return Promise.reject(Tn(this.auth));const e=await this.getIdToken();return await Pi(this,ZC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,i=n.email??void 0,r=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,c=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:h,emailVerified:d,isAnonymous:p,providerData:m,stsTokenManager:y}=n;z(h&&y,e,"internal-error");const k=ys.fromJSON(this.name,y);z(typeof h=="string",e,"internal-error"),ln(s,e.name),ln(i,e.name),z(typeof d=="boolean",e,"internal-error"),z(typeof p=="boolean",e,"internal-error"),ln(r,e.name),ln(o,e.name),ln(a,e.name),ln(l,e.name),ln(c,e.name),ln(u,e.name);const L=new mt({uid:h,auth:e,email:i,emailVerified:d,displayName:s,isAnonymous:p,photoURL:o,phoneNumber:r,tenantId:a,stsTokenManager:k,createdAt:c,lastLoginAt:u});return m&&Array.isArray(m)&&(L.providerData=m.map(R=>({...R}))),l&&(L._redirectEventId=l),L}static async _fromIdTokenResponse(e,n,s=!1){const i=new ys;i.updateFromServerResponse(n);const r=new mt({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await Ur(r),r}static async _fromGetAccountInfoResponse(e,n,s){const i=n.users[0];z(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?Pp(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!r?.length,a=new ys;a.updateFromIdToken(s);const l=new mt({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new Da(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!r?.length};return Object.assign(l,c),l}}const qu=new Map;function zt(t){tn(t instanceof Function,"Expected a class definition");let e=qu.get(t);return e?(tn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,qu.set(t,e),e)}class kp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}kp.type="NONE";const Yu=kp;function or(t,e,n){return`firebase:${t}:${e}:${n}`}class vs{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=or(this.userKey,i.apiKey,r),this.fullPersistenceKey=or("persistence",i.apiKey,r),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Fr(this.auth,{idToken:e}).catch(()=>{});return n?mt._fromGetAccountInfoResponse(this.auth,n,e):null}return mt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new vs(zt(Yu),e,s);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let r=i[0]||zt(Yu);const o=or(s,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){let h;if(typeof u=="string"){const d=await Fr(e,{idToken:u}).catch(()=>{});if(!d)break;h=await mt._fromGetAccountInfoResponse(e,d,u)}else h=mt._fromJSON(e,u);c!==r&&(a=h),r=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new vs(r,e,s):(r=l[0],a&&await r._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==r)try{await c._remove(o)}catch{}})),new vs(r,e,s))}}function Qu(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Mp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Fp(e))return"Blackberry";if(Up(e))return"Webos";if(Op(e))return"Safari";if((e.includes("chrome/")||Dp(e))&&!e.includes("edge/"))return"Chrome";if(Lp(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if(s?.length===2)return s[1]}return"Other"}function xp(t=ze()){return/firefox\//i.test(t)}function Op(t=ze()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Dp(t=ze()){return/crios\//i.test(t)}function Mp(t=ze()){return/iemobile/i.test(t)}function Lp(t=ze()){return/android/i.test(t)}function Fp(t=ze()){return/blackberry/i.test(t)}function Up(t=ze()){return/webos/i.test(t)}function zl(t=ze()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function aI(t=ze()){return zl(t)&&!!window.navigator?.standalone}function lI(){return ov()&&document.documentMode===10}function Bp(t=ze()){return zl(t)||Lp(t)||Up(t)||Fp(t)||/windows phone/i.test(t)||Mp(t)}function Hp(t,e=[]){let n;switch(t){case"Browser":n=Qu(ze());break;case"Worker":n=`${Qu(ze())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ms}/${s}`}class cI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=r=>new Promise((o,a)=>{try{const l=e(r);o(l)}catch(l){a(l)}});s.onAbort=n,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function uI(t,e={}){return Bs(t,"GET","/v2/passwordPolicy",_o(t,e))}const hI=6;class dI{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??hI,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class fI{constructor(e,n,s,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ju(this),this.idTokenSubscription=new Ju(this),this.beforeStateQueue=new cI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ip,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=zt(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await vs.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Fr(this,{idToken:e}),s=await mt._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(pt(this.app)){const r=this.app.settings.authIdToken;return r?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(r).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=this.redirectUser?._redirectEventId,o=s?._redirectEventId,a=await this.tryRedirectSignIn(e);(!r||r===o)&&a?.user&&(s=a.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(r){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(r))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return z(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ur(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=qC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(pt(this.app))return Promise.reject(Tn(this));const n=e?ot(e):null;return n&&z(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&z(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return pt(this.app)?Promise.reject(Tn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return pt(this.app)?Promise.reject(Tn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uI(this),n=new dI(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Li("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await oI(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&zt(e)||this._popupRedirectResolver;z(n,this,"argument-error"),this.redirectPersistenceManager=await vs.create(this,[zt(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,i){if(this._deleted)return()=>{};const r=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(z(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,s,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return z(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Hp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(pt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&GC(`Error while retrieving App Check token: ${e.error}`),e?.token}}function mo(t){return ot(t)}class Ju{constructor(e){this.auth=e,this.observer=null,this.addObserver=_v(n=>this.observer=n)}get next(){return z(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ql={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pI(t){ql=t}function gI(t){return ql.loadJS(t)}function _I(){return ql.gapiScript}function mI(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function yI(t,e){const n=cl(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),r=n.getOptions();if(zn(r,e??{}))return i;en(i,"already-initialized")}return n.initialize({options:e})}function vI(t,e){const n=e?.persistence||[],s=(Array.isArray(n)?n:[n]).map(zt);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e?.popupRedirectResolver)}function bI(t,e,n){const s=mo(t);z(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!1,r=$p(e),{host:o,port:a}=wI(e),l=a===null?"":`:${a}`,c={url:`${r}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){z(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),z(zn(c,s.config.emulator)&&zn(u,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=c,s.emulatorConfig=u,s.settings.appVerificationDisabledForTesting=!0,Os(o)?(Jd(`${r}//${o}${l}`),Xd("Auth",!0)):EI()}function $p(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function wI(t){const e=$p(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:Xu(s.substr(r.length+1))}}else{const[r,o]=s.split(":");return{host:r,port:Xu(o)}}}function Xu(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function EI(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Vp{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Kt("not implemented")}_getIdTokenResponse(e){return Kt("not implemented")}_linkToIdToken(e,n){return Kt("not implemented")}_getReauthenticationResolver(e){return Kt("not implemented")}}async function bs(t,e){return Ap(t,"POST","/v1/accounts:signInWithIdp",_o(t,e))}const CI="http://localhost";class Xn extends Vp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Xn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):en("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i,...r}=n;if(!s||!i)return null;const o=new Xn(s,i);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return bs(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,bs(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,bs(e,n)}buildRequest(){const e={requestUri:CI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ds(n)}return e}}class Wp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ji extends Wp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class fn extends ji{constructor(){super("facebook.com")}static credential(e){return Xn._fromParams({providerId:fn.PROVIDER_ID,signInMethod:fn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fn.credentialFromTaggedObject(e)}static credentialFromError(e){return fn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fn.credential(e.oauthAccessToken)}catch{return null}}}fn.FACEBOOK_SIGN_IN_METHOD="facebook.com";fn.PROVIDER_ID="facebook.com";class pn extends ji{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Xn._fromParams({providerId:pn.PROVIDER_ID,signInMethod:pn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return pn.credentialFromTaggedObject(e)}static credentialFromError(e){return pn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return pn.credential(n,s)}catch{return null}}}pn.GOOGLE_SIGN_IN_METHOD="google.com";pn.PROVIDER_ID="google.com";class gn extends ji{constructor(){super("github.com")}static credential(e){return Xn._fromParams({providerId:gn.PROVIDER_ID,signInMethod:gn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return gn.credentialFromTaggedObject(e)}static credentialFromError(e){return gn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return gn.credential(e.oauthAccessToken)}catch{return null}}}gn.GITHUB_SIGN_IN_METHOD="github.com";gn.PROVIDER_ID="github.com";class _n extends ji{constructor(){super("twitter.com")}static credential(e,n){return Xn._fromParams({providerId:_n.PROVIDER_ID,signInMethod:_n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return _n.credentialFromTaggedObject(e)}static credentialFromError(e){return _n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return _n.credential(n,s)}catch{return null}}}_n.TWITTER_SIGN_IN_METHOD="twitter.com";_n.PROVIDER_ID="twitter.com";async function II(t,e){return Ap(t,"POST","/v1/accounts:signUp",_o(t,e))}class kn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,i=!1){const r=await mt._fromIdTokenResponse(e,s,i),o=Zu(s);return new kn({user:r,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const i=Zu(s);return new kn({user:e,providerId:i,_tokenResponse:s,operationType:n})}}function Zu(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function TI(t){if(pt(t.app))return Promise.reject(Tn(t));const e=mo(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new kn({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await II(e,{returnSecureToken:!0}),s=await kn._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(s.user),s}class Br extends On{constructor(e,n,s,i){super(n.code,n.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,Br.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,i){return new Br(e,n,s,i)}}function jp(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?Br._fromErrorAndOperation(t,r,e,s):r})}async function SI(t,e,n=!1){const s=await Pi(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return kn._forOperation(t,"link",s)}async function RI(t,e,n=!1){const{auth:s}=t;if(pt(s.app))return Promise.reject(Tn(s));const i="reauthenticate";try{const r=await Pi(t,jp(s,i,e,t),n);z(r.idToken,s,"internal-error");const o=Kl(r.idToken);z(o,s,"internal-error");const{sub:a}=o;return z(t.uid===a,s,"user-mismatch"),kn._forOperation(t,i,r)}catch(r){throw r?.code==="auth/user-not-found"&&en(s,"user-mismatch"),r}}async function AI(t,e,n=!1){if(pt(t.app))return Promise.reject(Tn(t));const s="signIn",i=await jp(t,s,e),r=await kn._fromIdTokenResponse(t,s,i);return n||await t._updateCurrentUser(r.user),r}function NI(t,e,n,s){return ot(t).onIdTokenChanged(e,n,s)}function PI(t,e,n){return ot(t).beforeAuthStateChanged(e,n)}const Hr="__sak";class Gp{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Hr,"1"),this.storage.removeItem(Hr),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const kI=1e3,xI=10;class Kp extends Gp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Bp(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),i=this.localCache[n];s!==i&&e(n,i,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const s=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},r=this.storage.getItem(s);lI()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,xI):i()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},kI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Kp.type="LOCAL";const OI=Kp;class zp extends Gp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}zp.type="SESSION";const qp=zp;function DI(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class yo{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const s=new yo(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:i,data:r}=n.data,o=this.handlersMap[i];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,r)),l=await DI(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}yo.receivers=[];function Yl(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}class MI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,o;return new Promise((a,l)=>{const c=Yl("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(d.data.response);break;default:clearTimeout(u),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Mt(){return window}function LI(t){Mt().location.href=t}function Yp(){return typeof Mt().WorkerGlobalScope<"u"&&typeof Mt().importScripts=="function"}async function FI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function UI(){return navigator?.serviceWorker?.controller||null}function BI(){return Yp()?self:null}const Qp="firebaseLocalStorageDb",HI=1,$r="firebaseLocalStorage",Jp="fbase_key";class Gi{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function vo(t,e){return t.transaction([$r],e?"readwrite":"readonly").objectStore($r)}function $I(){const t=indexedDB.deleteDatabase(Qp);return new Gi(t).toPromise()}function Ma(){const t=indexedDB.open(Qp,HI);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore($r,{keyPath:Jp})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains($r)?e(s):(s.close(),await $I(),e(await Ma()))})})}async function eh(t,e,n){const s=vo(t,!0).put({[Jp]:e,value:n});return new Gi(s).toPromise()}async function VI(t,e){const n=vo(t,!1).get(e),s=await new Gi(n).toPromise();return s===void 0?null:s.value}function th(t,e){const n=vo(t,!0).delete(e);return new Gi(n).toPromise()}const WI=800,jI=3;class Xp{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ma(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>jI)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Yp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yo._getInstance(BI()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await FI(),!this.activeServiceWorker)return;this.sender=new MI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||UI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ma();return await eh(e,Hr,"1"),await th(e,Hr),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>eh(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>VI(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>th(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const r=vo(i,!1).getAll();return new Gi(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:r}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),WI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Xp.type="LOCAL";const GI=Xp;new Wi(3e4,6e4);function KI(t,e){return e?zt(e):(z(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class Ql extends Vp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return bs(e,this._buildIdpRequest())}_linkToIdToken(e,n){return bs(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return bs(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function zI(t){return AI(t.auth,new Ql(t),t.bypassAuthState)}function qI(t){const{auth:e,user:n}=t;return z(n,e,"internal-error"),RI(n,new Ql(t),t.bypassAuthState)}async function YI(t){const{auth:e,user:n}=t;return z(n,e,"internal-error"),SI(n,new Ql(t),t.bypassAuthState)}class Zp{constructor(e,n,s,i,r=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:i,tenantId:r,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zI;case"linkViaPopup":case"linkViaRedirect":return YI;case"reauthViaPopup":case"reauthViaRedirect":return qI;default:en(this.auth,"internal-error")}}resolve(e){tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const QI=new Wi(2e3,1e4);class us extends Zp{constructor(e,n,s,i,r){super(e,n,i,r),this.provider=s,this.authWindow=null,this.pollId=null,us.currentPopupAction&&us.currentPopupAction.cancel(),us.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return z(e,this.auth,"internal-error"),e}async onExecution(){tn(this.filter.length===1,"Popup operations only handle one event");const e=Yl();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Dt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Dt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,us.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Dt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,QI.get())};e()}}us.currentPopupAction=null;const JI="pendingRedirect",ar=new Map;class XI extends Zp{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=ar.get(this.auth._key());if(!e){try{const s=await ZI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}ar.set(this.auth._key(),e)}return this.bypassAuthState||ar.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function ZI(t,e){const n=nT(e),s=tT(t);if(!await s._isAvailable())return!1;const i=await s._get(n)==="true";return await s._remove(n),i}function eT(t,e){ar.set(t._key(),e)}function tT(t){return zt(t._redirectPersistence)}function nT(t){return or(JI,t.config.apiKey,t.name)}async function sT(t,e,n=!1){if(pt(t.app))return Promise.reject(Tn(t));const s=mo(t),i=KI(s,e),o=await new XI(s,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}const iT=600*1e3;class rT{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!oT(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!eg(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Dt(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=iT&&this.cachedEventUids.clear(),this.cachedEventUids.has(nh(e))}saveEventToCache(e){this.cachedEventUids.add(nh(e)),this.lastProcessedEventTime=Date.now()}}function nh(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function eg({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function oT(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eg(t);default:return!1}}async function aT(t,e={}){return Bs(t,"GET","/v1/projects",e)}const lT=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,cT=/^https?/;async function uT(t){if(t.config.emulator)return;const{authorizedDomains:e}=await aT(t);for(const n of e)try{if(hT(n))return}catch{}en(t,"unauthorized-domain")}function hT(t){const e=Oa(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!cT.test(n))return!1;if(lT.test(t))return s===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}const dT=new Wi(3e4,6e4);function sh(){const t=Mt().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function fT(t){return new Promise((e,n)=>{function s(){sh(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{sh(),n(Dt(t,"network-request-failed"))},timeout:dT.get()})}if(Mt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Mt().gapi?.load)s();else{const i=mI("iframefcb");return Mt()[i]=()=>{gapi.load?s():n(Dt(t,"network-request-failed"))},gI(`${_I()}?onload=${i}`).catch(r=>n(r))}}).catch(e=>{throw lr=null,e})}let lr=null;function pT(t){return lr=lr||fT(t),lr}const gT=new Wi(5e3,15e3),_T="__/auth/iframe",mT="emulator/auth/iframe",yT={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vT=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function bT(t){const e=t.config;z(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Gl(e,mT):`https://${t.config.authDomain}/${_T}`,s={apiKey:e.apiKey,appName:t.name,v:Ms},i=vT.get(t.config.apiHost);i&&(s.eid=i);const r=t._getFrameworks();return r.length&&(s.fw=r.join(",")),`${n}?${Ds(s).slice(1)}`}async function wT(t){const e=await pT(t),n=Mt().gapi;return z(n,t,"internal-error"),e.open({where:document.body,url:bT(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yT,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const o=Dt(t,"network-request-failed"),a=Mt().setTimeout(()=>{r(o)},gT.get());function l(){Mt().clearTimeout(a),i(s)}s.ping(l).then(l,()=>{r(o)})}))}const ET={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CT=500,IT=600,TT="_blank",ST="http://localhost";class ih{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function RT(t,e,n,s=CT,i=IT){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const l={...ET,width:s.toString(),height:i.toString(),top:r,left:o},c=ze().toLowerCase();n&&(a=Dp(c)?TT:n),xp(c)&&(e=e||ST,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[p,m])=>`${d}${p}=${m},`,"");if(aI(c)&&a!=="_self")return AT(e||"",a),new ih(null);const h=window.open(e||"",a,u);z(h,t,"popup-blocked");try{h.focus()}catch{}return new ih(h)}function AT(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}const NT="__/auth/handler",PT="emulator/auth/handler",kT=encodeURIComponent("fac");async function rh(t,e,n,s,i,r){z(t.config.authDomain,t,"auth-domain-config-required"),z(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:Ms,eventId:i};if(e instanceof Wp){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",pa(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof ji){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${kT}=${encodeURIComponent(l)}`:"";return`${xT(t)}?${Ds(a).slice(1)}${c}`}function xT({config:t}){return t.emulator?Gl(t,PT):`https://${t.authDomain}/${NT}`}const Qo="webStorageSupport";class OT{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qp,this._completeRedirectFn=sT,this._overrideRedirectResult=eT}async _openPopup(e,n,s,i){tn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const r=await rh(e,n,s,Oa(),i);return RT(e,r,Yl())}async _openRedirect(e,n,s,i){await this._originValidation(e);const r=await rh(e,n,s,Oa(),i);return LI(r),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:r}=this.eventManagers[n];return i?Promise.resolve(i):(tn(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await wT(e),s=new rT(e);return n.register("authEvent",i=>(z(i?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Qo,{type:Qo},i=>{const r=i?.[0]?.[Qo];r!==void 0&&n(!!r),en(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=uT(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Bp()||Op()||zl()}}const DT=OT;var oh="@firebase/auth",ah="1.12.0";class MT{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){z(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function LT(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function FT(t){Ss(new qn("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;z(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Hp(t)},c=new fI(s,i,r,l);return vI(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),Ss(new qn("auth-internal",e=>{const n=mo(e.getProvider("auth").getImmediate());return(s=>new MT(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),En(oh,ah,LT(t)),En(oh,ah,"esm2020")}const UT=300,BT=Qd("authIdTokenMaxAge")||UT;let lh=null;const HT=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>BT)return;const i=n?.token;lh!==i&&(lh=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function $T(t=rf()){const e=cl(t,"auth");if(e.isInitialized())return e.getImmediate();const n=yI(t,{popupRedirectResolver:DT,persistence:[GI,OI,qp]}),s=Qd("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const o=HT(r.toString());PI(n,o,()=>o(n.currentUser)),NI(n,a=>o(a))}}const i=qd("auth");return i&&bI(n,`http://${i}`),n}function VT(){return document.getElementsByTagName("head")?.[0]??document}pI({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=i=>{const r=Dt("internal-error");r.customData=i,n(r)},s.type="text/javascript",s.charset="UTF-8",VT().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});FT("Browser");const WT={apiKey:"AIzaSyBEd4_7LZoiHOSyxx0dKRAsqqDBozdYk84",authDomain:"petteia.firebaseapp.com",databaseURL:"https://petteia-default-rtdb.europe-west1.firebasedatabase.app",projectId:"petteia",storageBucket:"petteia.firebasestorage.app",messagingSenderId:"28792496852",appId:"1:28792496852:web:288889b7ceeb4f228ad141"},tg=sf(WT),jT=$T(tg),cr=$C(tg),GT={class:"min-h-screen bg-slate-900 text-slate-100 p-4 font-sans"},KT={class:"max-w-4xl mx-auto flex flex-wrap justify-between items-center bg-slate-800 p-4 rounded-xl shadow-2xl mb-6"},zT={class:"text-xs text-slate-400"},qT={class:"flex gap-4 items-center"},YT={class:"text-right"},QT={class:"text-[10px] uppercase tracking-tighter text-slate-500"},JT={class:"max-w-5xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-8"},XT={class:"lg:col-span-2 flex justify-center"},ZT={class:"grid grid-cols-8 grid-rows-8 bg-slate-700 border-[12px] border-slate-800 rounded shadow-inner ring-4 ring-slate-800/50"},eS=["onClick"],tS={key:1,class:"absolute w-3 h-3 bg-amber-400/40 rounded-full"},nS={class:"space-y-6"},sS={class:"bg-slate-800 p-4 rounded-xl"},iS={class:"flex justify-around text-2xl"},rS={class:"flex items-center gap-2"},oS={class:"flex items-center gap-2"},aS={class:"bg-slate-800 rounded-xl flex flex-col h-64"},lS={class:"flex-1 overflow-y-auto p-3 space-y-2 text-sm",id:"chatbox"},cS={key:0,class:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50"},uS={class:"bg-slate-800 p-10 rounded-2xl text-center border-2 border-amber-500 shadow-[0_0_50px_rgba(245,158,11,0.3)]"},hS={class:"text-xl mb-6"},dS={__name:"GameRoom",setup(t){const n=Hm().params.id,s=ct(Array(64).fill(null)),i=ct("white"),r=ct("spectator"),o=ct(null),a=ct(null),l=ct([]),c=ct(""),u=ir(cr,`games/${n}`);Qr(async()=>{const S=ir(cr,`games/${n}/players`),I=(await xC(S)).val()||{};I.white?I.black||(await ui(S,{black:!0}),r.value="black"):(await ui(S,{white:!0}),r.value="white"),Ep(u,N=>{const Q=N.val();Q?(s.value=Q.board||h(),i.value=Q.turn||"white",l.value=Q.chat?Object.values(Q.chat):[],L()):R()})});const h=()=>{const S=Array(64).fill(null);for(let v=0;v<16;v++)S[v]="black";for(let v=48;v<64;v++)S[v]="white";return S},d=(S,v)=>{if(s.value[v])return!1;const I=Math.floor(S/8),N=S%8,Q=Math.floor(v/8),$=v%8;if(I!==Q&&N!==$)return!1;const q=I===Q?v>S?1:-1:v>S?8:-8;for(let X=S+q;X!==v;X+=q)if(s.value[X])return!1;return!0},p=(S,v)=>{const I=v==="white"?"black":"white",N=[1,-1,8,-8];let Q=!1;return N.forEach($=>{const q=S+$,X=S+$*2;q<0||q>=64||X<0||X>=64||Math.abs($)===1&&Math.floor(S/8)!==Math.floor(q/8)||s.value[q]===I&&s.value[X]===v&&(s.value[q]=null,Q=!0)}),Q},m=async S=>{if(i.value===r.value){if(s.value[S]===r.value)o.value=S;else if(o.value!==null&&d(o.value,S)){const v=[...s.value];v[S]=r.value,v[o.value]=null,s.value=v;const N=p(S,r.value)?r.value:r.value==="white"?"black":"white";await ui(u,{board:s.value,turn:N}),o.value=null}}},y=()=>{c.value&&(kC(ir(cr,`games/${n}/chat`),{text:c.value,color:r.value,time:Date.now()}),c.value="")},k=Ze(()=>s.value.reduce((S,v)=>(v&&S[v]++,S),{white:0,black:0})),L=()=>{k.value.white===0&&(a.value=" !"),k.value.black===0&&(a.value=" !")},R=()=>{Wl(u,{board:h(),turn:"white",players:{white:!0,black:r.value==="black"}}),a.value=null},F=()=>{navigator.clipboard.writeText(window.location.href),alert(" !")};return(S,v)=>(be(),we("div",GT,[B("div",KT,[B("div",null,[v[1]||(v[1]=B("h1",{class:"text-2xl font-black text-amber-500 uppercase tracking-wider"},"Petteia Online",-1)),B("p",zT,"ID: "+st(vn(n)),1)]),B("div",qT,[B("div",YT,[B("p",{class:it(["text-sm font-bold",i.value==="white"?"text-white":"text-amber-600"])}," : "+st(i.value==="white"?"":""),3),B("p",QT," : "+st(r.value==="spectator"?"":r.value),1)]),B("button",{onClick:F,class:"bg-amber-600 hover:bg-amber-500 text-white px-4 py-2 rounded-lg text-sm transition-all active:scale-95"},"   ")])]),B("div",JT,[B("div",XT,[B("div",ZT,[(be(!0),we(De,null,ls(s.value,(I,N)=>(be(),we("div",{key:N,onClick:Q=>m(N),class:it(["w-10 h-10 sm:w-14 sm:h-14 border border-slate-600/30 flex items-center justify-center cursor-pointer relative",[(Math.floor(N/8)+N%8)%2===0?"bg-slate-700":"bg-slate-700/50"]])},[I?(be(),we("div",{key:0,class:it(["w-8 h-8 sm:w-11 sm:h-11 rounded-full shadow-2xl transition-all duration-300 transform",[I==="white"?"bg-white shadow-white/20":"bg-zinc-900 border border-slate-700 shadow-black/50",o.value===N?"scale-110 ring-4 ring-amber-400 rotate-12":""]])},null,2)):gs("",!0),o.value!==null&&d(o.value,N)?(be(),we("div",tS)):gs("",!0)],10,eS))),128))])]),B("div",nS,[B("div",sS,[v[2]||(v[2]=B("h2",{class:"text-sm font-bold mb-3 text-slate-400 uppercase"},"  ",-1)),B("div",iS,[B("div",rS," "+st(k.value.white),1),B("div",oS," "+st(k.value.black),1)])]),B("div",aS,[v[3]||(v[3]=B("div",{class:"p-3 border-b border-slate-700 text-xs font-bold text-slate-500 uppercase"},"",-1)),B("div",lS,[(be(!0),we(De,null,ls(l.value,I=>(be(),we("div",{key:I.time,class:"break-words"},[B("span",{class:it([I.color==="white"?"text-slate-100":"text-amber-500","font-bold"])},st(I.color)+": ",3),wd(" "+st(I.text),1)]))),128))]),Gg(B("input",{onKeyup:Nm(y,["enter"]),"onUpdate:modelValue":v[0]||(v[0]=I=>c.value=I),placeholder:"...",class:"bg-slate-900 border-none p-3 text-sm focus:ring-2 ring-amber-500 outline-none rounded-b-xl"},null,544),[[Im,c.value]])])])]),a.value?(be(),we("div",cS,[B("div",uS,[v[4]||(v[4]=B("h2",{class:"text-4xl font-black mb-4"}," ",-1)),B("p",hS,st(a.value),1),B("button",{onClick:R,class:"bg-amber-600 px-8 py-3 rounded-full font-bold hover:bg-amber-500 transition"}," ")])])):gs("",!0)]))}},fS=(t,e)=>{const n=t.__vccOpts||t;for(const[s,i]of e)n[s]=i;return n},pS={class:"min-h-screen bg-slate-900 text-slate-100 p-4 font-sans flex flex-col items-center justify-center"},gS={class:"max-w-4xl w-full flex flex-wrap justify-between items-center bg-slate-800 p-6 rounded-2xl shadow-2xl mb-6 border border-slate-700"},_S={class:"text-[10px] text-slate-500 font-mono mt-1"},mS={class:"flex gap-6 items-center"},yS={class:"flex gap-4"},vS={class:"flex flex-col items-center"},bS={class:"flex flex-col items-center"},wS={key:0,class:"flex gap-2 bg-slate-900 p-1 rounded-xl border border-slate-700"},ES={key:1,class:"text-right"},CS={class:"text-xs font-bold text-amber-500 uppercase tracking-widest"},IS={class:"grid grid-cols-8 grid-rows-8 bg-slate-800 border-[12px] border-slate-800 rounded shadow-[0_0_50px_rgba(0,0,0,0.5)] relative overflow-hidden"},TS=["onClick"],SS={key:0,class:"w-3 h-3 bg-amber-500/20 rounded-full border border-amber-500/40"},RS=["onClick"],AS={key:0,class:"absolute -top-4 -right-4 bg-slate-900 border border-slate-700 px-3 py-1 rounded-full text-[10px] font-bold text-slate-500 z-30 shadow-xl"},NS={key:0,class:"fixed inset-0 bg-slate-950/90 backdrop-blur-sm flex items-center justify-center z-50 p-6"},PS={class:"bg-slate-800 p-12 rounded-3xl text-center border border-amber-500/30 shadow-[0_0_100px_rgba(245,158,11,0.2)] max-w-sm w-full"},kS={class:"text-slate-400 mb-8 font-medium italic"},xS={class:"mt-8 flex gap-8"},OS={class:"text-center"},DS={class:"flex gap-1"},MS={class:"text-center"},LS={class:"flex gap-1"},FS={__name:"App",setup(t){const n=(()=>{const I=new URLSearchParams(window.location.search).get("room");return I||`petteia-${Math.random().toString(36).substring(7)}`})(),s=ir(cr,`games/${n}`),i=window.location.origin+window.location.pathname+"?room="+n,r=ct(!1),o=ct(null),a=ct(null),l=ct(null),c=xi({board:Array(64).fill(null),turn:"white",playerWhite:"",playerBlack:"",winner:""});Qr(async()=>{const v=await TI(jT);o.value=v.user.uid,Ep(s,I=>{const N=I.val();N?(N.playerWhite===o.value?a.value="white":N.playerBlack===o.value?a.value="black":N.playerBlack?a.value="Spectator":(a.value="black",ui(s,{playerBlack:o.value})),c.board=S(N.board),c.turn=N.turn,c.winner=N.winner,c.playerWhite=N.playerWhite,c.playerBlack=N.playerBlack):y()})});const u=()=>{const v=Array(64).fill(null);for(let I=0;I<16;I++)v[I]="black";for(let I=48;I<64;I++)v[I]="white";return v},h=(v,I)=>{if(c.board[I])return!1;const N=Math.floor(v/8),Q=v%8,$=Math.floor(I/8),q=I%8;if(N!==$&&Q!==q)return!1;const X=N===$?I>v?1:-1:I>v?8:-8;for(let O=v+X;O!==I;O+=X)if(c.board[O])return!1;return!0},d=async v=>{if(!(a.value!==c.turn||c.winner)){if(c.board[v]===a.value)l.value=v;else if(l.value!==null&&h(l.value,v)){const I=JSON.parse(JSON.stringify(c.board));I[v]=a.value,I[l.value]=null;const N=p(I,v,a.value),Q=m(I);await ui(s,{board:I,turn:N&&!Q?a.value:a.value==="white"?"black":"white",winner:Q}),l.value=null}}},p=(v,I,N)=>{const Q=N==="white"?"black":"white",$=[1,-1,8,-8];let q=!1;return $.forEach(X=>{const O=I+X,ne=I+X*2;O<0||O>=64||ne<0||ne>=64||Math.abs(X)===1&&Math.floor(I/8)!==Math.floor(O/8)||v[O]===Q&&v[ne]===N&&(v[O]=null,q=!0)}),q},m=v=>{const I=v.reduce((N,Q)=>(Q&&N[Q]++,N),{white:0,black:0});return I.white===0?"black":I.black===0?"white":""},y=()=>{Wl(s,{board:u(),turn:"white",playerWhite:o.value,playerBlack:"",winner:""})},k=Ze(()=>c.board.map((v,I)=>({color:v,index:I})).filter(v=>v.color).map(v=>({...v,id:`piece-${v.index<16&&v.color==="black"?"b":"w"}-${v.index}`}))),L=v=>({top:`${Math.floor(v/8)*12.5}%`,left:`${v%8*12.5}%`}),R=Ze(()=>c.board.reduce((v,I)=>(I&&v[I]++,v),{white:0,black:0})),F=()=>{navigator.clipboard.writeText(i),r.value=!0,setTimeout(()=>r.value=!1,2e3)},S=v=>{if(!Array.isArray(v)){const I=Array(64).fill(null);return Object.entries(v).forEach(([N,Q])=>{I[parseInt(N)]=Q}),I}return v};return(v,I)=>(be(),we("div",pS,[B("div",gS,[B("div",null,[I[0]||(I[0]=B("h1",{class:"text-3xl font-black text-amber-500 uppercase tracking-tighter"},"Petteia Online",-1)),B("p",_S,"ROOM ID: "+st(vn(n)),1)]),B("div",mS,[B("div",yS,[B("div",vS,[B("div",{class:it(["w-2 h-2 rounded-full mb-1",c.turn==="white"?"bg-white animate-pulse shadow-[0_0_8px_white]":"bg-slate-700"])},null,2),I[1]||(I[1]=B("span",{class:"text-[10px] font-bold uppercase tracking-widest text-slate-400"},"",-1))]),B("div",bS,[B("div",{class:it(["w-2 h-2 rounded-full mb-1",c.turn==="black"?"bg-amber-500 animate-pulse shadow-[0_0_8px_orange]":"bg-slate-700"])},null,2),I[2]||(I[2]=B("span",{class:"text-[10px] font-bold uppercase tracking-widest text-slate-400"},"",-1))])]),I[3]||(I[3]=B("div",{class:"h-10 w-[1px] bg-slate-700"},null,-1)),!c.playerBlack&&a.value==="white"?(be(),we("div",wS,[B("input",{readonly:"",value:i,class:"bg-transparent text-[10px] px-3 py-2 w-32 outline-none text-slate-400 font-mono"}),B("button",{onClick:F,class:"bg-amber-600 hover:bg-amber-500 text-white px-3 py-1 rounded-lg text-xs transition-all active:scale-95"},st(r.value?"":""),1)])):(be(),we("div",ES,[B("p",CS," : "+st(a.value==="Spectator"?"":a.value==="white"?"":""),1)]))])]),B("div",{class:it(["relative group",{"opacity-50 pointer-events-none":c.turn!==a.value&&!c.winner}])},[B("div",IS,[(be(),we(De,null,ls(64,N=>B("div",{key:"cell-"+N,onClick:Q=>d(N-1),class:it(["w-10 h-10 sm:w-14 sm:h-14 border border-slate-700/30 flex items-center justify-center cursor-pointer transition-colors",[(Math.floor((N-1)/8)+(N-1)%8)%2===0?"bg-slate-700":"bg-slate-700/60",l.value===N-1?"bg-amber-500/10":""]])},[l.value!==null&&h(l.value,N-1)?(be(),we("div",SS)):gs("",!0)],10,TS)),64)),Ue(ym,{name:"piece"},{default:na(()=>[(be(!0),we(De,null,ls(k.value,N=>(be(),we("div",{key:N.id,onClick:Rm(Q=>d(N.index),["stop"]),class:"absolute w-10 h-10 sm:w-14 sm:h-14 flex items-center justify-center transition-all duration-500 ease-in-out cursor-pointer z-10",style:Gr(L(N.index))},[B("div",{class:it(["w-8 h-8 sm:w-11 sm:h-11 rounded-full shadow-2xl transform transition-all duration-300",[N.color==="white"?"bg-slate-100 shadow-white/10":"bg-zinc-950 border border-slate-800 shadow-black/50",l.value===N.index?"scale-110 ring-4 ring-amber-500 rotate-12 z-20":""]])},[B("div",{class:it(["w-full h-full rounded-full border-4 opacity-10",N.color==="white"?"border-slate-400":"border-slate-200"])},null,2)],2)],12,RS))),128))]),_:1})]),c.turn!==a.value&&!c.winner?(be(),we("div",AS,"  ... ")):gs("",!0)],2),Ue(X_,{name:"fade"},{default:na(()=>[c.winner?(be(),we("div",NS,[B("div",PS,[I[4]||(I[4]=B("h2",{class:"text-5xl font-black mb-2 text-amber-500 uppercase tracking-tighter"},"!",-1)),B("p",kS,st(c.winner==="white"?" ":" ")+"    ",1),B("button",{onClick:y,class:"w-full bg-amber-600 hover:bg-amber-500 text-white font-bold py-4 rounded-xl transition-all shadow-lg active:scale-95"},"   ")])])):gs("",!0)]),_:1}),B("div",xS,[B("div",OS,[I[5]||(I[5]=B("p",{class:"text-[10px] uppercase text-slate-500 tracking-[0.2em] mb-1"}," ",-1)),B("div",DS,[(be(!0),we(De,null,ls(16-R.value.black,N=>(be(),we("div",{key:N,class:"w-2 h-2 rounded-full bg-zinc-950 opacity-40"}))),128))])]),B("div",MS,[I[6]||(I[6]=B("p",{class:"text-[10px] uppercase text-slate-500 tracking-[0.2em] mb-1"}," ",-1)),B("div",LS,[(be(!0),we(De,null,ls(16-R.value.white,N=>(be(),we("div",{key:N,class:"w-2 h-2 rounded-full bg-white opacity-40"}))),128))])])])]))}},US=fS(FS,[["__scopeId","data-v-3ff67338"]]),BS=[{path:"/",component:jy},{path:"/game/:id",component:dS,props:!0}],HS=Vy({history:by(),routes:BS});xm(US).use(HS).mount("#app");
